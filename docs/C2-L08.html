<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.11">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Oren Bochman">
<meta name="keywords" content="ANOVA, Bayesian statistics, R programming, statistical modeling, Analysis of Variance">
<meta name="description" content="An overview of ANOVA in the context of Bayesian statistics.">

<title>ANOVA – Bayesian Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-279bd408c6dfe7bd56e8b154fe269440.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-923206e44a13b4518db4dede9f4ebdc9.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-279bd408c6dfe7bd56e8b154fe269440.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-37379e3bbb48fc9e4c504b22bdb22879.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-e12ace95bce8268b44b48d9ebb190a16.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-37379e3bbb48fc9e4c504b22bdb22879.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked slimcontent quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const queryPrefersDark = window.matchMedia('(prefers-color-scheme: dark)');
    const darkModeDefault = queryPrefersDark.matches;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    queryPrefersDark.addEventListener("change", e => {
      if(window.localStorage.getItem("quarto-color-scheme") !== null)
        return;
      const alternate = e.matches
      toggleColorMode(alternate);
      localAlternateSentinel = e.matches ? 'alternate' : 'default'; // this is used alongside local storage!
      toggleGiscusIfUsed(alternate, darkModeDefault);
    });
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./C2-L01.html">2. Techniques and Models</a></li><li class="breadcrumb-item"><a href="./C2-L08.html">ANOVA</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bayesian Statistics</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Intro</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Bayesian Statistics</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">1. From Concept to Data Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L01-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework on paradigms of probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayes’ Theorem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L02-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conditional Probability and Bayes’ Law</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L02-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conditional Probability and Bayes’ Law</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L03-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework on Random Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L03-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework on Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Frequentist Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L04-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework - Frequentist MLE</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L05-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework on Likelihoods and MLEs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L05-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework on Bayesian Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Priors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L06-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework Posterior Probabilities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Binomial Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L07-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework on Priors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Poisson Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L08-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework on Poisson Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L08-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Honors Quiz - Beta Bernoulli</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exponential Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L09-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework exponential data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Normally distributed Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L10-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework Normal data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Non-Informative Priors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L11-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework Alternative Priors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Brief Review of Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L12-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">—</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L12-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Honnors Homework On Regression</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">2. Techniques and Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Modeling and Monte Carlo estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Modeling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Monte Carlo estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Metropolis-Hastings</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L04-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework on the Metropolis-Hastings algorithm</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gibbs sampling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L05-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW - Gibbs-Sampling algorithm</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assessing Convergence</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L06-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework on the Gibbs-Sampling algorithm</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L06-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Honnors Homework on M-H algorithm</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notes - Linear regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L07-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW on Linear Regression Model Part 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L07-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW - Deviance information criterion (DIC)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L08.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">ANOVA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L08-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW on ANOVA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L08-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW+ - Multiple Factor ANOVA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L09-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework on Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Poisson regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L10-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework on Poisson regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hierarchical modeling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L11-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework on Hierarchical Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L11-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework on Non-Normal Hierarchical Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Capstone Project</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L12-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework on Predictive distributions and mixture models</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">3. Mixture Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic Concepts of Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L01-Ex1-Basic-Definitions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic Concepts of Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L01-Ex2-Gaussian-mixtures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixtures of Gaussians</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L01-Ex3-Zero-Inflated-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Definition of Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L01-Ex4-Def-mixture-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zero inflated distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L01-Ex5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic Concepts of Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L01-Ex6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic Concepts of Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The EM algorithm for zero-inflated mixtures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L02-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The EM algorithm for Zero-Inflated Mixtures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L02-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The EM algorithm for Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MCMC for Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L03-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The MCMC algorithm for Zero-Inflated Mixtures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L03-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Markov chain Monte Carlo algorithms for Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Applications of Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L04-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Old Faithful eruptions density estimation with the EM algorithm</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L04-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Old Faithful eruptions density estimation with the MCMC algorithms</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L04-Ex3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Mixture Models for Classification of Banknotes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Practical Considerations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L05-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Computational considerations for Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L05-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Information Criteria (BIC)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L05-Ex3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Estimating the number of components in Bayesian settings</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L05-Ex4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Estimating the partition structure in Bayesian models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L05-Ex5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The MCMC algorithm for Zero-Inflated Mixtures</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">4. Time series Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C4-L00.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 0: Introductions to time series analysis and the AR(1) process</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C4-L01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introductions to Time Series analysis &amp; the AR(1) process</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C4-L02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The AR(p) process</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C4-L03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Normal Dynamic Linear Models, Part 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C4-L04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Normal Dynamic Linear Models, Part 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C4-L05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Final Project</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C4-L06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 0: Feyman Notebook on Bayesian Time Series Analysis</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">5. Capstone Project</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
 <span class="menu-text">C5-L01.qmd</span>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">6. Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix: Notation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix: Discrete Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix: Continuous Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix: Exponents &amp; Logarithms</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix: The Law of Large Numbers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix: The Central Limit Theorem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix: Conjugate Priors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix: Link Function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayes by backprop</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Books in R &amp; Python</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction-to-anova" id="toc-introduction-to-anova" class="nav-link active" data-scroll-target="#introduction-to-anova"><span class="header-section-number">1</span> Introduction to ANOVA</a>
  <ul class="collapse">
  <li><a href="#data-eda" id="toc-data-eda" class="nav-link" data-scroll-target="#data-eda"><span class="header-section-number">1.1</span> Data &amp; EDA</a></li>
  <li><a href="#modeling" id="toc-modeling" class="nav-link" data-scroll-target="#modeling"><span class="header-section-number">1.2</span> Modeling</a></li>
  <li><a href="#model-checking" id="toc-model-checking" class="nav-link" data-scroll-target="#model-checking"><span class="header-section-number">1.3</span> Model checking</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">1.4</span> Results</a></li>
  </ul></li>
  <li><a href="#two-factor-anova" id="toc-two-factor-anova" class="nav-link" data-scroll-target="#two-factor-anova"><span class="header-section-number">2</span> Two Factor ANOVA</a>
  <ul class="collapse">
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">2.1</span> Data</a></li>
  <li><a href="#one-way-model" id="toc-one-way-model" class="nav-link" data-scroll-target="#one-way-model"><span class="header-section-number">2.2</span> One-way model</a></li>
  <li><a href="#two-way-additive-model" id="toc-two-way-additive-model" class="nav-link" data-scroll-target="#two-way-additive-model"><span class="header-section-number">2.3</span> Two-way additive model</a></li>
  <li><a href="#two-way-cell-means-model" id="toc-two-way-cell-means-model" class="nav-link" data-scroll-target="#two-way-cell-means-model"><span class="header-section-number">2.4</span> Two-way cell means model</a></li>
  <li><a href="#results-1" id="toc-results-1" class="nav-link" data-scroll-target="#results-1"><span class="header-section-number">2.5</span> Results</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./C2-L01.html">2. Techniques and Models</a></li><li class="breadcrumb-item"><a href="./C2-L08.html">ANOVA</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">ANOVA</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Bayesian Statistics: Techniques and Models</p>
  <div class="quarto-categories">
    <div class="quarto-category">Monte Carlo Estimation</div>
  </div>
  </div>

<div>
  <div class="description">
    An overview of ANOVA in the context of Bayesian statistics.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Oren Bochman </p>
          </div>
  </div>
    
  
    
  </div>
  

<div>
  <div class="keywords">
    <div class="block-title">Keywords</div>
    <p>ANOVA, Bayesian statistics, R programming, statistical modeling, Analysis of Variance</p>
  </div>
</div>

</header>


<section id="introduction-to-anova" class="level2 page-columns page-full" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction-to-anova"><span class="header-section-number">1</span> Introduction to ANOVA</h2>
<div class="page-columns page-full"><p> ## One way ANOVA model using JAGS</p><div class="no-row-height column-margin column-container"><img src="images/c2l08-ss-01-ANOVA.png" class="img-fluid" width="200" alt="Introduction to ANOVA"></div></div>
<section id="data-eda" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="data-eda"><span class="header-section-number">1.1</span> Data &amp; EDA</h3>
<p>As an example of a one-way ANOVA, we’ll look at the Plant Growth data in <code>R</code>.</p>
<div class="cell">
<div id="lst-load-PlantGrowth" class="r cell-code listing quarto-float quarto-figure quarto-figure-left anchored" data-lst-cap="Plant Growth Query">
<figure class="quarto-float quarto-float-lst figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-load-PlantGrowth-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;1: Plant Growth Query
</figcaption>
<div aria-describedby="lst-load-PlantGrowth-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" data-lst-cap="Plant Growth Query"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"PlantGrowth"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#?PlantGrowth</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(PlantGrowth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  weight group
1   4.17  ctrl
2   5.58  ctrl
3   5.18  ctrl
4   6.11  ctrl
5   4.50  ctrl
6   4.61  ctrl</code></pre>
</div>
</div>
<p>We first load the dataset (<a href="#lst-load-PlantGrowth" class="quarto-xref">Listing&nbsp;1</a>)</p>
<p>Because the explanatory variable <code>group</code> is a factor and not continuous, we choose to visualize the data with box plots rather than scatter plots.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(weight <span class="sc">~</span> group, <span class="at">data=</span>PlantGrowth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-platgrowth-boxplot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-platgrowth-boxplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="C2-L08_files/figure-html/fig-platgrowth-boxplot-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: PlantGrowth boxplot"><img src="C2-L08_files/figure-html/fig-platgrowth-boxplot-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-platgrowth-boxplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: PlantGrowth boxplot
</figcaption>
</figure>
</div>
</div>
</div>
<p>The box plots summarize the distribution of the data for each of the three groups. It appears that treatment 2 has the highest mean yield. It might be questionable whether each group has the same variance, but we’ll assume that is the case.</p>
</section>
<section id="modeling" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="modeling"><span class="header-section-number">1.2</span> Modeling</h3>
<p>Again, we can start with the reference analysis (with a noninformative prior) with a linear model in <code>R</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>lmod <span class="ot">=</span> <span class="fu">lm</span>(weight <span class="sc">~</span> group, <span class="at">data=</span>PlantGrowth)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ group, data = PlantGrowth)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.0710 -0.4180 -0.0060  0.2627  1.3690 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   5.0320     0.1971  25.527   &lt;2e-16 ***
grouptrt1    -0.3710     0.2788  -1.331   0.1944    
grouptrt2     0.4940     0.2788   1.772   0.0877 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6234 on 27 degrees of freedom
Multiple R-squared:  0.2641,    Adjusted R-squared:  0.2096 
F-statistic: 4.846 on 2 and 27 DF,  p-value: 0.01591</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lmod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: weight
          Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
group      2  3.7663  1.8832  4.8461 0.01591 *
Residuals 27 10.4921  0.3886                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lmod) <span class="co"># for graphical residual analysis</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-residual-analysis-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-residual-analysis-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="C2-L08_files/figure-html/fig-residual-analysis-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Graphical residual analysis"><img src="C2-L08_files/figure-html/fig-residual-analysis-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-residual-analysis-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Graphical residual analysis
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-residual-analysis-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-residual-analysis-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="C2-L08_files/figure-html/fig-residual-analysis-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: Graphical residual analysis"><img src="C2-L08_files/figure-html/fig-residual-analysis-2.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-residual-analysis-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Graphical residual analysis
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-residual-analysis-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-residual-analysis-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="C2-L08_files/figure-html/fig-residual-analysis-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: Graphical residual analysis"><img src="C2-L08_files/figure-html/fig-residual-analysis-3.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-residual-analysis-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Graphical residual analysis
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-residual-analysis-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-residual-analysis-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="C2-L08_files/figure-html/fig-residual-analysis-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;5: Graphical residual analysis"><img src="C2-L08_files/figure-html/fig-residual-analysis-4.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-residual-analysis-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Graphical residual analysis
</figcaption>
</figure>
</div>
</div>
</div>
<p>The default model structure in <code>R</code> is the linear model with dummy indicator variables. Hence, the “intercept” in this model is the mean yield for the control group. The two other parameters are the estimated effects of treatments 1 and 2. To recover the mean yield in treatment group 1, you would add the intercept term and the treatment 1 effect. To see how <code>R</code> sets the model up, use the <code>model.matrix(lmod)</code> function to extract the <span class="math inline">X</span> matrix.</p>
<p>The <code>anova()</code> function in <code>R</code> compares variability of observations between the treatment groups to variability within the treatment groups to test whether all means are equal or whether at least one is different. The small p-value here suggests that the means are not all equal.</p>
<p>Let’s fit the <strong>cell means</strong> model in <code>JAGS</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"rjags"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>mod_string <span class="ot">=</span> <span class="st">" model {</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="st">    for (i in 1:length(y)) {</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="st">        y[i] ~ dnorm(mu[grp[i]], prec)</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="st">    for (j in 1:3) {</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="st">        mu[j] ~ dnorm(0.0, 1.0/1.0e6)</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="st">    prec ~ dgamma(5/2.0, 5*1.0/2.0)</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="st">    sig = sqrt( 1.0 / prec )</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="st">} "</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">82</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(PlantGrowth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   30 obs. of  2 variables:
 $ weight: num  4.17 5.58 5.18 6.11 4.5 4.61 5.17 4.53 5.33 5.14 ...
 $ group : Factor w/ 3 levels "ctrl","trt1",..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>data_jags <span class="ot">=</span> <span class="fu">list</span>(<span class="at">y=</span>PlantGrowth<span class="sc">$</span>weight, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">grp=</span><span class="fu">as.numeric</span>(PlantGrowth<span class="sc">$</span>group))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>params <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"mu"</span>, <span class="st">"sig"</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    inits <span class="ot">=</span> <span class="fu">list</span>(<span class="st">"mu"</span><span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">3</span>,<span class="fl">0.0</span>,<span class="fl">100.0</span>), <span class="st">"prec"</span><span class="ot">=</span><span class="fu">rgamma</span>(<span class="dv">1</span>,<span class="fl">1.0</span>,<span class="fl">1.0</span>))</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">=</span> <span class="fu">jags.model</span>(<span class="fu">textConnection</span>(mod_string), <span class="at">data=</span>data_jags, <span class="at">inits=</span>inits, <span class="at">n.chains=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 30
   Unobserved stochastic nodes: 4
   Total graph size: 74

Initializing model</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(mod, <span class="fl">1e3</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>mod_sim <span class="ot">=</span> <span class="fu">coda.samples</span>(<span class="at">model=</span>mod,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">variable.names=</span>params,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n.iter=</span><span class="fl">5e3</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>mod_csim <span class="ot">=</span> <span class="fu">as.mcmc</span>(<span class="fu">do.call</span>(rbind, mod_sim)) <span class="co"># combined chains</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="model-checking" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="model-checking"><span class="header-section-number">1.3</span> Model checking</h3>
<p>As usual, we check for convergence of our MCMC.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">1</span>, <span class="fl">2.5</span>, <span class="dv">1</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_sim)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gelman.diag</span>(mod_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Potential scale reduction factors:

      Point est. Upper C.I.
mu[1]          1          1
mu[2]          1          1
mu[3]          1          1
sig            1          1

Multivariate psrf

1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autocorr.diag</span>(mod_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              mu[1]         mu[2]         mu[3]           sig
Lag 0   1.000000000  1.0000000000  1.0000000000  1.0000000000
Lag 1  -0.003062017  0.0052995606 -0.0067392672  0.0904768459
Lag 5   0.006381183 -0.0001238036  0.0105612662  0.0001888026
Lag 10 -0.010514728 -0.0026934221  0.0127967196  0.0035914877
Lag 50 -0.002692437  0.0146715566 -0.0007870658 -0.0139336028</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">effectiveSize</span>(mod_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   mu[1]    mu[2]    mu[3]      sig 
15000.00 14736.83 14417.96 12512.56 </code></pre>
</div>
<div class="cell-output-display">
<div id="fig-mcmc-convergence" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mcmc-convergence-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="C2-L08_files/figure-html/fig-mcmc-convergence-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;6: MCMC convergence diagnostics"><img src="C2-L08_files/figure-html/fig-mcmc-convergence-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mcmc-convergence-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: MCMC convergence diagnostics
</figcaption>
</figure>
</div>
</div>
</div>
<p>We can also look at the residuals to see if there are any obvious problems with our model choice.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">pm_params =</span> <span class="fu">colMeans</span>(mod_csim))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    mu[1]     mu[2]     mu[3]       sig 
5.0326202 4.6618837 5.5267184 0.7122639 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">=</span> pm_params[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>][data_jags<span class="sc">$</span>grp]</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>resid <span class="ot">=</span> data_jags<span class="sc">$</span>y <span class="sc">-</span> yhat</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(resid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-residuals-vs-index" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-residuals-vs-index-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="C2-L08_files/figure-html/fig-residuals-vs-index-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;7: Residuals vs Index"><img src="C2-L08_files/figure-html/fig-residuals-vs-index-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-residuals-vs-index-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Residuals vs Index
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(yhat, resid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plantgrowth-residuals-vs-fitted" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plantgrowth-residuals-vs-fitted-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="C2-L08_files/figure-html/fig-plantgrowth-residuals-vs-fitted-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;8: Residuals vs Fitted values for PlantGrowth model"><img src="C2-L08_files/figure-html/fig-plantgrowth-residuals-vs-fitted-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plantgrowth-residuals-vs-fitted-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Residuals vs Fitted values for PlantGrowth model
</figcaption>
</figure>
</div>
</div>
</div>
<p>Again, it might be appropriate to have a separate variance for each group. We will have you do that as an exercise.</p>
</section>
<section id="results" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="results"><span class="header-section-number">1.4</span> Results</h3>
<p>Let’s look at the posterior summary of the parameters.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Iterations = 1001:6000
Thinning interval = 1 
Number of chains = 3 
Sample size per chain = 5000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

        Mean      SD  Naive SE Time-series SE
mu[1] 5.0326 0.22620 0.0018469      0.0018470
mu[2] 4.6619 0.22465 0.0018343      0.0018516
mu[3] 5.5267 0.22595 0.0018449      0.0018853
sig   0.7123 0.09187 0.0007501      0.0008218

2. Quantiles for each variable:

        2.5%    25%    50%    75%  97.5%
mu[1] 4.5876 4.8824 5.0331 5.1814 5.4727
mu[2] 4.2210 4.5145 4.6621 4.8114 5.1034
mu[3] 5.0771 5.3774 5.5271 5.6763 5.9668
sig   0.5599 0.6478 0.7022 0.7667 0.9211</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(mod_csim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          lower     upper
mu[1] 4.5773474 5.4604448
mu[2] 4.2236860 5.1057507
mu[3] 5.0868375 5.9743520
sig   0.5412728 0.8922947
attr(,"Probability")
[1] 0.95</code></pre>
</div>
</div>
<p>The <code>HPDinterval()</code> function in the <code>coda</code> package calculates intervals of highest posterior density for each parameter.</p>
<p>We are interested to know if one of the treatments increases mean yield. It is clear that treatment 1 does not. What about treatment 2?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mod_csim[,<span class="dv">3</span>] <span class="sc">&gt;</span> mod_csim[,<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9397333</code></pre>
</div>
</div>
<p>There is a high posterior probability that the mean yield for treatment 2 is greater than the mean yield for the control group.</p>
<p>It may be the case that treatment 2 would be costly to put into production. Suppose that to be worthwhile, this treatment must increase mean yield by 10%. What is the posterior probability that the increase is at least that?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mod_csim[,<span class="dv">3</span>] <span class="sc">&gt;</span> <span class="fl">1.1</span><span class="sc">*</span>mod_csim[,<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4838667</code></pre>
</div>
</div>
<p>We have about 50/50 odds that adopting treatment 2 would increase mean yield by at least 10%.</p>
</section>
</section>
<section id="two-factor-anova" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="two-factor-anova"><span class="header-section-number">2</span> Two Factor ANOVA</h2>
<section id="data" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="data"><span class="header-section-number">2.1</span> Data</h3>
<p>Let’s explore an example with two factors. We’ll use the <code>Warpbreaks</code> data set in <code>R</code>. Check the documentation for a description of the data by typing <code>?warpbreaks</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"warpbreaks"</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co">#?warpbreaks</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(warpbreaks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  breaks wool tension
1     26    A       L
2     30    A       L
3     54    A       L
4     25    A       L
5     70    A       L
6     52    A       L</code></pre>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This chunk is for displaying the output that was previously static.</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># If the static output below is preferred, this chunk can be removed </span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># and the static output remains unlabelled as it's not a code cell.</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># For a labeled table, this chunk should generate it.</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The original file had static output here:</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   breaks wool tension</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     26    A       L</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     30    A       L</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     54    A       L</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 4     25    A       L</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 5     70    A       L</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 6     52    A       L</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="co"># To make this a labeled table from code:</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(warpbreaks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-warpbreaks-preview" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-warpbreaks-preview-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Preview of first few rows of warpbreaks data
</figcaption>
<div aria-describedby="tbl-warpbreaks-preview-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-stdout">
<pre><code>  breaks wool tension
1     26    A       L
2     30    A       L
3     54    A       L
4     25    A       L
5     70    A       L
6     52    A       L</code></pre>
</div>
</div>
</figure>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(warpbreaks<span class="sc">$</span>wool, warpbreaks<span class="sc">$</span>tension)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-wool-tension-contingency" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-wool-tension-contingency-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Contingency table of wool type vs tension level
</figcaption>
<div aria-describedby="tbl-wool-tension-contingency-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-stdout">
<pre><code>   
    L M H
  A 9 9 9
  B 9 9 9</code></pre>
</div>
</div>
</figure>
</div>
<p>Again, we visualize the data with box plots.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(breaks <span class="sc">~</span> wool <span class="sc">+</span> tension, <span class="at">data=</span>warpbreaks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-warpbreaks-boxplot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-warpbreaks-boxplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="C2-L08_files/figure-html/fig-warpbreaks-boxplot-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;9: Warpbreaks boxplot"><img src="C2-L08_files/figure-html/fig-warpbreaks-boxplot-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-warpbreaks-boxplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Warpbreaks boxplot
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">log</span>(breaks) <span class="sc">~</span> wool <span class="sc">+</span> tension, <span class="at">data=</span>warpbreaks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-warpbreaks-boxplot-log" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-warpbreaks-boxplot-log-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="C2-L08_files/figure-html/fig-warpbreaks-boxplot-log-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figure&nbsp;10: Warpbreaks boxplot with log-transformed breaks"><img src="C2-L08_files/figure-html/fig-warpbreaks-boxplot-log-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-warpbreaks-boxplot-log-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Warpbreaks boxplot with log-transformed breaks
</figcaption>
</figure>
</div>
</div>
</div>
<p>The different groups have more similar variance if we use the logarithm of breaks. From this visualization, it looks like both factors may play a role in the number of breaks. It appears that there is a general decrease in breaks as we move from low to medium to high tension. Let’s start with a one-way model using tension only.</p>
</section>
<section id="one-way-model" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="one-way-model"><span class="header-section-number">2.2</span> One-way model</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>mod1_string <span class="ot">=</span> <span class="st">" model {</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="st">    for( i in 1:length(y)) {</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="st">        y[i] ~ dnorm(mu[tensGrp[i]], prec)</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="st">    for (j in 1:3) {</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="st">        mu[j] ~ dnorm(0.0, 1.0/1.0e6)</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="st">    prec ~ dgamma(5/2.0, 5*2.0/2.0)</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="st">    sig = sqrt(1.0 / prec)</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="st">} "</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">83</span>)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(warpbreaks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   54 obs. of  3 variables:
 $ breaks : num  26 30 54 25 70 52 51 26 67 18 ...
 $ wool   : Factor w/ 2 levels "A","B": 1 1 1 1 1 1 1 1 1 1 ...
 $ tension: Factor w/ 3 levels "L","M","H": 1 1 1 1 1 1 1 1 1 2 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>data1_jags <span class="ot">=</span> <span class="fu">list</span>(<span class="at">y=</span><span class="fu">log</span>(warpbreaks<span class="sc">$</span>breaks), <span class="at">tensGrp=</span><span class="fu">as.numeric</span>(warpbreaks<span class="sc">$</span>tension))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>params1 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"mu"</span>, <span class="st">"sig"</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">=</span> <span class="fu">jags.model</span>(<span class="fu">textConnection</span>(mod1_string), <span class="at">data=</span>data1_jags, <span class="at">n.chains=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 54
   Unobserved stochastic nodes: 4
   Total graph size: 123

Initializing model</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(mod1, <span class="fl">1e3</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>mod1_sim <span class="ot">=</span> <span class="fu">coda.samples</span>(<span class="at">model=</span>mod1,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">variable.names=</span>params1,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n.iter=</span><span class="fl">5e3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">## convergence diagnostics</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod1_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-m1-mcmc-convergence" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-m1-mcmc-convergence-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="C2-L08_files/figure-html/fig-m1-mcmc-convergence-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Figure&nbsp;11: MCMC convergence diagnostics for one-way tension model"><img src="C2-L08_files/figure-html/fig-m1-mcmc-convergence-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-m1-mcmc-convergence-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: MCMC convergence diagnostics for one-way tension model
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gelman.diag</span>(mod1_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Potential scale reduction factors:

      Point est. Upper C.I.
mu[1]          1          1
mu[2]          1          1
mu[3]          1          1
sig            1          1

Multivariate psrf

1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autocorr.diag</span>(mod1_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              mu[1]        mu[2]        mu[3]          sig
Lag 0   1.000000000  1.000000000  1.000000000  1.000000000
Lag 1  -0.007941346  0.010987010  0.011531633  0.058573549
Lag 5  -0.016863531 -0.001042528 -0.003001582 -0.007169178
Lag 10  0.004326670  0.003223160 -0.003412397 -0.007714962
Lag 50  0.004910054 -0.001144951 -0.011883866  0.009989784</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">effectiveSize</span>(mod1_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   mu[1]    mu[2]    mu[3]      sig 
15205.31 14581.29 14712.52 13120.27 </code></pre>
</div>
</div>
<p>The 95% posterior interval for the mean of group 2 (medium tension) overlaps with both the low and high groups, but the intervals for low and high group only slightly overlap. That is a pretty strong indication that the means for low and high tension are different. Let’s collect the DIC for this model and move on to the two-way model.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>dic1 <span class="ot">=</span> <span class="fu">dic.samples</span>(mod1, <span class="at">n.iter=</span><span class="fl">1e3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="two-way-additive-model" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="two-way-additive-model"><span class="header-section-number">2.3</span> Two-way additive model</h3>
<p>With two factors, one with two levels and the other with three, we have six treatment groups, which is the same situation we discussed when introducing multiple factor ANOVA. We will first fit the additive model which treats the two factors separately with no interaction. To get the <span class="math inline">X</span> matrix (or design matrix) for this model, we can create it in <code>R</code>.</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">model.matrix</span>( <span class="sc">~</span> wool <span class="sc">+</span> tension, <span class="at">data=</span>warpbreaks)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-additive-design-matrix-head" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-additive-design-matrix-head-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Head of the design matrix for the additive model
</figcaption>
<div aria-describedby="tbl-additive-design-matrix-head-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept) woolB tensionM tensionH
1           1     0        0        0
2           1     0        0        0
3           1     0        0        0
4           1     0        0        0
5           1     0        0        0
6           1     0        0        0</code></pre>
</div>
</div>
</figure>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-additive-design-matrix-tail" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-additive-design-matrix-tail-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Tail of the design matrix for the additive model
</figcaption>
<div aria-describedby="tbl-additive-design-matrix-tail-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept) woolB tensionM tensionH
49           1     1        0        1
50           1     1        0        1
51           1     1        0        1
52           1     1        0        1
53           1     1        0        1
54           1     1        0        1</code></pre>
</div>
</div>
</figure>
</div>
<p>By default, <code>R</code> has chosen the mean for wool A and low tension to be the intercept. Then, there is an effect for wool B, and effects for medium tension and high tension, each associated with dummy indicator variables.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>mod2_string <span class="ot">=</span> <span class="st">" model {</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="st">    for( i in 1:length(y)) {</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="st">        y[i] ~ dnorm(mu[i], prec)</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="st">        mu[i] = int + alpha*isWoolB[i] + beta[1]*isTensionM[i] + beta[2]*isTensionH[i]</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="st">    int ~ dnorm(0.0, 1.0/1.0e6)</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="st">    alpha ~ dnorm(0.0, 1.0/1.0e6)</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="st">    for (j in 1:2) {</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="st">        beta[j] ~ dnorm(0.0, 1.0/1.0e6)</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="st">    prec ~ dgamma(3/2.0, 3*1.0/2.0)</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="st">    sig = sqrt(1.0 / prec)</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="st">} "</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>data2_jags <span class="ot">=</span> <span class="fu">list</span>(<span class="at">y=</span><span class="fu">log</span>(warpbreaks<span class="sc">$</span>breaks), <span class="at">isWoolB=</span>X[,<span class="st">"woolB"</span>], <span class="at">isTensionM=</span>X[,<span class="st">"tensionM"</span>], <span class="at">isTensionH=</span>X[,<span class="st">"tensionH"</span>])</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>params2 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"int"</span>, <span class="st">"alpha"</span>, <span class="st">"beta"</span>, <span class="st">"sig"</span>)</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">jags.model</span>(<span class="fu">textConnection</span>(mod2_string), <span class="at">data=</span>data2_jags, <span class="at">n.chains=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 54
   Unobserved stochastic nodes: 5
   Total graph size: 243

Initializing model</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(mod2, <span class="fl">1e3</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>mod2_sim <span class="ot">=</span> <span class="fu">coda.samples</span>(<span class="at">model=</span>mod2,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">variable.names=</span>params2,</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n.iter=</span><span class="fl">5e3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="do">## convergence diagnostics</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2_sim)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gelman.diag</span>(mod2_sim)    <span class="co"># Corrected from mod1_sim</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Potential scale reduction factors:

        Point est. Upper C.I.
alpha            1          1
beta[1]          1          1
beta[2]          1          1
int              1          1
sig              1          1

Multivariate psrf

1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autocorr.diag</span>(mod2_sim)  <span class="co"># Corrected from mod1_sim</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               alpha      beta[1]      beta[2]        int          sig
Lag 0   1.0000000000 1.0000000000  1.000000000  1.0000000  1.000000000
Lag 1   0.4968194670 0.5102656287  0.494872375  0.7515924  0.080609351
Lag 5   0.0343303202 0.0949971557  0.088713436  0.1761326 -0.009359506
Lag 10  0.0003601524 0.0201045340  0.001936419  0.0235889 -0.001810904
Lag 50 -0.0109121932 0.0004853135 -0.001072841 -0.0126650 -0.005312828</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">effectiveSize</span>(mod2_sim) <span class="co"># Corrected from mod1_sim</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    alpha   beta[1]   beta[2]       int       sig 
 5113.400  3780.126  4144.590  2394.872 12354.355 </code></pre>
</div>
<div class="cell-output-display">
<div id="fig-additive-model-convergence-diagnostics-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-additive-model-convergence-diagnostics-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="C2-L08_files/figure-html/fig-additive-model-convergence-diagnostics-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure&nbsp;12: Convergence and diagnostics for the additive two-way ANOVA model"><img src="C2-L08_files/figure-html/fig-additive-model-convergence-diagnostics-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-additive-model-convergence-diagnostics-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: Convergence and diagnostics for the additive two-way ANOVA model
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-additive-model-convergence-diagnostics-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-additive-model-convergence-diagnostics-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="C2-L08_files/figure-html/fig-additive-model-convergence-diagnostics-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figure&nbsp;13: Convergence and diagnostics for the additive two-way ANOVA model"><img src="C2-L08_files/figure-html/fig-additive-model-convergence-diagnostics-2.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-additive-model-convergence-diagnostics-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: Convergence and diagnostics for the additive two-way ANOVA model
</figcaption>
</figure>
</div>
</div>
</div>
<p>Let’s summarize the results, collect the DIC for this model, and compare it to the first one-way model.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Iterations = 1001:6000
Thinning interval = 1 
Number of chains = 3 
Sample size per chain = 5000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

           Mean      SD  Naive SE Time-series SE
alpha   -0.1522 0.12384 0.0010111       0.001733
beta[1] -0.2901 0.15282 0.0012478       0.002504
beta[2] -0.4912 0.15141 0.0012363       0.002376
int      3.5781 0.12422 0.0010143       0.002553
sig      0.4545 0.04535 0.0003703       0.000409

2. Quantiles for each variable:

           2.5%     25%     50%      75%     97.5%
alpha   -0.3938 -0.2345 -0.1516 -0.07044  0.092157
beta[1] -0.5930 -0.3917 -0.2896 -0.18844  0.008243
beta[2] -0.7945 -0.5909 -0.4900 -0.38871 -0.196547
int      3.3326  3.4953  3.5765  3.66136  3.821986
sig      0.3768  0.4220  0.4509  0.48240  0.554006</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">dic2 =</span> <span class="fu">dic.samples</span>(mod2, <span class="at">n.iter=</span><span class="fl">1e3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean deviance:  55.64 
penalty 5.276 
Penalized deviance: 60.92 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>dic1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean deviance:  66.55 
penalty 4 
Penalized deviance: 70.55 </code></pre>
</div>
</div>
<p>This suggests there is much to be gained adding the wool factor to the model. Before we settle on this model however, we should consider whether there is an interaction. Let’s look again at the box plot with all six treatment groups.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">log</span>(breaks) <span class="sc">~</span> wool <span class="sc">+</span> tension, <span class="at">data=</span>warpbreaks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-interaction-check-boxplot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interaction-check-boxplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="C2-L08_files/figure-html/fig-interaction-check-boxplot-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Figure&nbsp;14: Re-examining boxplot of log(breaks) by wool and tension for interaction effects"><img src="C2-L08_files/figure-html/fig-interaction-check-boxplot-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interaction-check-boxplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: Re-examining boxplot of log(breaks) by wool and tension for interaction effects
</figcaption>
</figure>
</div>
</div>
</div>
<p>Our two-way model has a single effect for wool B and the estimate is negative. If this is true, then we would expect wool B to be associated with fewer breaks than its wool A counterpart on average. This is true for low and high tension, but it appears that breaks are <em>higher</em> for wool B when there is medium tension. That is, the effect for wool B is not consistent across tension levels, so it may appropriate to add an interaction term. In <code>R</code>, this would look like:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>lmod2 <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(breaks) <span class="sc">~</span> .<span class="sc">^</span><span class="dv">2</span>, <span class="at">data=</span>warpbreaks)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(breaks) ~ .^2, data = warpbreaks)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.81504 -0.27885  0.04042  0.27319  0.64358 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      3.7179     0.1247  29.824  &lt; 2e-16 ***
woolB           -0.4356     0.1763  -2.471  0.01709 *  
tensionM        -0.6012     0.1763  -3.410  0.00133 ** 
tensionH        -0.6003     0.1763  -3.405  0.00134 ** 
woolB:tensionM   0.6281     0.2493   2.519  0.01514 *  
woolB:tensionH   0.2221     0.2493   0.891  0.37749    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.374 on 48 degrees of freedom
Multiple R-squared:  0.3363,    Adjusted R-squared:  0.2672 
F-statistic: 4.864 on 5 and 48 DF,  p-value: 0.001116</code></pre>
</div>
</div>
<p>Adding the interaction, we get an effect for being in wool B and medium tension, as well as for being in wool B and high tension. There are now six parameters for the mean, one for each treatment group, so this model is equivalent to the full cell means model. Let’s use that.</p>
</section>
<section id="two-way-cell-means-model" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="two-way-cell-means-model"><span class="header-section-number">2.4</span> Two-way cell means model</h3>
<p>In this new model, <span class="math inline">\mu</span> will be a matrix with six entries, each corresponding to a treatment group.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>mod3_string <span class="ot">=</span> <span class="st">" model {</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="st">    for( i in 1:length(y)) {</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="st">        y[i] ~ dnorm(mu[woolGrp[i], tensGrp[i]], prec)</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="st">    for (j in 1:max(woolGrp)) {</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="st">        for (k in 1:max(tensGrp)) {</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="st">            mu[j,k] ~ dnorm(0.0, 1.0/1.0e6)</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="st">    prec ~ dgamma(3/2.0, 3*1.0/2.0)</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="st">    sig = sqrt(1.0 / prec)</span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a><span class="st">} "</span></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(warpbreaks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   54 obs. of  3 variables:
 $ breaks : num  26 30 54 25 70 52 51 26 67 18 ...
 $ wool   : Factor w/ 2 levels "A","B": 1 1 1 1 1 1 1 1 1 1 ...
 $ tension: Factor w/ 3 levels "L","M","H": 1 1 1 1 1 1 1 1 1 2 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>data3_jags <span class="ot">=</span> <span class="fu">list</span>(<span class="at">y=</span><span class="fu">log</span>(warpbreaks<span class="sc">$</span>breaks), <span class="at">woolGrp=</span><span class="fu">as.numeric</span>(warpbreaks<span class="sc">$</span>wool), <span class="at">tensGrp=</span><span class="fu">as.numeric</span>(warpbreaks<span class="sc">$</span>tension))</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>params3 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"mu"</span>, <span class="st">"sig"</span>)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">jags.model</span>(<span class="fu">textConnection</span>(mod3_string), <span class="at">data=</span>data3_jags, <span class="at">n.chains=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 54
   Unobserved stochastic nodes: 7
   Total graph size: 179

Initializing model</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(mod3, <span class="fl">1e3</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>mod3_sim <span class="ot">=</span> <span class="fu">coda.samples</span>(<span class="at">model=</span>mod3,</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">variable.names=</span>params3,</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n.iter=</span><span class="fl">5e3</span>)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>mod3_csim <span class="ot">=</span> <span class="fu">as.mcmc</span>(<span class="fu">do.call</span>(rbind, mod3_sim))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod3_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-cellmeans-traceplots-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cellmeans-traceplots-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="C2-L08_files/figure-html/fig-cellmeans-traceplots-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Figure&nbsp;15: Traceplots for the cell means model"><img src="C2-L08_files/figure-html/fig-cellmeans-traceplots-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cellmeans-traceplots-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15: Traceplots for the cell means model
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-cellmeans-traceplots-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cellmeans-traceplots-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="C2-L08_files/figure-html/fig-cellmeans-traceplots-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Figure&nbsp;16: Traceplots for the cell means model"><img src="C2-L08_files/figure-html/fig-cellmeans-traceplots-2.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cellmeans-traceplots-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16: Traceplots for the cell means model
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="do">## convergence diagnostics</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gelman.diag</span>(mod3_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Potential scale reduction factors:

        Point est. Upper C.I.
mu[1,1]          1          1
mu[2,1]          1          1
mu[1,2]          1          1
mu[2,2]          1          1
mu[1,3]          1          1
mu[2,3]          1          1
sig              1          1

Multivariate psrf

1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autocorr.diag</span>(mod3_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             mu[1,1]       mu[2,1]      mu[1,2]     mu[2,2]      mu[1,3]
Lag 0   1.0000000000  1.0000000000  1.000000000 1.000000000  1.000000000
Lag 1  -0.0133848308  0.0002948518 -0.004139662 0.002587829 -0.002748009
Lag 5   0.0104327074 -0.0047827295 -0.017802457 0.004909324 -0.006741489
Lag 10 -0.0002999751  0.0010498602 -0.008027593 0.004243136  0.001301729
Lag 50  0.0097774801 -0.0156455425 -0.015883219 0.001079133  0.004678206
             mu[2,3]          sig
Lag 0   1.0000000000  1.000000000
Lag 1   0.0005429844  0.100762949
Lag 5  -0.0008507273 -0.019476408
Lag 10  0.0049968697 -0.007446340
Lag 50 -0.0037544039 -0.003035055</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">effectiveSize</span>(mod3_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> mu[1,1]  mu[2,1]  mu[1,2]  mu[2,2]  mu[1,3]  mu[2,3]      sig 
15365.03 15000.00 16459.45 14709.36 15224.78 15000.00 12983.66 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">raftery.diag</span>(mod3_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]

Quantile (q) = 0.025
Accuracy (r) = +/- 0.005
Probability (s) = 0.95 
                                               
         Burn-in  Total Lower bound  Dependence
         (M)      (N)   (Nmin)       factor (I)
 mu[1,1] 2        3680  3746         0.982     
 mu[2,1] 2        3680  3746         0.982     
 mu[1,2] 2        3930  3746         1.050     
 mu[2,2] 2        3803  3746         1.020     
 mu[1,3] 2        3803  3746         1.020     
 mu[2,3] 2        3803  3746         1.020     
 sig     2        3741  3746         0.999     


[[2]]

Quantile (q) = 0.025
Accuracy (r) = +/- 0.005
Probability (s) = 0.95 
                                               
         Burn-in  Total Lower bound  Dependence
         (M)      (N)   (Nmin)       factor (I)
 mu[1,1] 2        3866  3746         1.030     
 mu[2,1] 2        3741  3746         0.999     
 mu[1,2] 2        3803  3746         1.020     
 mu[2,2] 2        3741  3746         0.999     
 mu[1,3] 2        3866  3746         1.030     
 mu[2,3] 2        3680  3746         0.982     
 sig     2        3866  3746         1.030     


[[3]]

Quantile (q) = 0.025
Accuracy (r) = +/- 0.005
Probability (s) = 0.95 
                                               
         Burn-in  Total Lower bound  Dependence
         (M)      (N)   (Nmin)       factor (I)
 mu[1,1] 2        3803  3746         1.020     
 mu[2,1] 3        4129  3746         1.100     
 mu[1,2] 2        3741  3746         0.999     
 mu[2,2] 2        3930  3746         1.050     
 mu[1,3] 2        3930  3746         1.050     
 mu[2,3] 2        3741  3746         0.999     
 sig     2        3803  3746         1.020     </code></pre>
</div>
</div>
<p>Let’s compute the DIC and compare with our previous models.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">dic3 =</span> <span class="fu">dic.samples</span>(mod3, <span class="at">n.iter=</span><span class="fl">1e3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean deviance:  52.04 
penalty 7.256 
Penalized deviance: 59.3 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>dic2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean deviance:  55.64 
penalty 5.276 
Penalized deviance: 60.92 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>dic1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean deviance:  66.55 
penalty 4 
Penalized deviance: 70.55 </code></pre>
</div>
</div>
<p>This suggests that the full model with interaction between wool and tension (which is equivalent to the cell means model) is the best for explaining/predicting warp breaks.</p>
</section>
<section id="results-1" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="results-1"><span class="header-section-number">2.5</span> Results</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Iterations = 1001:6000
Thinning interval = 1 
Number of chains = 3 
Sample size per chain = 5000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

         Mean      SD  Naive SE Time-series SE
mu[1,1] 3.717 0.14888 0.0012156      0.0012017
mu[2,1] 3.283 0.14926 0.0012187      0.0012187
mu[1,2] 3.115 0.14685 0.0011990      0.0011532
mu[2,2] 3.309 0.14915 0.0012178      0.0012301
mu[1,3] 3.117 0.14881 0.0012150      0.0012063
mu[2,3] 2.906 0.14872 0.0012143      0.0012144
sig     0.443 0.04481 0.0003659      0.0003953

2. Quantiles for each variable:

          2.5%    25%    50%    75% 97.5%
mu[1,1] 3.4280 3.6178 3.7169 3.8161 4.010
mu[2,1] 2.9870 3.1842 3.2822 3.3827 3.578
mu[1,2] 2.8263 3.0168 3.1160 3.2140 3.403
mu[2,2] 3.0118 3.2111 3.3096 3.4081 3.600
mu[1,3] 2.8253 3.0187 3.1167 3.2165 3.417
mu[2,3] 2.6156 2.8075 2.9056 3.0048 3.201
sig     0.3658 0.4112 0.4395 0.4706 0.542</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(mod3_csim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            lower     upper
mu[1,1] 3.4294925 4.0114002
mu[2,1] 2.9831110 3.5727123
mu[1,2] 2.8267999 3.4032513
mu[2,2] 3.0177461 3.6046419
mu[1,3] 2.8152699 3.4054009
mu[2,3] 2.6129511 3.1973685
sig     0.3605013 0.5345517
attr(,"Probability")
[1] 0.95</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>)) <span class="co"># arrange frame for plots</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">densplot</span>(mod3_csim[,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">2.0</span>, <span class="fl">4.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-cellmeans-posterior-densities" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cellmeans-posterior-densities-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="C2-L08_files/figure-html/fig-cellmeans-posterior-densities-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Figure&nbsp;17: Posterior densities for cell means"><img src="C2-L08_files/figure-html/fig-cellmeans-posterior-densities-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cellmeans-posterior-densities-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17: Posterior densities for cell means
</figcaption>
</figure>
</div>
</div>
</div>
<p>It might be tempting to look at comparisons between each combination of treatments, but we warn that this could yield spurious results. When we discussed the statistical modeling cycle, we said it is best not to search your results for interesting hypotheses, because if there are many hypotheses, some will appear to show “effects” or “associations” simply due to chance. Results are most reliable when we determine a relatively small number of hypotheses we are interested in beforehand, collect the data, and statistically evaluate the evidence for them.</p>
<p>One question we might be interested in with these data is finding the treatment combination that produces the fewest breaks. To calculate this, we can go through our posterior samples and for each sample, find out which group has the smallest mean. These counts help us determine the posterior probability that each of the treatment groups has the smallest mean.</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>( <span class="fu">table</span>( <span class="fu">apply</span>(mod3_csim[,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="dv">1</span>, which.min) ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-min-mean-treatment-probabilities" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-min-mean-treatment-probabilities-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Posterior probabilities of each treatment group having the smallest mean break rate
</figcaption>
<div aria-describedby="tbl-min-mean-treatment-probabilities-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-stdout">
<pre><code>
         2          3          4          5          6 
0.01786667 0.11753333 0.01066667 0.11913333 0.73480000 </code></pre>
</div>
</div>
</figure>
</div>
<p>The evidence supports wool B with high tension as the treatment that produces the fewest breaks.</p>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script type="text/javascript">

// replace cmd keyboard shortcut w/ control on non-Mac platforms
const kPlatformMac = typeof navigator !== 'undefined' ? /Mac/.test(navigator.platform) : false;
if (!kPlatformMac) {
   var kbds = document.querySelectorAll("kbd")
   kbds.forEach(function(kbd) {
      kbd.innerHTML = kbd.innerHTML.replace(/⌘/g, '⌃');
   });
}

// tweak headings in pymd
document.querySelectorAll(".pymd span.co").forEach(el => {
   if (!el.innerText.startsWith("#|")) {
      el.style.fontWeight = 1000;
   }
});

</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb103" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "ANOVA"</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Bayesian Statistics: Techniques and Models"</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "An overview of ANOVA in the context of Bayesian statistics."</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="co">  - Monte Carlo Estimation</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="an">keywords:</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="co">  - ANOVA</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="co">  - Bayesian statistics</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="co">  - R programming</span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="co">  - statistical modeling</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="co">  - Analysis of Variance</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction to ANOVA</span></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a><span class="al">![Introduction to ANOVA](images/c2l08-ss-01-ANOVA.png)</span>{.column-margin width="200px"}</span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a><span class="fu">## One way ANOVA model using JAGS</span></span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data &amp; EDA</span></span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a>As an example of a one-way ANOVA, we'll look at the Plant Growth data in <span class="in">`R`</span>.</span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-26"><a href="#cb103-26" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-27"><a href="#cb103-27" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: C2-L08-1</span></span>
<span id="cb103-28"><a href="#cb103-28" aria-hidden="true" tabindex="-1"></a><span class="co">#| lst-label: lst-load-PlantGrowth</span></span>
<span id="cb103-29"><a href="#cb103-29" aria-hidden="true" tabindex="-1"></a><span class="co">#| lst-cap: Plant Growth Query</span></span>
<span id="cb103-30"><a href="#cb103-30" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: "id=lst-load-PlantGrowth lst-cap='Plant Growth Query'"</span></span>
<span id="cb103-31"><a href="#cb103-31" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"PlantGrowth"</span>)</span>
<span id="cb103-32"><a href="#cb103-32" aria-hidden="true" tabindex="-1"></a><span class="co">#?PlantGrowth</span></span>
<span id="cb103-33"><a href="#cb103-33" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(PlantGrowth)</span>
<span id="cb103-34"><a href="#cb103-34" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-35"><a href="#cb103-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-36"><a href="#cb103-36" aria-hidden="true" tabindex="-1"></a>We first load the dataset (@lst-load-PlantGrowth)</span>
<span id="cb103-37"><a href="#cb103-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-38"><a href="#cb103-38" aria-hidden="true" tabindex="-1"></a>Because the explanatory variable <span class="in">`group`</span> is a factor and not continuous, we choose to visualize the data with box plots rather than scatter plots.</span>
<span id="cb103-39"><a href="#cb103-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-42"><a href="#cb103-42" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-43"><a href="#cb103-43" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-platgrowth-boxplot</span></span>
<span id="cb103-44"><a href="#cb103-44" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "PlantGrowth boxplot"</span></span>
<span id="cb103-45"><a href="#cb103-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-46"><a href="#cb103-46" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(weight <span class="sc">~</span> group, <span class="at">data=</span>PlantGrowth)</span>
<span id="cb103-47"><a href="#cb103-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-48"><a href="#cb103-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-49"><a href="#cb103-49" aria-hidden="true" tabindex="-1"></a>The box plots summarize the distribution of the data for each of the three groups. It appears that treatment 2 has the highest mean yield. It might be questionable whether each group has the same variance, but we'll assume that is the case.</span>
<span id="cb103-50"><a href="#cb103-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-51"><a href="#cb103-51" aria-hidden="true" tabindex="-1"></a><span class="fu">### Modeling</span></span>
<span id="cb103-52"><a href="#cb103-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-53"><a href="#cb103-53" aria-hidden="true" tabindex="-1"></a>Again, we can start with the reference analysis (with a noninformative prior) with a linear model in <span class="in">`R`</span>.</span>
<span id="cb103-54"><a href="#cb103-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-57"><a href="#cb103-57" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-58"><a href="#cb103-58" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fit-linear-model</span></span>
<span id="cb103-59"><a href="#cb103-59" aria-hidden="true" tabindex="-1"></a>lmod <span class="ot">=</span> <span class="fu">lm</span>(weight <span class="sc">~</span> group, <span class="at">data=</span>PlantGrowth)</span>
<span id="cb103-60"><a href="#cb103-60" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmod)</span>
<span id="cb103-61"><a href="#cb103-61" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-62"><a href="#cb103-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-65"><a href="#cb103-65" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-66"><a href="#cb103-66" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: anova-linear-model</span></span>
<span id="cb103-67"><a href="#cb103-67" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lmod)</span>
<span id="cb103-68"><a href="#cb103-68" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-69"><a href="#cb103-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-72"><a href="#cb103-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-73"><a href="#cb103-73" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-residual-analysis</span></span>
<span id="cb103-74"><a href="#cb103-74" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Graphical residual analysis"</span></span>
<span id="cb103-75"><a href="#cb103-75" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lmod) <span class="co"># for graphical residual analysis</span></span>
<span id="cb103-76"><a href="#cb103-76" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-77"><a href="#cb103-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-78"><a href="#cb103-78" aria-hidden="true" tabindex="-1"></a>The default model structure in <span class="in">`R`</span> is the linear model with dummy indicator variables. Hence, the "intercept" in this model is the mean yield for the control group. The two other parameters are the estimated effects of treatments 1 and 2. To recover the mean yield in treatment group 1, you would add the intercept term and the treatment 1 effect. To see how <span class="in">`R`</span> sets the model up, use the <span class="in">`model.matrix(lmod)`</span> function to extract the $X$ matrix.</span>
<span id="cb103-79"><a href="#cb103-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-80"><a href="#cb103-80" aria-hidden="true" tabindex="-1"></a>The <span class="in">`anova()`</span> function in <span class="in">`R`</span> compares variability of observations between the treatment groups to variability within the treatment groups to test whether all means are equal or whether at least one is different. The small p-value here suggests that the means are not all equal.</span>
<span id="cb103-81"><a href="#cb103-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-82"><a href="#cb103-82" aria-hidden="true" tabindex="-1"></a>Let's fit the **cell means** model in <span class="in">`JAGS`</span>.</span>
<span id="cb103-83"><a href="#cb103-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-86"><a href="#cb103-86" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-87"><a href="#cb103-87" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-rjags</span></span>
<span id="cb103-88"><a href="#cb103-88" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: False</span></span>
<span id="cb103-89"><a href="#cb103-89" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"rjags"</span>)</span>
<span id="cb103-90"><a href="#cb103-90" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-91"><a href="#cb103-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-94"><a href="#cb103-94" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-95"><a href="#cb103-95" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: m1-jags-model-string</span></span>
<span id="cb103-96"><a href="#cb103-96" aria-hidden="true" tabindex="-1"></a>mod_string <span class="ot">=</span> <span class="st">" model {</span></span>
<span id="cb103-97"><a href="#cb103-97" aria-hidden="true" tabindex="-1"></a><span class="st">    for (i in 1:length(y)) {</span></span>
<span id="cb103-98"><a href="#cb103-98" aria-hidden="true" tabindex="-1"></a><span class="st">        y[i] ~ dnorm(mu[grp[i]], prec)</span></span>
<span id="cb103-99"><a href="#cb103-99" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb103-100"><a href="#cb103-100" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb103-101"><a href="#cb103-101" aria-hidden="true" tabindex="-1"></a><span class="st">    for (j in 1:3) {</span></span>
<span id="cb103-102"><a href="#cb103-102" aria-hidden="true" tabindex="-1"></a><span class="st">        mu[j] ~ dnorm(0.0, 1.0/1.0e6)</span></span>
<span id="cb103-103"><a href="#cb103-103" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb103-104"><a href="#cb103-104" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb103-105"><a href="#cb103-105" aria-hidden="true" tabindex="-1"></a><span class="st">    prec ~ dgamma(5/2.0, 5*1.0/2.0)</span></span>
<span id="cb103-106"><a href="#cb103-106" aria-hidden="true" tabindex="-1"></a><span class="st">    sig = sqrt( 1.0 / prec )</span></span>
<span id="cb103-107"><a href="#cb103-107" aria-hidden="true" tabindex="-1"></a><span class="st">} "</span></span>
<span id="cb103-108"><a href="#cb103-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-109"><a href="#cb103-109" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">82</span>)</span>
<span id="cb103-110"><a href="#cb103-110" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(PlantGrowth)</span>
<span id="cb103-111"><a href="#cb103-111" aria-hidden="true" tabindex="-1"></a>data_jags <span class="ot">=</span> <span class="fu">list</span>(<span class="at">y=</span>PlantGrowth<span class="sc">$</span>weight, </span>
<span id="cb103-112"><a href="#cb103-112" aria-hidden="true" tabindex="-1"></a>              <span class="at">grp=</span><span class="fu">as.numeric</span>(PlantGrowth<span class="sc">$</span>group))</span>
<span id="cb103-113"><a href="#cb103-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-114"><a href="#cb103-114" aria-hidden="true" tabindex="-1"></a>params <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"mu"</span>, <span class="st">"sig"</span>)</span>
<span id="cb103-115"><a href="#cb103-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-116"><a href="#cb103-116" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb103-117"><a href="#cb103-117" aria-hidden="true" tabindex="-1"></a>    inits <span class="ot">=</span> <span class="fu">list</span>(<span class="st">"mu"</span><span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">3</span>,<span class="fl">0.0</span>,<span class="fl">100.0</span>), <span class="st">"prec"</span><span class="ot">=</span><span class="fu">rgamma</span>(<span class="dv">1</span>,<span class="fl">1.0</span>,<span class="fl">1.0</span>))</span>
<span id="cb103-118"><a href="#cb103-118" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-119"><a href="#cb103-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-120"><a href="#cb103-120" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">=</span> <span class="fu">jags.model</span>(<span class="fu">textConnection</span>(mod_string), <span class="at">data=</span>data_jags, <span class="at">inits=</span>inits, <span class="at">n.chains=</span><span class="dv">3</span>)</span>
<span id="cb103-121"><a href="#cb103-121" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(mod, <span class="fl">1e3</span>)</span>
<span id="cb103-122"><a href="#cb103-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-123"><a href="#cb103-123" aria-hidden="true" tabindex="-1"></a>mod_sim <span class="ot">=</span> <span class="fu">coda.samples</span>(<span class="at">model=</span>mod,</span>
<span id="cb103-124"><a href="#cb103-124" aria-hidden="true" tabindex="-1"></a>                        <span class="at">variable.names=</span>params,</span>
<span id="cb103-125"><a href="#cb103-125" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n.iter=</span><span class="fl">5e3</span>)</span>
<span id="cb103-126"><a href="#cb103-126" aria-hidden="true" tabindex="-1"></a>mod_csim <span class="ot">=</span> <span class="fu">as.mcmc</span>(<span class="fu">do.call</span>(rbind, mod_sim)) <span class="co"># combined chains</span></span>
<span id="cb103-127"><a href="#cb103-127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-128"><a href="#cb103-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-129"><a href="#cb103-129" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model checking</span></span>
<span id="cb103-130"><a href="#cb103-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-131"><a href="#cb103-131" aria-hidden="true" tabindex="-1"></a>As usual, we check for convergence of our MCMC.</span>
<span id="cb103-132"><a href="#cb103-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-135"><a href="#cb103-135" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-136"><a href="#cb103-136" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-mcmc-convergence</span></span>
<span id="cb103-137"><a href="#cb103-137" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "MCMC convergence diagnostics"</span></span>
<span id="cb103-138"><a href="#cb103-138" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb103-139"><a href="#cb103-139" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">1</span>, <span class="fl">2.5</span>, <span class="dv">1</span>))</span>
<span id="cb103-140"><a href="#cb103-140" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_sim)</span>
<span id="cb103-141"><a href="#cb103-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-142"><a href="#cb103-142" aria-hidden="true" tabindex="-1"></a><span class="fu">gelman.diag</span>(mod_sim)</span>
<span id="cb103-143"><a href="#cb103-143" aria-hidden="true" tabindex="-1"></a><span class="fu">autocorr.diag</span>(mod_sim)</span>
<span id="cb103-144"><a href="#cb103-144" aria-hidden="true" tabindex="-1"></a><span class="fu">effectiveSize</span>(mod_sim)</span>
<span id="cb103-145"><a href="#cb103-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-146"><a href="#cb103-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-147"><a href="#cb103-147" aria-hidden="true" tabindex="-1"></a>We can also look at the residuals to see if there are any obvious problems with our model choice.</span>
<span id="cb103-148"><a href="#cb103-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-151"><a href="#cb103-151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-152"><a href="#cb103-152" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: calculate-posterior-means</span></span>
<span id="cb103-153"><a href="#cb103-153" aria-hidden="true" tabindex="-1"></a>(<span class="at">pm_params =</span> <span class="fu">colMeans</span>(mod_csim))</span>
<span id="cb103-154"><a href="#cb103-154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-155"><a href="#cb103-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-158"><a href="#cb103-158" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-159"><a href="#cb103-159" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-residuals-vs-index</span></span>
<span id="cb103-160"><a href="#cb103-160" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Residuals vs Index"</span></span>
<span id="cb103-161"><a href="#cb103-161" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">=</span> pm_params[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>][data_jags<span class="sc">$</span>grp]</span>
<span id="cb103-162"><a href="#cb103-162" aria-hidden="true" tabindex="-1"></a>resid <span class="ot">=</span> data_jags<span class="sc">$</span>y <span class="sc">-</span> yhat</span>
<span id="cb103-163"><a href="#cb103-163" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(resid)</span>
<span id="cb103-164"><a href="#cb103-164" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-165"><a href="#cb103-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-168"><a href="#cb103-168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-169"><a href="#cb103-169" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plantgrowth-residuals-vs-fitted</span></span>
<span id="cb103-170"><a href="#cb103-170" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Residuals vs Fitted values for PlantGrowth model"</span></span>
<span id="cb103-171"><a href="#cb103-171" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(yhat, resid)</span>
<span id="cb103-172"><a href="#cb103-172" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-173"><a href="#cb103-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-174"><a href="#cb103-174" aria-hidden="true" tabindex="-1"></a>Again, it might be appropriate to have a separate variance for each group. We will have you do that as an exercise.</span>
<span id="cb103-175"><a href="#cb103-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-176"><a href="#cb103-176" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results</span></span>
<span id="cb103-177"><a href="#cb103-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-178"><a href="#cb103-178" aria-hidden="true" tabindex="-1"></a>Let's look at the posterior summary of the parameters.</span>
<span id="cb103-179"><a href="#cb103-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-182"><a href="#cb103-182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-183"><a href="#cb103-183" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: summary-posterior</span></span>
<span id="cb103-184"><a href="#cb103-184" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_sim)</span>
<span id="cb103-185"><a href="#cb103-185" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-186"><a href="#cb103-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-189"><a href="#cb103-189" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-190"><a href="#cb103-190" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: hpd-interval</span></span>
<span id="cb103-191"><a href="#cb103-191" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(mod_csim)</span>
<span id="cb103-192"><a href="#cb103-192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-193"><a href="#cb103-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-194"><a href="#cb103-194" aria-hidden="true" tabindex="-1"></a>The <span class="in">`HPDinterval()`</span> function in the <span class="in">`coda`</span> package calculates intervals of highest posterior density for each parameter.</span>
<span id="cb103-195"><a href="#cb103-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-196"><a href="#cb103-196" aria-hidden="true" tabindex="-1"></a>We are interested to know if one of the treatments increases mean yield. It is clear that treatment 1 does not. What about treatment 2?</span>
<span id="cb103-197"><a href="#cb103-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-200"><a href="#cb103-200" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-201"><a href="#cb103-201" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: treatment2-greater-control</span></span>
<span id="cb103-202"><a href="#cb103-202" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mod_csim[,<span class="dv">3</span>] <span class="sc">&gt;</span> mod_csim[,<span class="dv">1</span>])</span>
<span id="cb103-203"><a href="#cb103-203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-204"><a href="#cb103-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-205"><a href="#cb103-205" aria-hidden="true" tabindex="-1"></a>There is a high posterior probability that the mean yield for treatment 2 is greater than the mean yield for the control group.</span>
<span id="cb103-206"><a href="#cb103-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-207"><a href="#cb103-207" aria-hidden="true" tabindex="-1"></a>It may be the case that treatment 2 would be costly to put into production. Suppose that to be worthwhile, this treatment must increase mean yield by 10%. What is the posterior probability that the increase is at least that?</span>
<span id="cb103-208"><a href="#cb103-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-211"><a href="#cb103-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-212"><a href="#cb103-212" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: treatment2-greater-10percent</span></span>
<span id="cb103-213"><a href="#cb103-213" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mod_csim[,<span class="dv">3</span>] <span class="sc">&gt;</span> <span class="fl">1.1</span><span class="sc">*</span>mod_csim[,<span class="dv">1</span>])</span>
<span id="cb103-214"><a href="#cb103-214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-215"><a href="#cb103-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-216"><a href="#cb103-216" aria-hidden="true" tabindex="-1"></a>We have about 50/50 odds that adopting treatment 2 would increase mean yield by at least 10%.</span>
<span id="cb103-217"><a href="#cb103-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-218"><a href="#cb103-218" aria-hidden="true" tabindex="-1"></a><span class="fu">## Two Factor ANOVA</span></span>
<span id="cb103-219"><a href="#cb103-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-220"><a href="#cb103-220" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data</span></span>
<span id="cb103-221"><a href="#cb103-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-222"><a href="#cb103-222" aria-hidden="true" tabindex="-1"></a>Let's explore an example with two factors. We'll use the <span class="in">`Warpbreaks`</span> data set in <span class="in">`R`</span>. Check the documentation for a description of the data by typing <span class="in">`?warpbreaks`</span>.</span>
<span id="cb103-223"><a href="#cb103-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-226"><a href="#cb103-226" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-227"><a href="#cb103-227" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-warpbreaks-data</span></span>
<span id="cb103-228"><a href="#cb103-228" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"warpbreaks"</span>)</span>
<span id="cb103-229"><a href="#cb103-229" aria-hidden="true" tabindex="-1"></a><span class="co">#?warpbreaks</span></span>
<span id="cb103-230"><a href="#cb103-230" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(warpbreaks)</span>
<span id="cb103-231"><a href="#cb103-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-232"><a href="#cb103-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-235"><a href="#cb103-235" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-236"><a href="#cb103-236" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-warpbreaks-preview</span></span>
<span id="cb103-237"><a href="#cb103-237" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Preview of first few rows of warpbreaks data"</span></span>
<span id="cb103-238"><a href="#cb103-238" aria-hidden="true" tabindex="-1"></a><span class="co"># This chunk is for displaying the output that was previously static.</span></span>
<span id="cb103-239"><a href="#cb103-239" aria-hidden="true" tabindex="-1"></a><span class="co"># If the static output below is preferred, this chunk can be removed </span></span>
<span id="cb103-240"><a href="#cb103-240" aria-hidden="true" tabindex="-1"></a><span class="co"># and the static output remains unlabelled as it's not a code cell.</span></span>
<span id="cb103-241"><a href="#cb103-241" aria-hidden="true" tabindex="-1"></a><span class="co"># For a labeled table, this chunk should generate it.</span></span>
<span id="cb103-242"><a href="#cb103-242" aria-hidden="true" tabindex="-1"></a><span class="co"># The original file had static output here:</span></span>
<span id="cb103-243"><a href="#cb103-243" aria-hidden="true" tabindex="-1"></a><span class="do">##   breaks wool tension</span></span>
<span id="cb103-244"><a href="#cb103-244" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     26    A       L</span></span>
<span id="cb103-245"><a href="#cb103-245" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     30    A       L</span></span>
<span id="cb103-246"><a href="#cb103-246" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     54    A       L</span></span>
<span id="cb103-247"><a href="#cb103-247" aria-hidden="true" tabindex="-1"></a><span class="do">## 4     25    A       L</span></span>
<span id="cb103-248"><a href="#cb103-248" aria-hidden="true" tabindex="-1"></a><span class="do">## 5     70    A       L</span></span>
<span id="cb103-249"><a href="#cb103-249" aria-hidden="true" tabindex="-1"></a><span class="do">## 6     52    A       L</span></span>
<span id="cb103-250"><a href="#cb103-250" aria-hidden="true" tabindex="-1"></a><span class="co"># To make this a labeled table from code:</span></span>
<span id="cb103-251"><a href="#cb103-251" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(warpbreaks)</span>
<span id="cb103-252"><a href="#cb103-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-253"><a href="#cb103-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-256"><a href="#cb103-256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-257"><a href="#cb103-257" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-wool-tension-contingency</span></span>
<span id="cb103-258"><a href="#cb103-258" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Contingency table of wool type vs tension level"</span></span>
<span id="cb103-259"><a href="#cb103-259" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(warpbreaks<span class="sc">$</span>wool, warpbreaks<span class="sc">$</span>tension)</span>
<span id="cb103-260"><a href="#cb103-260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-261"><a href="#cb103-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-262"><a href="#cb103-262" aria-hidden="true" tabindex="-1"></a>Again, we visualize the data with box plots.</span>
<span id="cb103-263"><a href="#cb103-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-266"><a href="#cb103-266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-267"><a href="#cb103-267" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-warpbreaks-boxplot</span></span>
<span id="cb103-268"><a href="#cb103-268" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Warpbreaks boxplot"</span></span>
<span id="cb103-269"><a href="#cb103-269" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(breaks <span class="sc">~</span> wool <span class="sc">+</span> tension, <span class="at">data=</span>warpbreaks)</span>
<span id="cb103-270"><a href="#cb103-270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-271"><a href="#cb103-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-274"><a href="#cb103-274" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-275"><a href="#cb103-275" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-warpbreaks-boxplot-log</span></span>
<span id="cb103-276"><a href="#cb103-276" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Warpbreaks boxplot with log-transformed breaks"</span></span>
<span id="cb103-277"><a href="#cb103-277" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">log</span>(breaks) <span class="sc">~</span> wool <span class="sc">+</span> tension, <span class="at">data=</span>warpbreaks)</span>
<span id="cb103-278"><a href="#cb103-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-279"><a href="#cb103-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-280"><a href="#cb103-280" aria-hidden="true" tabindex="-1"></a>The different groups have more similar variance if we use the logarithm of breaks. From this visualization, it looks like both factors may play a role in the number of breaks. It appears that there is a general decrease in breaks as we move from low to medium to high tension. Let's start with a one-way model using tension only.</span>
<span id="cb103-281"><a href="#cb103-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-282"><a href="#cb103-282" aria-hidden="true" tabindex="-1"></a><span class="fu">### One-way model</span></span>
<span id="cb103-283"><a href="#cb103-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-286"><a href="#cb103-286" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-287"><a href="#cb103-287" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: oneway-tension-model-definition</span></span>
<span id="cb103-288"><a href="#cb103-288" aria-hidden="true" tabindex="-1"></a>mod1_string <span class="ot">=</span> <span class="st">" model {</span></span>
<span id="cb103-289"><a href="#cb103-289" aria-hidden="true" tabindex="-1"></a><span class="st">    for( i in 1:length(y)) {</span></span>
<span id="cb103-290"><a href="#cb103-290" aria-hidden="true" tabindex="-1"></a><span class="st">        y[i] ~ dnorm(mu[tensGrp[i]], prec)</span></span>
<span id="cb103-291"><a href="#cb103-291" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb103-292"><a href="#cb103-292" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb103-293"><a href="#cb103-293" aria-hidden="true" tabindex="-1"></a><span class="st">    for (j in 1:3) {</span></span>
<span id="cb103-294"><a href="#cb103-294" aria-hidden="true" tabindex="-1"></a><span class="st">        mu[j] ~ dnorm(0.0, 1.0/1.0e6)</span></span>
<span id="cb103-295"><a href="#cb103-295" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb103-296"><a href="#cb103-296" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb103-297"><a href="#cb103-297" aria-hidden="true" tabindex="-1"></a><span class="st">    prec ~ dgamma(5/2.0, 5*2.0/2.0)</span></span>
<span id="cb103-298"><a href="#cb103-298" aria-hidden="true" tabindex="-1"></a><span class="st">    sig = sqrt(1.0 / prec)</span></span>
<span id="cb103-299"><a href="#cb103-299" aria-hidden="true" tabindex="-1"></a><span class="st">} "</span></span>
<span id="cb103-300"><a href="#cb103-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-301"><a href="#cb103-301" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">83</span>)</span>
<span id="cb103-302"><a href="#cb103-302" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(warpbreaks)</span>
<span id="cb103-303"><a href="#cb103-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-304"><a href="#cb103-304" aria-hidden="true" tabindex="-1"></a>data1_jags <span class="ot">=</span> <span class="fu">list</span>(<span class="at">y=</span><span class="fu">log</span>(warpbreaks<span class="sc">$</span>breaks), <span class="at">tensGrp=</span><span class="fu">as.numeric</span>(warpbreaks<span class="sc">$</span>tension))</span>
<span id="cb103-305"><a href="#cb103-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-306"><a href="#cb103-306" aria-hidden="true" tabindex="-1"></a>params1 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"mu"</span>, <span class="st">"sig"</span>)</span>
<span id="cb103-307"><a href="#cb103-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-308"><a href="#cb103-308" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">=</span> <span class="fu">jags.model</span>(<span class="fu">textConnection</span>(mod1_string), <span class="at">data=</span>data1_jags, <span class="at">n.chains=</span><span class="dv">3</span>)</span>
<span id="cb103-309"><a href="#cb103-309" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(mod1, <span class="fl">1e3</span>)</span>
<span id="cb103-310"><a href="#cb103-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-311"><a href="#cb103-311" aria-hidden="true" tabindex="-1"></a>mod1_sim <span class="ot">=</span> <span class="fu">coda.samples</span>(<span class="at">model=</span>mod1,</span>
<span id="cb103-312"><a href="#cb103-312" aria-hidden="true" tabindex="-1"></a>                        <span class="at">variable.names=</span>params1,</span>
<span id="cb103-313"><a href="#cb103-313" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n.iter=</span><span class="fl">5e3</span>)</span>
<span id="cb103-314"><a href="#cb103-314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-315"><a href="#cb103-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-318"><a href="#cb103-318" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-319"><a href="#cb103-319" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-m1-mcmc-convergence</span></span>
<span id="cb103-320"><a href="#cb103-320" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "MCMC convergence diagnostics for one-way tension model"</span></span>
<span id="cb103-321"><a href="#cb103-321" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb103-322"><a href="#cb103-322" aria-hidden="true" tabindex="-1"></a><span class="do">## convergence diagnostics</span></span>
<span id="cb103-323"><a href="#cb103-323" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod1_sim)</span>
<span id="cb103-324"><a href="#cb103-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-325"><a href="#cb103-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-328"><a href="#cb103-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-329"><a href="#cb103-329" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: m1-diag-mcmc-convergence</span></span>
<span id="cb103-330"><a href="#cb103-330" aria-hidden="true" tabindex="-1"></a><span class="fu">gelman.diag</span>(mod1_sim)</span>
<span id="cb103-331"><a href="#cb103-331" aria-hidden="true" tabindex="-1"></a><span class="fu">autocorr.diag</span>(mod1_sim)</span>
<span id="cb103-332"><a href="#cb103-332" aria-hidden="true" tabindex="-1"></a><span class="fu">effectiveSize</span>(mod1_sim)</span>
<span id="cb103-333"><a href="#cb103-333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-334"><a href="#cb103-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-335"><a href="#cb103-335" aria-hidden="true" tabindex="-1"></a>The 95% posterior interval for the mean of group 2 (medium tension) overlaps with both the low and high groups, but the intervals for low and high group only slightly overlap. That is a pretty strong indication that the means for low and high tension are different. Let's collect the DIC for this model and move on to the two-way model.</span>
<span id="cb103-336"><a href="#cb103-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-339"><a href="#cb103-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-340"><a href="#cb103-340" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: m1-dic</span></span>
<span id="cb103-341"><a href="#cb103-341" aria-hidden="true" tabindex="-1"></a>dic1 <span class="ot">=</span> <span class="fu">dic.samples</span>(mod1, <span class="at">n.iter=</span><span class="fl">1e3</span>)</span>
<span id="cb103-342"><a href="#cb103-342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-343"><a href="#cb103-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-344"><a href="#cb103-344" aria-hidden="true" tabindex="-1"></a><span class="fu">### Two-way additive model</span></span>
<span id="cb103-345"><a href="#cb103-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-346"><a href="#cb103-346" aria-hidden="true" tabindex="-1"></a>With two factors, one with two levels and the other with three, we have six treatment groups, which is the same situation we discussed when introducing multiple factor ANOVA. We will first fit the additive model which treats the two factors separately with no interaction. To get the $X$ matrix (or design matrix) for this model, we can create it in <span class="in">`R`</span>.</span>
<span id="cb103-347"><a href="#cb103-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-350"><a href="#cb103-350" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-351"><a href="#cb103-351" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-additive-design-matrix-head</span></span>
<span id="cb103-352"><a href="#cb103-352" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Head of the design matrix for the additive model"</span></span>
<span id="cb103-353"><a href="#cb103-353" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">model.matrix</span>( <span class="sc">~</span> wool <span class="sc">+</span> tension, <span class="at">data=</span>warpbreaks)</span>
<span id="cb103-354"><a href="#cb103-354" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(X)</span>
<span id="cb103-355"><a href="#cb103-355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-356"><a href="#cb103-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-359"><a href="#cb103-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-360"><a href="#cb103-360" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-additive-design-matrix-tail</span></span>
<span id="cb103-361"><a href="#cb103-361" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Tail of the design matrix for the additive model"</span></span>
<span id="cb103-362"><a href="#cb103-362" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(X)</span>
<span id="cb103-363"><a href="#cb103-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-364"><a href="#cb103-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-365"><a href="#cb103-365" aria-hidden="true" tabindex="-1"></a>By default, <span class="in">`R`</span> has chosen the mean for wool A and low tension to be the intercept. Then, there is an effect for wool B, and effects for medium tension and high tension, each associated with dummy indicator variables.</span>
<span id="cb103-366"><a href="#cb103-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-369"><a href="#cb103-369" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-370"><a href="#cb103-370" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: additive-model-definition-fit</span></span>
<span id="cb103-371"><a href="#cb103-371" aria-hidden="true" tabindex="-1"></a>mod2_string <span class="ot">=</span> <span class="st">" model {</span></span>
<span id="cb103-372"><a href="#cb103-372" aria-hidden="true" tabindex="-1"></a><span class="st">    for( i in 1:length(y)) {</span></span>
<span id="cb103-373"><a href="#cb103-373" aria-hidden="true" tabindex="-1"></a><span class="st">        y[i] ~ dnorm(mu[i], prec)</span></span>
<span id="cb103-374"><a href="#cb103-374" aria-hidden="true" tabindex="-1"></a><span class="st">        mu[i] = int + alpha*isWoolB[i] + beta[1]*isTensionM[i] + beta[2]*isTensionH[i]</span></span>
<span id="cb103-375"><a href="#cb103-375" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb103-376"><a href="#cb103-376" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb103-377"><a href="#cb103-377" aria-hidden="true" tabindex="-1"></a><span class="st">    int ~ dnorm(0.0, 1.0/1.0e6)</span></span>
<span id="cb103-378"><a href="#cb103-378" aria-hidden="true" tabindex="-1"></a><span class="st">    alpha ~ dnorm(0.0, 1.0/1.0e6)</span></span>
<span id="cb103-379"><a href="#cb103-379" aria-hidden="true" tabindex="-1"></a><span class="st">    for (j in 1:2) {</span></span>
<span id="cb103-380"><a href="#cb103-380" aria-hidden="true" tabindex="-1"></a><span class="st">        beta[j] ~ dnorm(0.0, 1.0/1.0e6)</span></span>
<span id="cb103-381"><a href="#cb103-381" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb103-382"><a href="#cb103-382" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb103-383"><a href="#cb103-383" aria-hidden="true" tabindex="-1"></a><span class="st">    prec ~ dgamma(3/2.0, 3*1.0/2.0)</span></span>
<span id="cb103-384"><a href="#cb103-384" aria-hidden="true" tabindex="-1"></a><span class="st">    sig = sqrt(1.0 / prec)</span></span>
<span id="cb103-385"><a href="#cb103-385" aria-hidden="true" tabindex="-1"></a><span class="st">} "</span></span>
<span id="cb103-386"><a href="#cb103-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-387"><a href="#cb103-387" aria-hidden="true" tabindex="-1"></a>data2_jags <span class="ot">=</span> <span class="fu">list</span>(<span class="at">y=</span><span class="fu">log</span>(warpbreaks<span class="sc">$</span>breaks), <span class="at">isWoolB=</span>X[,<span class="st">"woolB"</span>], <span class="at">isTensionM=</span>X[,<span class="st">"tensionM"</span>], <span class="at">isTensionH=</span>X[,<span class="st">"tensionH"</span>])</span>
<span id="cb103-388"><a href="#cb103-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-389"><a href="#cb103-389" aria-hidden="true" tabindex="-1"></a>params2 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"int"</span>, <span class="st">"alpha"</span>, <span class="st">"beta"</span>, <span class="st">"sig"</span>)</span>
<span id="cb103-390"><a href="#cb103-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-391"><a href="#cb103-391" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">jags.model</span>(<span class="fu">textConnection</span>(mod2_string), <span class="at">data=</span>data2_jags, <span class="at">n.chains=</span><span class="dv">3</span>)</span>
<span id="cb103-392"><a href="#cb103-392" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(mod2, <span class="fl">1e3</span>)</span>
<span id="cb103-393"><a href="#cb103-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-394"><a href="#cb103-394" aria-hidden="true" tabindex="-1"></a>mod2_sim <span class="ot">=</span> <span class="fu">coda.samples</span>(<span class="at">model=</span>mod2,</span>
<span id="cb103-395"><a href="#cb103-395" aria-hidden="true" tabindex="-1"></a>                        <span class="at">variable.names=</span>params2,</span>
<span id="cb103-396"><a href="#cb103-396" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n.iter=</span><span class="fl">5e3</span>)</span>
<span id="cb103-397"><a href="#cb103-397" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-398"><a href="#cb103-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-401"><a href="#cb103-401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-402"><a href="#cb103-402" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-additive-model-convergence-diagnostics</span></span>
<span id="cb103-403"><a href="#cb103-403" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Convergence and diagnostics for the additive two-way ANOVA model"</span></span>
<span id="cb103-404"><a href="#cb103-404" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb103-405"><a href="#cb103-405" aria-hidden="true" tabindex="-1"></a><span class="do">## convergence diagnostics</span></span>
<span id="cb103-406"><a href="#cb103-406" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2_sim)</span>
<span id="cb103-407"><a href="#cb103-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-408"><a href="#cb103-408" aria-hidden="true" tabindex="-1"></a><span class="fu">gelman.diag</span>(mod2_sim)    <span class="co"># Corrected from mod1_sim</span></span>
<span id="cb103-409"><a href="#cb103-409" aria-hidden="true" tabindex="-1"></a><span class="fu">autocorr.diag</span>(mod2_sim)  <span class="co"># Corrected from mod1_sim</span></span>
<span id="cb103-410"><a href="#cb103-410" aria-hidden="true" tabindex="-1"></a><span class="fu">effectiveSize</span>(mod2_sim) <span class="co"># Corrected from mod1_sim</span></span>
<span id="cb103-411"><a href="#cb103-411" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-412"><a href="#cb103-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-413"><a href="#cb103-413" aria-hidden="true" tabindex="-1"></a>Let's summarize the results, collect the DIC for this model, and compare it to the first one-way model.</span>
<span id="cb103-414"><a href="#cb103-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-417"><a href="#cb103-417" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-418"><a href="#cb103-418" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: additive-model-summary</span></span>
<span id="cb103-419"><a href="#cb103-419" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2_sim)</span>
<span id="cb103-420"><a href="#cb103-420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-421"><a href="#cb103-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-424"><a href="#cb103-424" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-425"><a href="#cb103-425" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: additive-model-dic-comparison</span></span>
<span id="cb103-426"><a href="#cb103-426" aria-hidden="true" tabindex="-1"></a>(<span class="at">dic2 =</span> <span class="fu">dic.samples</span>(mod2, <span class="at">n.iter=</span><span class="fl">1e3</span>))</span>
<span id="cb103-427"><a href="#cb103-427" aria-hidden="true" tabindex="-1"></a>dic1</span>
<span id="cb103-428"><a href="#cb103-428" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-429"><a href="#cb103-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-430"><a href="#cb103-430" aria-hidden="true" tabindex="-1"></a>This suggests there is much to be gained adding the wool factor to the model. Before we settle on this model however, we should consider whether there is an interaction. Let's look again at the box plot with all six treatment groups.</span>
<span id="cb103-431"><a href="#cb103-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-434"><a href="#cb103-434" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-435"><a href="#cb103-435" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-interaction-check-boxplot</span></span>
<span id="cb103-436"><a href="#cb103-436" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Re-examining boxplot of log(breaks) by wool and tension for interaction effects"</span></span>
<span id="cb103-437"><a href="#cb103-437" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">log</span>(breaks) <span class="sc">~</span> wool <span class="sc">+</span> tension, <span class="at">data=</span>warpbreaks)</span>
<span id="cb103-438"><a href="#cb103-438" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-439"><a href="#cb103-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-440"><a href="#cb103-440" aria-hidden="true" tabindex="-1"></a>Our two-way model has a single effect for wool B and the estimate is negative. If this is true, then we would expect wool B to be associated with fewer breaks than its wool A counterpart on average. This is true for low and high tension, but it appears that breaks are *higher* for wool B when there is medium tension. That is, the effect for wool B is not consistent across tension levels, so it may appropriate to add an interaction term. In <span class="in">`R`</span>, this would look like:</span>
<span id="cb103-441"><a href="#cb103-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-444"><a href="#cb103-444" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-445"><a href="#cb103-445" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: linear-model-with-interaction-fit</span></span>
<span id="cb103-446"><a href="#cb103-446" aria-hidden="true" tabindex="-1"></a>lmod2 <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(breaks) <span class="sc">~</span> .<span class="sc">^</span><span class="dv">2</span>, <span class="at">data=</span>warpbreaks)</span>
<span id="cb103-447"><a href="#cb103-447" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmod2)</span>
<span id="cb103-448"><a href="#cb103-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-449"><a href="#cb103-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-450"><a href="#cb103-450" aria-hidden="true" tabindex="-1"></a>Adding the interaction, we get an effect for being in wool B and medium tension, as well as for being in wool B and high tension. There are now six parameters for the mean, one for each treatment group, so this model is equivalent to the full cell means model. Let's use that.</span>
<span id="cb103-451"><a href="#cb103-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-452"><a href="#cb103-452" aria-hidden="true" tabindex="-1"></a><span class="fu">### Two-way cell means model</span></span>
<span id="cb103-453"><a href="#cb103-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-454"><a href="#cb103-454" aria-hidden="true" tabindex="-1"></a>In this new model, $\mu$ will be a matrix with six entries, each corresponding to a treatment group.</span>
<span id="cb103-455"><a href="#cb103-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-458"><a href="#cb103-458" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-459"><a href="#cb103-459" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: cellmeans-model-setup</span></span>
<span id="cb103-460"><a href="#cb103-460" aria-hidden="true" tabindex="-1"></a>mod3_string <span class="ot">=</span> <span class="st">" model {</span></span>
<span id="cb103-461"><a href="#cb103-461" aria-hidden="true" tabindex="-1"></a><span class="st">    for( i in 1:length(y)) {</span></span>
<span id="cb103-462"><a href="#cb103-462" aria-hidden="true" tabindex="-1"></a><span class="st">        y[i] ~ dnorm(mu[woolGrp[i], tensGrp[i]], prec)</span></span>
<span id="cb103-463"><a href="#cb103-463" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb103-464"><a href="#cb103-464" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb103-465"><a href="#cb103-465" aria-hidden="true" tabindex="-1"></a><span class="st">    for (j in 1:max(woolGrp)) {</span></span>
<span id="cb103-466"><a href="#cb103-466" aria-hidden="true" tabindex="-1"></a><span class="st">        for (k in 1:max(tensGrp)) {</span></span>
<span id="cb103-467"><a href="#cb103-467" aria-hidden="true" tabindex="-1"></a><span class="st">            mu[j,k] ~ dnorm(0.0, 1.0/1.0e6)</span></span>
<span id="cb103-468"><a href="#cb103-468" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb103-469"><a href="#cb103-469" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb103-470"><a href="#cb103-470" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb103-471"><a href="#cb103-471" aria-hidden="true" tabindex="-1"></a><span class="st">    prec ~ dgamma(3/2.0, 3*1.0/2.0)</span></span>
<span id="cb103-472"><a href="#cb103-472" aria-hidden="true" tabindex="-1"></a><span class="st">    sig = sqrt(1.0 / prec)</span></span>
<span id="cb103-473"><a href="#cb103-473" aria-hidden="true" tabindex="-1"></a><span class="st">} "</span></span>
<span id="cb103-474"><a href="#cb103-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-475"><a href="#cb103-475" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(warpbreaks)</span>
<span id="cb103-476"><a href="#cb103-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-477"><a href="#cb103-477" aria-hidden="true" tabindex="-1"></a>data3_jags <span class="ot">=</span> <span class="fu">list</span>(<span class="at">y=</span><span class="fu">log</span>(warpbreaks<span class="sc">$</span>breaks), <span class="at">woolGrp=</span><span class="fu">as.numeric</span>(warpbreaks<span class="sc">$</span>wool), <span class="at">tensGrp=</span><span class="fu">as.numeric</span>(warpbreaks<span class="sc">$</span>tension))</span>
<span id="cb103-478"><a href="#cb103-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-479"><a href="#cb103-479" aria-hidden="true" tabindex="-1"></a>params3 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"mu"</span>, <span class="st">"sig"</span>)</span>
<span id="cb103-480"><a href="#cb103-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-481"><a href="#cb103-481" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">jags.model</span>(<span class="fu">textConnection</span>(mod3_string), <span class="at">data=</span>data3_jags, <span class="at">n.chains=</span><span class="dv">3</span>)</span>
<span id="cb103-482"><a href="#cb103-482" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(mod3, <span class="fl">1e3</span>)</span>
<span id="cb103-483"><a href="#cb103-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-484"><a href="#cb103-484" aria-hidden="true" tabindex="-1"></a>mod3_sim <span class="ot">=</span> <span class="fu">coda.samples</span>(<span class="at">model=</span>mod3,</span>
<span id="cb103-485"><a href="#cb103-485" aria-hidden="true" tabindex="-1"></a>                        <span class="at">variable.names=</span>params3,</span>
<span id="cb103-486"><a href="#cb103-486" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n.iter=</span><span class="fl">5e3</span>)</span>
<span id="cb103-487"><a href="#cb103-487" aria-hidden="true" tabindex="-1"></a>mod3_csim <span class="ot">=</span> <span class="fu">as.mcmc</span>(<span class="fu">do.call</span>(rbind, mod3_sim))</span>
<span id="cb103-488"><a href="#cb103-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-489"><a href="#cb103-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-492"><a href="#cb103-492" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-493"><a href="#cb103-493" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-cellmeans-traceplots</span></span>
<span id="cb103-494"><a href="#cb103-494" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Traceplots for the cell means model"</span></span>
<span id="cb103-495"><a href="#cb103-495" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb103-496"><a href="#cb103-496" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod3_sim)</span>
<span id="cb103-497"><a href="#cb103-497" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-498"><a href="#cb103-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-501"><a href="#cb103-501" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-502"><a href="#cb103-502" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: cellmeans-model-numerical-diagnostics</span></span>
<span id="cb103-503"><a href="#cb103-503" aria-hidden="true" tabindex="-1"></a><span class="do">## convergence diagnostics</span></span>
<span id="cb103-504"><a href="#cb103-504" aria-hidden="true" tabindex="-1"></a><span class="fu">gelman.diag</span>(mod3_sim)</span>
<span id="cb103-505"><a href="#cb103-505" aria-hidden="true" tabindex="-1"></a><span class="fu">autocorr.diag</span>(mod3_sim)</span>
<span id="cb103-506"><a href="#cb103-506" aria-hidden="true" tabindex="-1"></a><span class="fu">effectiveSize</span>(mod3_sim)</span>
<span id="cb103-507"><a href="#cb103-507" aria-hidden="true" tabindex="-1"></a><span class="fu">raftery.diag</span>(mod3_sim)</span>
<span id="cb103-508"><a href="#cb103-508" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-509"><a href="#cb103-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-510"><a href="#cb103-510" aria-hidden="true" tabindex="-1"></a>Let's compute the DIC and compare with our previous models.</span>
<span id="cb103-511"><a href="#cb103-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-514"><a href="#cb103-514" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-515"><a href="#cb103-515" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: cellmeans-model-dic-comparison</span></span>
<span id="cb103-516"><a href="#cb103-516" aria-hidden="true" tabindex="-1"></a>(<span class="at">dic3 =</span> <span class="fu">dic.samples</span>(mod3, <span class="at">n.iter=</span><span class="fl">1e3</span>))</span>
<span id="cb103-517"><a href="#cb103-517" aria-hidden="true" tabindex="-1"></a>dic2</span>
<span id="cb103-518"><a href="#cb103-518" aria-hidden="true" tabindex="-1"></a>dic1</span>
<span id="cb103-519"><a href="#cb103-519" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-520"><a href="#cb103-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-521"><a href="#cb103-521" aria-hidden="true" tabindex="-1"></a>This suggests that the full model with interaction between wool and tension (which is equivalent to the cell means model) is the best for explaining/predicting warp breaks.</span>
<span id="cb103-522"><a href="#cb103-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-523"><a href="#cb103-523" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results</span></span>
<span id="cb103-524"><a href="#cb103-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-527"><a href="#cb103-527" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-528"><a href="#cb103-528" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: cellmeans-model-summary</span></span>
<span id="cb103-529"><a href="#cb103-529" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3_sim)</span>
<span id="cb103-530"><a href="#cb103-530" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-531"><a href="#cb103-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-534"><a href="#cb103-534" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-535"><a href="#cb103-535" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: cellmeans-model-hpd-intervals</span></span>
<span id="cb103-536"><a href="#cb103-536" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(mod3_csim)</span>
<span id="cb103-537"><a href="#cb103-537" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-538"><a href="#cb103-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-541"><a href="#cb103-541" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-542"><a href="#cb103-542" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-cellmeans-posterior-densities</span></span>
<span id="cb103-543"><a href="#cb103-543" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Posterior densities for cell means"</span></span>
<span id="cb103-544"><a href="#cb103-544" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 7</span></span>
<span id="cb103-545"><a href="#cb103-545" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>)) <span class="co"># arrange frame for plots</span></span>
<span id="cb103-546"><a href="#cb103-546" aria-hidden="true" tabindex="-1"></a><span class="fu">densplot</span>(mod3_csim[,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">2.0</span>, <span class="fl">4.5</span>))</span>
<span id="cb103-547"><a href="#cb103-547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-548"><a href="#cb103-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-549"><a href="#cb103-549" aria-hidden="true" tabindex="-1"></a>It might be tempting to look at comparisons between each combination of treatments, but we warn that this could yield spurious results. When we discussed the statistical modeling cycle, we said it is best not to search your results for interesting hypotheses, because if there are many hypotheses, some will appear to show "effects" or "associations" simply due to chance. Results are most reliable when we determine a relatively small number of hypotheses we are interested in beforehand, collect the data, and statistically evaluate the evidence for them.</span>
<span id="cb103-550"><a href="#cb103-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-551"><a href="#cb103-551" aria-hidden="true" tabindex="-1"></a>One question we might be interested in with these data is finding the treatment combination that produces the fewest breaks. To calculate this, we can go through our posterior samples and for each sample, find out which group has the smallest mean. These counts help us determine the posterior probability that each of the treatment groups has the smallest mean.</span>
<span id="cb103-552"><a href="#cb103-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-555"><a href="#cb103-555" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-556"><a href="#cb103-556" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-min-mean-treatment-probabilities</span></span>
<span id="cb103-557"><a href="#cb103-557" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Posterior probabilities of each treatment group having the smallest mean break rate"</span></span>
<span id="cb103-558"><a href="#cb103-558" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>( <span class="fu">table</span>( <span class="fu">apply</span>(mod3_csim[,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="dv">1</span>, which.min) ) )</span>
<span id="cb103-559"><a href="#cb103-559" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-560"><a href="#cb103-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-561"><a href="#cb103-561" aria-hidden="true" tabindex="-1"></a>The evidence supports wool B with high tension as the treatment that produces the fewest breaks.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"fade","descPosition":"bottom","loop":true,"openEffect":"fade","selector":".lightbox","skin":"my-css-class"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>