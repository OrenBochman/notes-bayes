<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.11">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Oren Bochman">
<meta name="dcterms.date" content="2024-11-06">
<meta name="keywords" content="Time Series, Filtering, Kalman filtering, Smoothing, NDLM, Normal Dynamic Linear Models, Polynomial Trend Models, Regression Models, Superposition Principle, R code">
<meta name="description" content="Normal Dynamic Linear Models (NDLMs) are a class of models used for time series analysis that allow for flexible modeling of temporal dependencies.">

<title>95&nbsp; Normal Dynamic Linear Models, Part 1 - M3L6 – Bayesian Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./C4-L07.html" rel="next">
<link href="./C4-L05-Ex2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-279bd408c6dfe7bd56e8b154fe269440.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-923206e44a13b4518db4dede9f4ebdc9.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-279bd408c6dfe7bd56e8b154fe269440.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-84d0c58e965b114532ef2814536305ab.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-987387ce273b62b48f1747d606bce1d5.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-84d0c58e965b114532ef2814536305ab.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner {
        background-image: url(images/banner_deep.jpg);
background-size: cover;
      }
</style>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating slimcontent quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const queryPrefersDark = window.matchMedia('(prefers-color-scheme: dark)');
    const darkModeDefault = queryPrefersDark.matches;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    queryPrefersDark.addEventListener("change", e => {
      if(window.localStorage.getItem("quarto-color-scheme") !== null)
        return;
      const alternate = e.matches
      toggleColorMode(alternate);
      localAlternateSentinel = e.matches ? 'alternate' : 'default'; // this is used alongside local storage!
      toggleGiscusIfUsed(alternate, darkModeDefault);
    });
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./C4-L06.html"><span class="chapter-number">95</span>&nbsp; <span class="chapter-title">Normal Dynamic Linear Models, Part 1 - M3L6</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">95</span>&nbsp; <span class="chapter-title">Normal Dynamic Linear Models, Part 1 - M3L6</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
            <p class="subtitle lead">Time Series Analysis</p>
                  <div>
        <div class="description">
          Normal Dynamic Linear Models (NDLMs) are a class of models used for time series analysis that allow for flexible modeling of temporal dependencies.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Bayesian Statistics</div>
                <div class="quarto-category">Time Series</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Oren Bochman </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 6, 2024</p>
      </div>
    </div>
    
      
    </div>
    

  <div>
    <div class="keywords">
      <div class="block-title">Keywords</div>
      <p>Time Series, Filtering, Kalman filtering, Smoothing, NDLM, Normal Dynamic Linear Models, Polynomial Trend Models, Regression Models, Superposition Principle, R code</p>
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bayesian Statistics</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Bayesian Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability - M1L1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L01-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Paradigms of probability - M1L1HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bayes’ Theorem - M1L2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L02-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Conditional Probability and Bayes’ Law - M1L2HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L02-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Probability and Bayes’ Theorem - M1L2HW2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Distributions - M1L3</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L03-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Random Variables - M1L3HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L03-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Homework on Distributions - M1L3HW2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Frequentist Inference - M2L4</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L04-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Frequentist MLE - M2L3HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Bayesian Inference - M2L5</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L05-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Homework on Likelihoods and MLEs - M2L5HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L05-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Homework on Bayesian Inference - M2L5HW2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Priors - M3L6</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L06-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Homework Posterior Probabilities - M3L6HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">M3L7 - Binomial Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L07-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Homework on Priors - M2L7HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Poisson Data - M3L8</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L08-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Homework on Poisson Data - M3L8HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L08-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Beta Bernoulli - M3L8HW2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">M4L9 - Exponential Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L09-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Homework on Exponential Data - M4L9HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Normally distributed Data - M4L10</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L10-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Homework on Normal Data - M4L10HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Non-Informative Priors - M4L11</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L11-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Homework Alternative Priors - M4L11HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Brief Review of Regression - M4L12</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L12-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Homework Regression - M4L12HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1-L12-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Homework Regression - M4L12HW2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Statistical Modeling - M1L1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">M1L2 - Bayesian Modeling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Monte Carlo estimation - M1L3</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Metropolis-Hastings - M2L4</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L04-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Homework on the Metropolis-Hastings algorithm - M2L4HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Gibbs sampling - M2L5</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L05-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Homework Gibbs-Sampling algorithm - M2L22HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Assessing Convergence - M2L5</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L06-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Homework on the Gibbs-Sampling algorithm - M2L5HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L06-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Homework on M-H algorithm M2L5HW2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Linear regression - M3L7</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L07-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Homework on Linear Regression Model Part 1 - M2L5HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L07-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Homework on Deviance information criterion - M2L5HW2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">ANOVA - M3L8</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L08-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Homework on ANOVA - M3L8HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L08-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Homework on Multiple Factor ANOVA - M3L8HW2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Logistic regression - M3L9</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L09-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Homework on Logistic Regression - M3L9HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Poisson regression - M4L10</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L10-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Homework on Poisson regression - M4L10HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Hierarchical modeling - M4L11</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L11-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Homework on Hierarchical Models - M4L11HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L11-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Homework on Non-Normal Hierarchical Models - M4L11HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Capstone Project - M4L12</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2-L12-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Homework on Predictive distributions and mixture models - M4L12HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Definitions of Mixture Models - M1L1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L01-Ex1-Basic-Definitions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Basic Concepts of Mixture Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L01-Ex2-Gaussian-mixtures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Mixtures of Gaussians</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L01-Ex3-Zero-Inflated-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Zero inflated distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L01-Ex4-Def-mixture-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Definition of Mixture Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Likelihood functions for Mixture Models - M1L2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L02-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Homework The Likelihood function - M1L2HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L02-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Homework Identifiability - M1L2HW2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L02-Ex3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Homework The likelihood function M1L2HW3</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L02-Ex4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Homework on simulating from a Poisson Mixture Model - M1L2HW4</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L02-Ex5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">HW - Simulation of Poisson mixture model - M1L2HW5</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L02-Ex6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Homework Sim mixture of exponential distributions - M1L2HW6</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">The EM algorithm for Mixture models - M2L3</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L03-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">The EM algorithm for Zero-Inflated Mixtures</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L03-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">The EM algorithm for Mixture Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">MCMC for Mixture Models - M4L1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L04-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">The MCMC algorithm for Zero-Inflated Mixtures - M4L1HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L04-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Markov chain Monte Carlo algorithms for Mixture Models - M4L1HW2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Density Estimation - M4L5</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Clustering - M4L6</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Classification - M4L7</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L07-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">Old Faithful eruptions density estimation with the EM algorithm - M4L7HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L07-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Old Faithful eruptions density estimation with the MCMC algorithms - M4L7HW2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L07-Ex3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">Homework on Bayesian Mixture Models for Classification of Banknotes - M4L7HW3</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Computational Considerations - M5L8</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L08-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Computational considerations for Mixture Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Determining the number of components - M5L9</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L09-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">83</span>&nbsp; <span class="chapter-title">Homework on Bayesian Information Criteria (BIC) - M5L09HW1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L09-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">84</span>&nbsp; <span class="chapter-title">Homework on Estimating the number of components in Bayesian settings - M5L09HW2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L09-Ex3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">85</span>&nbsp; <span class="chapter-title">Homework on Estimating the partition structure in Bayesian models - M5L09HW3</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C3-L09-Ex4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">86</span>&nbsp; <span class="chapter-title">Homework on BIC for zero-inflated mixtures - M5L09HW4</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C4-L00.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">87</span>&nbsp; <span class="chapter-title">Week 0: Introductions to time series analysis and the AR(1) process</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C4-L01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">88</span>&nbsp; <span class="chapter-title">Stationarity, The ACF and the PCF M1L1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C4-L02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">89</span>&nbsp; <span class="chapter-title">The AR(1) process: definitions and properties - M1L2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C4-L03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">90</span>&nbsp; <span class="chapter-title">The AR(1): MLE and Bayesian inference - M1L3</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C4-L04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">91</span>&nbsp; <span class="chapter-title">The AR(p) process - M2L4</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C4-L05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">92</span>&nbsp; <span class="chapter-title">Bayesian Inference in the AR(p) - M2L5</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C4-L05-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">93</span>&nbsp; <span class="chapter-title">Quiz: Spectral representation of the AR(p) - M2L5</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C4-L05-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">94</span>&nbsp; <span class="chapter-title">Graded Assignment: Bayesian analysis of an EEG dataset using an AR(p) - M2L5</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C4-L06.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">95</span>&nbsp; <span class="chapter-title">Normal Dynamic Linear Models, Part 1 - M3L6</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C4-L07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">96</span>&nbsp; <span class="chapter-title">Bayesian Inference in the NDLM: Part 1 M3L7</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C4-L08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">97</span>&nbsp; <span class="chapter-title">Seasonal NDLMs M4L8</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C4-L09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">98</span>&nbsp; <span class="chapter-title">Bayesian Inference in the NDLM: Part 2 - M4L9</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C4-L10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">99</span>&nbsp; <span class="chapter-title">Final Project</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C4-L11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">100</span>&nbsp; <span class="chapter-title">Week 0: Feynman Notebook on Bayesian Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C5-L01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">101</span>&nbsp; <span class="chapter-title">Bayesian Conjugate Analysis for Autogressive Time Series Models - M1L1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C5-L01-Ex1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">102</span>&nbsp; <span class="chapter-title">Homework - Practice Quiz for Week 1 – M1L1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C5-L01-Ex2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">103</span>&nbsp; <span class="chapter-title">Homework - first-step-for-the-project – M1L1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C5-L02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">104</span>&nbsp; <span class="chapter-title">Model Selection Criteria - M1L2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">105</span>&nbsp; <span class="chapter-title">Appendix: Notation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">106</span>&nbsp; <span class="chapter-title">Appendix: Discrete Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">107</span>&nbsp; <span class="chapter-title">Appendix: Continuous Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">108</span>&nbsp; <span class="chapter-title">Appendix: Exponents &amp; Logarithms</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">109</span>&nbsp; <span class="chapter-title">Appendix: The Law of Large Numbers</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">110</span>&nbsp; <span class="chapter-title">Appendix: The Central Limit Theorem</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">111</span>&nbsp; <span class="chapter-title">Appendix: Conjugate Priors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">112</span>&nbsp; <span class="chapter-title">Appendix: Link Function</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">113</span>&nbsp; <span class="chapter-title">Appendix: Bayes by backprop</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">114</span>&nbsp; <span class="chapter-title">Bayesian Books in R &amp; Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">115</span>&nbsp; <span class="chapter-title">Appendix: Yule-Walker Equations &amp; Durbin-Levinson Recursion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">116</span>&nbsp; <span class="chapter-title">Moore-Penrose Inversion &amp; Cholesky Decomposition</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">117</span>&nbsp; <span class="chapter-title">Appendix: Inequalities</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">118</span>&nbsp; <span class="chapter-title">Appendix: Wold’s theorem</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">119</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-normal-dynamic-linear-model-definition-model-classes-the-superposition-principle" id="toc-the-normal-dynamic-linear-model-definition-model-classes-the-superposition-principle" class="nav-link active" data-scroll-target="#the-normal-dynamic-linear-model-definition-model-classes-the-superposition-principle"><span class="header-section-number">96</span> The Normal Dynamic Linear Model: Definition, Model classes &amp; The Superposition Principle</a>
  <ul class="collapse">
  <li><a href="#ndlm-definition" id="toc-ndlm-definition" class="nav-link" data-scroll-target="#ndlm-definition"><span class="header-section-number">96.1</span> NDLM Definition 🎥</a>
  <ul class="collapse">
  <li><a href="#white-noise---a-motivating-example" id="toc-white-noise---a-motivating-example" class="nav-link" data-scroll-target="#white-noise---a-motivating-example"><span class="header-section-number">96.1.1</span> White Noise - A motivating example</a></li>
  <li><a href="#a-random-walk-model-with-a-slowly-changing-mean" id="toc-a-random-walk-model-with-a-slowly-changing-mean" class="nav-link" data-scroll-target="#a-random-walk-model-with-a-slowly-changing-mean"><span class="header-section-number">96.1.2</span> A Random walk model with a slowly changing mean</a></li>
  <li><a href="#general-form-of-the-ndlm" id="toc-general-form-of-the-ndlm" class="nav-link" data-scroll-target="#general-form-of-the-ndlm"><span class="header-section-number">96.1.3</span> General form of the NDLM</a></li>
  <li><a href="#inference-in-the-ndlm" id="toc-inference-in-the-ndlm" class="nav-link" data-scroll-target="#inference-in-the-ndlm"><span class="header-section-number">96.1.4</span> Inference in the NDLM</a></li>
  <li><a href="#the-forecast-function-for-the-ndlm" id="toc-the-forecast-function-for-the-ndlm" class="nav-link" data-scroll-target="#the-forecast-function-for-the-ndlm"><span class="header-section-number">96.1.5</span> The forecast function for the NDLM</a></li>
  <li><a href="#ndlm-short-form-notation" id="toc-ndlm-short-form-notation" class="nav-link" data-scroll-target="#ndlm-short-form-notation"><span class="header-section-number">96.1.6</span> NDLM short form notation</a></li>
  </ul></li>
  <li><a href="#polynomial-trend-models" id="toc-polynomial-trend-models" class="nav-link" data-scroll-target="#polynomial-trend-models"><span class="header-section-number">96.2</span> Polynomial Trend Models 🎥</a>
  <ul class="collapse">
  <li><a href="#first-order-polynomial-model" id="toc-first-order-polynomial-model" class="nav-link" data-scroll-target="#first-order-polynomial-model"><span class="header-section-number">96.2.1</span> First order polynomial model</a></li>
  <li><a href="#second-order-polynomial-model-aka-linear-growth-model" id="toc-second-order-polynomial-model-aka-linear-growth-model" class="nav-link" data-scroll-target="#second-order-polynomial-model-aka-linear-growth-model"><span class="header-section-number">96.2.2</span> Second order Polynomial model AKA Linear Growth model</a></li>
  <li><a href="#general-p-th-order-polynomial-model" id="toc-general-p-th-order-polynomial-model" class="nav-link" data-scroll-target="#general-p-th-order-polynomial-model"><span class="header-section-number">96.2.3</span> General p-th order polynomial model</a></li>
  </ul></li>
  <li><a href="#summary-of-polynomial-trend-models" id="toc-summary-of-polynomial-trend-models" class="nav-link" data-scroll-target="#summary-of-polynomial-trend-models"><span class="header-section-number">96.3</span> Summary of polynomial trend models 📖</a>
  <ul class="collapse">
  <li><a href="#polynomial-trend-models-1" id="toc-polynomial-trend-models-1" class="nav-link" data-scroll-target="#polynomial-trend-models-1"><span class="header-section-number">96.3.1</span> Polynomial Trend Models</a></li>
  </ul></li>
  <li><a href="#regression-models" id="toc-regression-models" class="nav-link" data-scroll-target="#regression-models"><span class="header-section-number">96.4</span> Regression models 🎥</a>
  <ul class="collapse">
  <li><a href="#simple-dynamic-regression" id="toc-simple-dynamic-regression" class="nav-link" data-scroll-target="#simple-dynamic-regression"><span class="header-section-number">96.4.1</span> Simple dynamic regression</a></li>
  <li><a href="#general-dynamic-regression" id="toc-general-dynamic-regression" class="nav-link" data-scroll-target="#general-dynamic-regression"><span class="header-section-number">96.4.2</span> General dynamic regression</a></li>
  </ul></li>
  <li><a href="#summary-of-regression-models" id="toc-summary-of-regression-models" class="nav-link" data-scroll-target="#summary-of-regression-models"><span class="header-section-number">96.5</span> Summary of Regression Models 📖</a>
  <ul class="collapse">
  <li><a href="#dynamic-regression-models" id="toc-dynamic-regression-models" class="nav-link" data-scroll-target="#dynamic-regression-models"><span class="header-section-number">96.5.1</span> Dynamic Regression Models</a></li>
  </ul></li>
  <li><a href="#the-superposition-principle" id="toc-the-superposition-principle" class="nav-link" data-scroll-target="#the-superposition-principle"><span class="header-section-number">96.6</span> The superposition principle 🎥</a></li>
  <li><a href="#superposition-principle-general-case" id="toc-superposition-principle-general-case" class="nav-link" data-scroll-target="#superposition-principle-general-case"><span class="header-section-number">96.7</span> Superposition principle: General case 📖</a>
  <ul class="collapse">
  <li><a href="#general-case" id="toc-general-case" class="nav-link" data-scroll-target="#general-case"><span class="header-section-number">96.7.1</span> General Case</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">






<!-- 
The challenge in taking notes in this courses is that the instructors speak out the maths as they go along. I supply the math but I want to extract the non-math parts and put them in the right place. 
-->
<p><mark>Normal Dynamic Linear Models (NDLMs) are defined and illustrated in this module using several examples Model building based on the forecast function via the superposition principle is explained. Methods for Bayesian filtering, smoothing and forecasting for NDLMs in the case of known observational variances and known system covariance matrices are discussed and illustrated.</mark>.</p>
<p>The Normal Dynamic Linear Model (DLM) is covered <span class="citation" data-cites="prado2023time">(<a href="references.html#ref-prado2023time" role="doc-biblioref">R. Prado, Ferreira, and West 2023, 117–44</a>)</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Learning Objectives
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul class="task-list">
<li><label><input type="checkbox" checked="">Use R for analysis and forecasting of time series using NDLM (case of known observational and system variances) <a href="#m3g1">#</a></label></li>
<li><label><input type="checkbox" checked="">Derive the equations to obtain posterior inference and forecasting in the NDLM with known observational and system variances, including the filtering, smoothing and forecasting equations <a href="#m3g2">#</a></label></li>
<li><label><input type="checkbox" checked="">Apply the NDLM superposition principle and explain the role of the forecast function <a href="#m3g3">#</a></label></li>
<li><label><input type="checkbox" checked="">Define trend and regression normal DLMs <a href="#m3g4">#</a></label></li>
<li><label><input type="checkbox" checked="">Explain the general normal dynamic linear model (NDLM) representation <a href="#m3g5">#</a></label></li>
</ul>
</div>
</div>
</div>
<section id="the-normal-dynamic-linear-model-definition-model-classes-the-superposition-principle" class="level1 page-columns page-full" data-number="96">
<h1 data-number="96"><span class="header-section-number">96</span> The Normal Dynamic Linear Model: Definition, Model classes &amp; The Superposition Principle</h1>
<p>Dynamic Linear Models (DLMs) extend classical linear regression to time-indexed data, introducing dependencies between observations through latent evolving parameters. A Normal DLM (NDLM) assumes Gaussian noise at both observation and system levels, enabling tractable Bayesian inference through the Kalman filter.</p>
<p>While superficially complex, NDLMs are conceptually close to linear regression. Instead of I.I.D. observations indexed by <span class="math inline">i</span>, we index data by time <span class="math inline">t</span> and allow parameters to evolve with time, resulting in a two-level hierarchical model. At the top level is the observation equation. Below this there is the evolution equation(s) that can be understood as a latent state transition model that can capture trends, periodicity, and regression. The evolution equations can have more than one level however we will see that with some work these are summarized into a matrix form.</p>
<p>To make things simpler this is demonstrated using a white noise process and then a random walk model. What makes the NDLM somewhat different is that that there are two variance elements at two levels, necessitating learning more parameters. Once we cover these to models the instructor walks us though all the bits and pieces of the notation. Later we will see that we can add trends, periodicity, regression components in a more or less systematic way. However we need to pick and choose these components to get a suitable forecast function. This approach require an intimate familiarity with the data generating process to model.</p>
<p>This approach is Bayesian in that we draw our parameters from a multivariate normal and use updating to improve this initial estimate by incorporating the data and we end up with a posterior i.e.&nbsp;we have distributional view of the time series incorporating uncertainties. Additionally we have a number of Bayesian quantities that can be derived from the model, such as</p>
<ul>
<li>the <strong>filtering distribution</strong> that estimates the current state <span class="math inline">\mathbb{P}r(\theta_t \mid \mathcal{D}_t)</span>,</li>
<li>the <strong>forecasting distribution</strong> - to predict future observation: <span class="math inline">\mathbb{P}r(y_{t+h} \mid \mathcal{D}_t)</span>,</li>
<li>the <strong>smoothing distribution</strong> - retrospective estimate of past state: <span class="math inline">\mathbb{P}r(\theta_t \mid \mathcal{D}_{T})\quad t&lt;T</span> and</li>
<li>the <strong>forecast function</strong> when <span class="math inline">F_t=F</span> and <span class="math inline">\mathbf{G}_t=\mathbf{G}</span> <span class="math inline">f_t(h)=\mathbb{E}[y_{t+h} \mid \mathcal{D}_{T}] = F'G^h \mathbb{E}[\theta_{t} \mid \mathcal{D}_{T}]</span></li>
<li>the usual credible intervals for forecasts and parameter estimates.</li>
</ul>
<p>However the DLM framework is quite flexible and once you understand it it can ve adapted to support features like seasonality using the superposition principle. NDLMs don’t need to be non-stationary time series.</p>
<p>As far as I cen tell NDLMs are just DLM with their errors distributed normally at the different levels.</p>
<section id="ndlm-definition" class="level2 page-columns page-full" data-number="96.1">
<h2 data-number="96.1" class="anchored" data-anchor-id="ndlm-definition"><span class="header-section-number">96.1</span> NDLM Definition 🎥</h2>

<div class="no-row-height column-margin column-container"><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/m3_0001.png" class="lightbox" data-gallery="slides" title="NDLM Motivation"><img src="images/m3_0001.png" class="img-fluid figure-img" style="width:53mm" alt="NDLM Motivation"></a></p>
<figcaption>NDLM Motivation</figcaption>
</figure>
</div><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/m3_0002.png" class="lightbox" data-gallery="slides" title="NDLM general form"><img src="images/m3_0002.png" class="img-fluid figure-img" style="width:53mm" alt="NDLM general form"></a></p>
<figcaption>NDLM general form</figcaption>
</figure>
</div><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/m3_0003.png" class="lightbox" data-gallery="slides" title="the forecast function"><img src="images/m3_0003.png" class="img-fluid figure-img" style="width:53mm" alt="the forecast function"></a></p>
<figcaption>the forecast function</figcaption>
</figure>
</div></div>

<!--
::: {.callout-caution collapse="true"}

### Hard to follow :weary:

- I found this video hard to follow. I watched it carefully a number of times and reworked the math and video's transcript. But in the end this and the next two video are more like a summary of the material rather than a motivated development of the models. 

- The text also diverge when it comes to the $F$ in the state space representation equation. In @west2013bayesian it is a matrix and in @prado2023time it is called a vector. In some places it is referenced as a $p \times 1$. As far as I can tell this reflects different state space representation of the model which neither text is particularly clear. 
- Although we are give a couple of motivational examples the way they generalize to the NDLM is not as clear as in @west2013bayesian but this text is very verbose and covers much more material.

- @west2013bayesian also discusses how the math relates to more common statistical scenarios and how the model can be adapted to these scenarios e.g. replacing the obs. normal distribution with a t-distribution or a mixture of normals to handle outliers. I.e. see NDLMs as a looser framework with the assumptions of independence and normality as guidelines rather than strict assumptions.

In @prado2023time we quickly get a large number of mathematically concise format, that illustrate how NDLMs generalize other time series models. However these examples assume we are sufficiently familiar with this models.

- The NDLM is also a hierarchical model which we have not looked into in much depth in this specialization. This is another missed opportunity to connect to previous material and deepen our understanding. Particularly as the bayesian formulation should be able to overcome the limitations of the frequentist approach where we need to make strong assumptions on IID of the shocks but in a time series local observations often highly correlated.

- NDLM have efficient algorithms for inference and forecasting mostly by using the Kalman filter, again this is not mentioned not is a bayesian formulation presented

- So I guess the main issue is that the vide just lists lots of equations and does not really without providing a good intuition behind the model.

- I hope that with the rest of this and the next lesson we can get a better understanding of the NDLM.

- I ended up skimming through large portions of [@west2013bayesian] which goes into much greater detail on the NDLM. The first and second polynomial models developed, explained and motivation is clearer. The state space representation is not explained but the model is developed in a more coherent way and this is a good starting point for developing a more intuitive understanding of the NDLMs. The notation in this book is also easier to follow.

  - We use $\theta_t$ for the parameters of the vector and \theta_{t,1} and \theta_{t,2} for the first two components of the parameter vector. This continues the convention of greek characters for parameters from the previous courses and many texts. However if the parameters have a clear meaning it much easier to follow math where we use a more descriptive notation and avoid the second subscripts.
- The state space representation here is omitted. The $F$ vector or matrix is not really motivates as a latent state space representation.

:::
-->
<p>In this module, <mark>we will motivate and develop a class of models suitable for for analyzing and forecasting <strong>non-stationary time series</strong> called <strong>normal dynamic linear models</strong> . We will talk about Bayesian inference and forecasting within this class of models and describe model building as well</mark>.</p>
<section id="white-noise---a-motivating-example" class="level3" data-number="96.1.1">
<h3 data-number="96.1.1" class="anchored" data-anchor-id="white-noise---a-motivating-example"><span class="header-section-number">96.1.1</span> White Noise - A motivating example</h3>
<p>Let’s begin with a very simple model that has no temporal structure, just a mean value with some variation that is:</p>
<p><span id="eq-white-noise-model"><span class="math display">
y_t = \mu + v_t \qquad v_t \overset{\text{iid}}{\sim}  \mathcal{N}(0, \nu) \qquad  \text{(white noise model)}
\tag{96.1}</span></span></p>
<p>where:</p>
<ul>
<li><span class="math inline">y_t</span> is the observed time series at time <span class="math inline">t</span>,</li>
<li><span class="math inline">\mu</span> is the expected value of <span class="math inline">y_t</span> this is characteristic we are interested in,</li>
<li><span class="math inline">\nu_t</span> is a white noise process as usual iid standard normal N(0,1).</li>
</ul>
<p>If we plot this model we might see the following graph:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>V <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> mu <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, V)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">xlab =</span> <span class="st">"Time"</span>, <span class="at">ylab =</span> <span class="st">"y"</span>, <span class="at">main =</span> <span class="st">"Model with no temporal structure"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-NDLM-white-noise" class="quarto-float quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-NDLM-white-noise-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="C4-L06_files/figure-html/fig-NDLM-white-noise-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;96.1: "><img src="C4-L06_files/figure-html/fig-NDLM-white-noise-1.png" id="fig-NDLM-white-noise" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-NDLM-white-noise-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;96.1
</figcaption>
</figure>
</div>
</div>
</div>
<p>For this model the mean of the time series is <span class="math inline">\mu</span> will be the the expected value of <span class="math inline">y_t</span>, which is <span class="math inline">\mu</span>. And the variance of <span class="math inline">y_t</span> is <span class="math inline">\nu</span>.</p>
<p><span id="eq-NDLM-mean-variance"><span class="math display">
\mathbb{E}[y_t] = \mu \qquad \text{and} \qquad \mathbb{V}ar[y_t] = \nu \qquad
\tag{96.2}</span></span></p>
</section>
<section id="a-random-walk-model-with-a-slowly-changing-mean" class="level3" data-number="96.1.2">
<h3 data-number="96.1.2" class="anchored" data-anchor-id="a-random-walk-model-with-a-slowly-changing-mean"><span class="header-section-number">96.1.2</span> A Random walk model with a slowly changing mean</h3>
<p><mark>Next we incorporate some temporal structure, we allow the expected value of the time series, to change over time. To can achieve this, by update the model definition with a <span class="math inline">\mu_t</span> where the index indicates that it can change at every time step. And let us keep the noise unchanged. i.e.&nbsp;we set it to <span class="math inline">\mu_t \in N(0,\nu)</span>.</mark></p>
<p>We get the following model:</p>
<p><span id="eq-NDLM-model-random-walk"><span class="math display">
y_t = \mu_t + \nu_t \quad \nu_t \overset{\text{iid}}{\sim} N(0, V) \qquad \text{(radom walk model)}
\tag{96.3}</span></span></p>
<p>To complete this we need to also decide how to incorporate the the changes over time in the parameter <span class="math inline">\mu_t</span>. We might consider different options but we should pick the simplest possible to start with. One option is to assume that the expected value of <span class="math inline">\mu_t</span> is just the expected value of <span class="math inline">\mu_{t-1}</span> plus some noise.</p>
<p>We now have that random walk type of structure where <span class="math inline">\mu_t</span> can be written in terms of <span class="math inline">\mu(t-1)</span>. The expected value of <span class="math inline">\mu_t</span>, we can think of it as <span class="math inline">\mu_{t-1} + \text{some noise}</span>. This error is once again, assumed to be normally distributed random variable centered at zero and with variance <span class="math inline">W</span>. <mark>Another assumption that we have made here is that the <span class="math inline">\nu_t</span> and <span class="math inline">\omega_t</span>, are also independent of each other</mark>.</p>
<p>putting this together we get:</p>
<p><span id="eq-random-walk-model-hierarchical"><span class="math display">
\begin{aligned}
y_t &amp;= \mu_t + \nu_t &amp; \nu_t &amp; \overset{\text{iid}}{\sim}  \mathcal{N}(0, V)  &amp; \text{(Observation eq.)} \\
\mu_t &amp;= \mu_{t-1} + \omega_t  &amp; \omega_t &amp; \overset{\text{iid}}{\sim}  \mathcal{N}(0, W) &amp; \text{(System/evolution eq.)}
\end{aligned}
\tag{96.4}</span></span></p>
<p>With this model, what we are assuming is that the mean level of the series is changing over time. Note that this is an example of a <strong>Gaussian or Normal dynamic linear model</strong>.</p>
<p>NDLMs are a two level hierarchical models where :</p>
<ol type="1">
<li>At the top is an <strong>observation level equation</strong> relating observations y at time t to some time dependent, (hidden) state parameters and some observation level iid distributed error.</li>
<li>The <strong>system evolution level equation</strong> describes the dynamics of parameters over time and incorporates some system iid distributed error.</li>
<li><mark>These equations have a linear structure, in the sense that the expected value of y at time t is a linear function of the parameters.</mark></li>
<li>We have the <strong>assumption of normality for the noise terms</strong> in both these equations as well as independence within and between levels.</li>
</ol>
<p>This is our first example. Next we will be discuss the general class of models. Later we will consider how to incorporate different structures into the model, and how to perform Bayesian inference for filtering smoothing and forecasting.</p>
</section>
<section id="general-form-of-the-ndlm" class="level3" data-number="96.1.3">
<h3 data-number="96.1.3" class="anchored" data-anchor-id="general-form-of-the-ndlm"><span class="header-section-number">96.1.3</span> General form of the NDLM</h3>
<p>The general class of dynamic linear models can be written as follows:</p>
<p>We are going to have two equations. One is the so-called observation equation that relates the observations to the parameters in the model, and the notation we are going to use is as follows.</p>
<p><span id="eq-NDLM-general-form"><span class="math display">\begin{aligned}
y_t &amp;= \vec{F}_t' \vec{\theta}_t   + \nu_t &amp;&amp; \nu_t \overset{\text{iid}}{\sim}  \mathcal{N}(0, V_t) &amp;&amp; \text{(obs)} \\
\vec{\theta}_t &amp;= G_t \vec{\theta}_{t-1} + \vec{\omega}_t &amp;&amp; \vec{\omega}_t \overset{\text{iid}}{\sim}  \mathcal{N}(0, W_t) &amp;&amp; \text{(system)}
\end{aligned}
\tag{96.5}</span></span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">y_t</span> a univariate observation at time <span class="math inline">t</span>.</li>
<li><span class="math inline">\vec{\theta}_t</span> the <strong>state vector</strong> is a k-dimensional vector of unknown parameters at time t.</li>
<li><span class="math inline">\vec{F_t}</span> the <strong>observation operator</strong> a <span class="math inline">k*1</span>-dimensional vector at time t that transforms the <strong>state parameters</strong> into observations.</li>
<li><span class="math inline">\nu_t</span> is the observation noise at time t from a Normal distribution with variance <span class="math inline">V_t</span>.</li>
<li><span class="math inline">G_t</span> the <strong>state evolution operator</strong> is a <span class="math inline">k \times k</span> matrix (known)</li>
<li><span class="math inline">\omega_t</span> the <strong>innovation</strong> or state evolution noise at time t distributed as <span class="math inline">N(0,W_t)</span>(known)</li>
<li>the noise at the observation level and the system level are each iid and mutually iid.</li>
</ul>
<p>We also have the prior distribution for the state vector at time 0:</p>
<ul>
<li><span class="math inline">\vec{\theta}_0 \sim N(\vec{m}_0,c_0)</span> a prior k-dimensional Normal distribution.
<ul>
<li><span class="math inline">m_0</span> the mean in the prior is a k-dimensional vector of means. (known)</li>
<li><span class="math inline">c_0</span> is the covariance matrix k by k. (known)</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Some Thoughts on NDLM the definition
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Q. Why are <span class="math inline">F_t</span> and <span class="math inline">G_t</span> a vector and a matrix respectively?</p>
<blockquote class="blockquote">
<p>It may helps to think about <span class="math inline">F</span> and <span class="math inline">G</span> as follows:</p>
<p><span class="math inline">F_t'</span> acts as a linear transformation that maps the latent state <span class="math inline">\vec{\theta}_t</span> into the observation space, of <span class="math inline">y</span>.</p>
<p><span class="math inline">G_t</span> is a linear transformation that describes how the state vector evolves over time. I like to think about it as a Hidden Markov state transition matrix.</p>
<p>In other words, <span class="math inline">F_t</span> takes the current hidden state <span class="math inline">\theta_t</span> and produces an observation <span class="math inline">y_t</span>, while <span class="math inline">G_t</span> takes the current state and produces the next state.</p>
</blockquote>
<p>Q. Why is this called a linear model?</p>
<blockquote class="blockquote">
<p>This is because both the observation equation is a linear equation that relates the observations to the parameters in the model and the system equation is a linear equation that tells us how the time-varying parameter is going to be changing over time. This is why we call this a linear model.</p>
</blockquote>
<p>Q. Why are the noise terms <span class="math inline">\nu_t</span> and <span class="math inline">\omega_t</span> assumed to be normally distributed?</p>
<blockquote class="blockquote">
<p>This is a common assumption in time series analysis. It is a convenient assumption that allows us to perform Bayesian inference and forecasting in a very simple way. And this is why we call this a <strong>normal</strong> dynamic linear model.</p>
</blockquote>
<p>Q. Isn’t this just a hierarchical model?</p>
<blockquote class="blockquote">
<p>Indeed, this is a hierarchical model. We have a model for the observations and a model for the system level. The system level is changing over time and the observations are related to the system level through the observation equation. And so it is possible to extend this model to more complex structures if we wish to do so by adding another level, etc… However adding more levels leads to extra dynamics that are captured in <span class="math inline">G</span> without changing the overall framework!</p>
</blockquote>
</div>
</div>
</div>
</section>
<section id="inference-in-the-ndlm" class="level3 page-columns page-full" data-number="96.1.4">
<h3 data-number="96.1.4" class="anchored" data-anchor-id="inference-in-the-ndlm"><span class="header-section-number">96.1.4</span> Inference in the NDLM</h3>
<p>In terms of the inference, there are a few different kinds of densities and quantities that we are interested in:</p>
<div class="page-columns page-full"><p> One of the distributions that we are interested in finding is the so-called <strong>filtering distribution</strong>. We may be interested here in finding what is the density of <span class="math inline">\theta_t</span> <em>given all the observations that we have up to time</em> <span class="math inline">t</span>.</p><div class="no-row-height column-margin column-container"><span class="">Filtering distribution</span></div></div>
<p><span id="eq-NDLM-filtering-distribution"><span class="math display">
\mathcal{D}_t= \{\mathcal{D}_0, y_{1:T}\}
\tag{96.6}</span></span></p>
<p>We will denote information as <span class="math inline">\mathcal{D}_t</span>. Usually, it is all the information we have at time zero (i.e.&nbsp;our prior), coupled with all the data points I have up to time <span class="math inline">t</span>.</p>
<p>Here we conditioning on all the observed quantities and the prior information up to time <span class="math inline">t</span>, and I may be interested in just finding what is the distribution for <span class="math inline">\theta_t</span>. This is called filtering.</p>
<p><span id="eq-NDLM-filtering"><span class="math display">
\mathbb{P}r(\theta_t \mid \mathcal{D}_t) \qquad \text{filtering distribution}
\tag{96.7}</span></span></p>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="">forecasting distribution</span></div></div>
<p>Another distribution that is very important in time series analysis is the forecasting distribution. We may be interested in the distribution of <span class="math inline">y{t+h}</span>? where we consider <span class="math inline">h</span> lags into the future and we have all the information <span class="math inline">\mathcal{D}_t</span>, up to time t. We want to do a predictions here</p>
<p><span id="eq-NDLM-forecasting-distribution"><span class="math display">
\mathbb{P}r(y_{t+h} \mid \mathcal{D}_t) \qquad \text{forecasting distribution}
\tag{96.8}</span></span></p>
<div class="page-columns page-full"><p> Another important quantity or an important set of distributions is what we call the smoothing distribution. Usually, you have a time series, when you get your data, you observe, I don’t know, 300 data points. As you go with the filtering, you are going to start from zero all the way to 300 and you’re going to update these filtering distributions as you go and move forward. <mark>We may want instead to revisit the parameter at time 10, for example, given that you now have observed all these 300 observations. In that case, you’re interested in densities that are of the form. Let’s say that you observe capital T in your process and now you are going to revisit that density for <span class="math inline">\theta_t</span>. This is now in the past. Here we assume that <span class="math inline">t&lt;T</span>. This is called <strong>smoothing</strong>.</mark></p><div class="no-row-height column-margin column-container"><span class="">Smoothing Distribution</span></div></div>
<p>So you have more observation once you have seen the data. We will talk about how to perform Bayesian inference to obtain all these distributions under this model setting.</p>
<p><span id="eq-NDLM-smoothing-distribution"><span class="math display">
\mathbb{P}r(\theta_t \mid \mathcal{D}_T)  \qquad t &lt; T \qquad \text{smoothing distribution}
\tag{96.9}</span></span></p>
</section>
<section id="the-forecast-function-for-the-ndlm" class="level3" data-number="96.1.5">
<h3 data-number="96.1.5" class="anchored" data-anchor-id="the-forecast-function-for-the-ndlm"><span class="header-section-number">96.1.5</span> The forecast function for the NDLM</h3>
<p>In addition to all the structure that we described before and all the densities that we are interested in finding, we also have as usual, the so-called <em>forecast function</em>, which instead of being the density is just <span class="math inline">\mathbb{E}[y(t+h)\mid \mathcal{D}_t]</span> i.e.&nbsp;expected value of y at time t given all the information we have before time t.</p>
<p><span id="eq-forecast-function-for-NDLM"><span class="math display">
\mathbb{E}[y(t+h)\mid \mathcal(D_t)] = F'_{t+h} G_{t+h} \ldots G_{t+1} \mathbb{E}[\theta_t \mid \mathcal{D}_t]
\tag{96.10}</span></span></p>
<p>This is the form of the forecast function.</p>
<p>There are particular cases and particular models that we will be discussing in which the <span class="math inline">F_t=F</span>, i.e.&nbsp;constant and also <span class="math inline">G_t = G</span> is also constant for all t. In these cases, the forecast function can be simplified and written as:</p>
<p><span id="eq-forecast-function-for-NDLM-constant-F-G"><span class="math display">
f_t(h) = \mathbb{E}(y_{t+h} \mid D_t) = F'G^h \mathbb{E}(\theta_t \mid \mathcal{D}_t)
\tag{96.11}</span></span></p>
<p>One thing that we will learn is that the eigen-structure of this matrix is very important to define the form of the forecast function, and it’s very important for model building and for adding components into your model.</p>
</section>
<section id="ndlm-short-form-notation" class="level3" data-number="96.1.6">
<h3 data-number="96.1.6" class="anchored" data-anchor-id="ndlm-short-form-notation"><span class="header-section-number">96.1.6</span> NDLM short form notation</h3>
<p>Finally, just in terms of short notation, we can always write down when we’re working with normal dynamic linear models, we may be referring to the model instead of writing the two equations, the system and the observation equation. I can just write all the components that define my model. <span id="eq-NDLM-model-shothand-notation"><span class="math display">
\{F_t, G_t, v_t, W_t\}
\tag{96.12}</span></span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Video Transcript
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<!-- transcript of https://www.coursera.org/learn/bayesian-statistics-time-series-analysis/lecture/mH7Ol/ndlm-definition -->
<p>In this part of the course, I will discuss the class of normal dynamic linear models for analyzing and forecasting non-stationary time series. We will talk about Bayesian inference and forecasting within this class of models and describe model building as well.</p>
<section id="motivating-example" class="level3" data-number="96.1.7">
<h3 data-number="96.1.7" class="anchored" data-anchor-id="motivating-example"><span class="header-section-number">96.1.7</span> Motivating example</h3>
<p>I want to begin first with a motivating example. Suppose you have a model that is very simple and has no temporal structure here, just a model that looks like this. You have your time series <span class="math inline">y_t</span>. Then you’re interested in just thinking about what is the mean level of that time series. That mean level, I’m going to call it <span class="math inline">\mu</span> and then I have some noise and the noise is normally distributed. They are all independent, identically distributed normal random variables <span class="math inline">\mathcal{N}(0,v)</span>. Again, I can think of my time series. Suppose that I have my time series here, and then I’m plotting <span class="math inline">y_t</span>. Then I have something that looks like this. In this model that <span class="math inline">\mu</span> is going to try to get the mean of that time series, this expected value of <span class="math inline">y_t</span>, which is <span class="math inline">\mu</span>. The variance here of <span class="math inline">y_t</span> is <span class="math inline">v</span> under this model. What may happen in practice again, this model has no temporal structure, I may want to incorporate some temporal structure that says, well, I think that the level of this, the expected value of this time series, should be changing over time. If you were to do that, you will write down a model where the <span class="math inline">\mu</span> changes over time, so it’s indexed in time. Then you have still your same noise here. Let’s again assume <span class="math inline">\mathcal{N}(0,v)</span>. I have now to make a decision on how I’m going to incorporate temporal structure by modeling the changes over time in this parameter <span class="math inline">\mu_t</span>. You could consider different options.</p>
<p>The simplest possible, probably that you can consider is something that looks like this. You have that random walk type of structure where <span class="math inline">\mu_t</span> is now going to be written as <span class="math inline">\mu_{t-1}</span>. The expected value of <span class="math inline">\mu_t</span>, you’ll think of it as <span class="math inline">\mu_{t-1}</span> plus some noise. That error here is going to be again, assume normally distributed random variable centered at zero and with variance w. There is another assumption that we can make here and is that the nu t and omega t here, are also independent of each other. When I have this model, what am assuming here is that the mean level of the series is changing over time.</p>
<p>These type of models have a few characteristics. This is an example of a normal dynamic linear model, as we will see later. In this models, we usually have a few things.</p>
<p>The first thing is we have two equations. One is the so-called observation equation that is relating your <span class="math inline">y_t</span>, your observed process to some parameters in the model that are changing over time. The next equation is the so-called system level equation or evolution equation that tells me how that time varying parameter is going to be changing over time. The other thing you may notice is that we have a linear structure both in the observational level and in the system level. The linear structure, in the sense of the expected value of <span class="math inline">y_t</span> is just a linear function of that <span class="math inline">\mu_t</span>. It happens to be <span class="math inline">\mu_t</span> in this particular case. In the second level, I can think of the expected value of <span class="math inline">\mu_t</span> as a linear function given <span class="math inline">\mu_{t-1}</span>, so it’s a function that is linear on <span class="math inline">\mu_{t-1}</span>. There is that linear structure. The other thing that we have here is at both levels, we have the assumption of normality for the noise terms in those equations. This is an example of a Gaussian or normal dynamic. These are time-varying parameters linear model. We will be discussing the general class of models. This is just an example. We will also discuss how to build different structures into the model, as well as how to perform Bayesian inference and forecasting.</p>
</section>
<section id="general-form-of-the-model" class="level3" data-number="96.1.8">
<h3 data-number="96.1.8" class="anchored" data-anchor-id="general-form-of-the-model"><span class="header-section-number">96.1.8</span> General form of the model</h3>
<p>The general class of dynamic linear models can be written as follows. Again, we are going to have two equations. One is the so-called observation equation that relates the observations to the parameters in the model, and the notation we are going to use is as follows. Here, my observations are univariate. We are discussing models for univariate time series. I have that related to a vector of parameters, <span class="math inline">\theta_t</span> plus some noise here. This is the noise. The noise are assumed to be independent, identically distributed normal random variables, 0, <span class="math inline">V_t</span>. Then I have another equation which is a system equation that has this form. There is a general <span class="math inline">G_t</span> matrix. This is going to be depending on <span class="math inline">\theta_{t-1}</span>. This is a vector, and then I have again, these are iid multivariate <span class="math inline">\mathcal{N}(0, W_t)</span>. This is the observation equation. This is the system equation or evolution equation. This defines a normal dynamic linear model. Here, we are going to say that <span class="math inline">F_t</span> is a vector. The dimension of the vector is going to be the same as the number of parameters in the model. Let’s say we have k. This is a vector of known values. For each t, we are going to assume that we know what that vector is. Then we have the vector of parameters here is also of dimension k of parameters. The <span class="math inline">G</span> is the next thing we need to define is a known matrix. That one is also assumed to be known, and then I have <span class="math inline">V_t</span> is variance at the observational level. The <span class="math inline">W_t</span> we are going to assume at the beginning that these two quantities are also known for all the values <span class="math inline">t</span>. This is the variance-covariance matrix at the system level. Again, if we think about these two equations, we have the model defined in this way.</p>
<p>There is a next piece that we need to consider if we are going to perform based in inference for the model parameters. The next piece that we need to consider to just fully specify the model is what is the prior distribution. In a normal dynamic linear model, the prior distribution is assumed to be conjugate here. In the case again in which <span class="math inline">V_t</span> and <span class="math inline">W_t</span> are known, we are going to be assuming that, say that zero, the parameter vector before observing any data is going to be normally distributed Multivariate normal with <span class="math inline">M_0</span> and <span class="math inline">C_0</span>. The mean is a vector, again of the same dimension as <span class="math inline">\theta_0</span>. Then I have k by k covariance matrix there as well. These are assumed to be also given to move forward with the model.</p>
</section>
<section id="inference-forecasting-smoothing-and-filtering." class="level3" data-number="96.1.9">
<h3 data-number="96.1.9" class="anchored" data-anchor-id="inference-forecasting-smoothing-and-filtering."><span class="header-section-number">96.1.9</span> Inference, forecasting, smoothing, and filtering.</h3>
<p>In terms of the inference, there are different kinds of densities and quantities that we are interested in. One distribution that we are interested in finding is the so-called <strong>filtering distribution</strong>. We may be interested here in finding what is the density of <span class="math inline">\theta_{t}</span> given all the observations that we have up to time <span class="math inline">t</span>. I’m going to call and all the information that I have up to time t. I’m going to call that <span class="math inline">D_t</span> . It can also be, in some cases, I will just write down. So <span class="math inline">D_t</span>, you can view with all the info up to time <span class="math inline">t</span>. Usually, it is all the information I have at time zero. Then coupled, if there is no additional information that’s going to be coupled with all the data points I have up to that time. Here I’m conditioning on all the observed quantities and the prior information up to time t, and I may be interested in just finding what is the distribution for <span class="math inline">\theta_{t}</span>.</p>
<p>This is called filtering. Another quantity that is very important in time series analysis is forecasting.</p>
<p>I may be interested in just what is the <strong>density</strong>, the distribution of <span class="math inline">y_{t+h}</span> ? Again, the number of steps ahead here, here I’m thinking of <span class="math inline">h</span>, given that I have all this information up to time <span class="math inline">t</span>. I’m interested in <strong>predictions</strong> here. We will be talking about <strong>forecasting</strong>. Then another important quantity or an important set of distributions is what we call the <strong>smoothing distribution</strong>. Usually, you have a time series, when you get your data, you observe, I don’t know, 300 data points. As you go with the filtering, you are going to start from zero all the way to 300 and you’re going to update these filtering distributions as you go and move forward. But then you may want to revisit your parameter at time 10, for example, given that you now have observed all these 300 observations. In that case, you’re interested in densities that are of the form. Let’s say that you observe capital <span class="math inline">T</span> in your process and now you are going to revisit that density for <span class="math inline">\theta_t</span>. This is now in the past. Here we assume that t is smaller than capital T. This is called smoothing. So you have more observation once you have seen the data. We will talk about how to perform Bayesian inference to obtain all these distributions under this model setting.</p>
</section>
<section id="the-forecast-function" class="level3 unumbered" data-number="96.1.10">
<h3 class="unumbered anchored" data-number="96.1.10" data-anchor-id="the-forecast-function"><span class="header-section-number">96.1.10</span> The forecast function</h3>
<p>In addition to all the structure that we described before and all the densities that we are interested in finding, we also have as usual, the so-called forecast function, which is just instead of being the density is just expected value of <span class="math inline">y(t+h)</span> given all the information I have up to time t. In the case of a general normal dynamic linear model, we have the structure for these just using the equations, the observation and the system of equations.</p>
<p>We’re going to have here <span class="math inline">G_{t+h}</span>. We multiply all these all the way to <span class="math inline">G_(t+1)</span>, and then we have the <span class="math inline">\mathbb{E}[\theta_{t}\mid D_t]</span>. This is the form of the <strong>forecast function</strong>. There are particular cases and particular models that we will be discussing in which the <span class="math inline">F_t</span> is equal to <span class="math inline">F</span>, so is constant for all <span class="math inline">t</span> and <span class="math inline">G_t</span> is also constant for all <span class="math inline">t</span>. In those cases, the forecast function can be simplified and written as <span class="math inline">F'G^h</span> expected value. One thing that we will learn is that the eigen-structure of this matrix is very important to define the form of the forecast function, and it’s very important for model building and for adding components into your model.</p>
</section>
<section id="short-form-notation" class="level3 unumbered" data-number="96.1.11">
<h3 class="unumbered anchored" data-number="96.1.11" data-anchor-id="short-form-notation"><span class="header-section-number">96.1.11</span> Short-form notation</h3>
<p>Finally, just in terms of short notation, we can always write down when we’re working with normal dynamic linear models, we may be referring to the model instead of writing the two equations, the system and the observation equation. I can just write all the components that define my model. This fully specifies the model in terms of the two equations. If I know what Ft is, what Gt is, what Vt is, and the covariance at the system level. I sometimes will be just talking about a short notation like this for defining the model.</p>
</section>
</div>
</div>
</div>
</section>
</section>
<section id="polynomial-trend-models" class="level2 page-columns page-full" data-number="96.2">
<h2 data-number="96.2" class="anchored" data-anchor-id="polynomial-trend-models"><span class="header-section-number">96.2</span> Polynomial Trend Models 🎥</h2>

<div class="no-row-height column-margin column-container"><div id="fig-first-and-second-order-polynomial-model" class="quarto-float quarto-figure quarto-figure-center anchored" data-group="slides">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-first-and-second-order-polynomial-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/m3_0011.png" class="lightbox" data-gallery="slides" title="Figure&nbsp;96.2: first and second order polynomial model"><img src="images/m3_0011.png" class="img-fluid figure-img" style="width:53mm"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-first-and-second-order-polynomial-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;96.2: first and second order polynomial model
</figcaption>
</figure>
</div><div id="fig-p-order-polynomial-model" class="quarto-float quarto-figure quarto-figure-center anchored" data-group="slides">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-p-order-polynomial-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/m3_0012.png" class="lightbox" data-gallery="slides" title="Figure&nbsp;96.3: p-order polynomial model"><img src="images/m3_0012.png" class="img-fluid figure-img" style="width:53mm"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-p-order-polynomial-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;96.3: p-order polynomial model
</figcaption>
</figure>
</div></div>
<p>While we haven’t talked about the superposition principle yet we start at looking at adding different components to the DLM.</p>
<p>We might :</p>
<ul>
<li>setting a baseline mean and variance</li>
<li>adding a random walk with its variance</li>
<li>add a trend</li>
<li>add a regression</li>
<li>add seasonality</li>
</ul>
<p>Next we want to extend the random walk model to include different types of trends and this will be covered by the polynomial trend models. <mark>These are models that are useful to model linear trends or polynomial trends in your time series. So if you have a data set, where you have an increasing trend, or a decreasing trend, you would use one of those <strong>components</strong> in your model.</mark> Also</p>
<section id="first-order-polynomial-model" class="level3" data-number="96.2.1">
<h3 data-number="96.2.1" class="anchored" data-anchor-id="first-order-polynomial-model"><span class="header-section-number">96.2.1</span> First order polynomial model</h3>
<p>The first order model is developed at great detail in chapter In <span class="citation" data-cites="west2013bayesian">(<a href="references.html#ref-west2013bayesian" role="doc-biblioref">West and Harrison 2013</a> ch.&nbsp;2)</span>. I don’t know what to make of it, isn’t this a trivial white noise model?</p>
<p>The math for Bayesian updating is fairly straight forward and must be much more complex with more sophisticated dynamics. So this is used by the authors to introduce their DLM and an 30 pages of the book is dedicated to in depth analysis and Bayesian development of this specific model and different distribution of interests as well as including comparison to other models and a look at the signal to noise ratio in the model.</p>
<p>It is worthwhile pointing out that these models get their name from their forecast function which will takes the general form <a href="#eq-DLM-n-order-polynomial-forecast-function" class="quarto-xref">Equation&nbsp;<span>96.22</span></a></p>
<p>The first order polynomial model is a model that is useful to describe linear trends in your time series. If you have a data set where you have an increasing trend or a decreasing trend, you would use one of those components in your model.</p>
<p>So the all those can be incorporated using the general p-order polynomial model, so I will just describe the form of this model.</p>
<p>A first order polynomial is of the form <span class="math inline">Ax+B</span> where A is the slope and B is the intercept. This is the same random walk model we saw above.</p>
<p><span id="eq-DLM-first-order-polynomial-model"><span class="math display">
\begin{aligned}
y_t &amp;= \theta_t + \nu_t, \qquad &amp; \nu_t &amp; \overset{\text{iid}}{\sim}  \mathcal{N}(0, V_t) \\
\theta_t &amp;= \theta_{t-1} + \omega_t, \qquad &amp; \omega_t &amp; \overset{\text{iid}}{\sim}  \mathcal{N}(0, W_t) \\
&amp;\{1,1,v_t,W_t\} &amp;&amp; \text{(short form)} \\
f_t(h) &amp;= \mathbb{E}[\theta_t \mid \mathcal{D}_t] &amp;&amp; \text{(forecast fn)} \\
\end{aligned}
\tag{96.13}</span></span></p>
<p>In the observation equation, <span class="math inline">\theta_{t}</span> is the level of the series at time t and <span class="math inline">\nu_t</span> is the observation error. In the evolution equation we see the mean for this parameter changing over time as a random walk or a local constant mean with evolution noise <span class="math inline">\omega_t</span>.</p>
<p><span class="citation" data-cites="west2013bayesian">(<a href="references.html#ref-west2013bayesian" role="doc-biblioref">West and Harrison 2013, sec. 2.1</a>)</span> gives the following representation of the model:</p>
<p>It is useful to think of <span class="math inline">\theta_t</span> as a smooth function of time <span class="math inline">\theta(t)</span> with an associated Taylor series representation</p>
<p><span id="eq-DLM-taylor-series-representation"><span class="math display">
\theta(t + \delta t) = \theta(t) + \text{higher-order terms}
\tag{96.14}</span></span></p>
<p>where the higher-order terms are assumed to be zero-mean noise. This is a very important point, because it means that we are not trying to model the higher-order terms explicitly, but rather we are assuming that they are just noise.</p>
<p>with the model simply describing the higher-order terms as zero-mean noise.</p>
<p>This is the genesis of the first-order polynomial DLM: the level model is a locally constant (first-order polynomial) proxy for the underlying evolution.·</p>
<p>We can write it down in short form with the following quadruple/</p>
<p><span id="eq-DLM-1-order-polynomial-model-short"><span class="math display">
\{1, 1, V_t, W_t\} \qquad f_t(h) = \mathbb{E}[\theta_t \mid \mathcal{D}_t] = k_t \ \forall   h&gt;0
\tag{96.15}</span></span></p>
<p>Next we can write the forecast function <span class="math inline">f_t(h)</span> of this model using the representation we gave in <a href="#eq-DLM-1-order-polynomial-model-short" class="quarto-xref">Equation&nbsp;<span>96.15</span></a>.</p>
<p>Again, we’re going to have something of the form <span class="math inline">F</span> transposed <span class="math inline">G</span> to the power of h and then the expected value of that <span class="math inline">\theta_t</span> given <span class="math inline">\mathcal{D}_t</span>. <span class="math inline">F</span> is 1, <span class="math inline">G</span> is 1, therefore I’m going to end up having just expected value of <span class="math inline">\theta_t</span> given <span class="math inline">\mathcal{D}_t</span>.</p>
<p>Which depending on the data that you have is you’re just going to have something that is a value that depends on <span class="math inline">t</span> and it doesn’t depend on <span class="math inline">h</span>. What this model is telling you is that the forecast function, how you expect to see future values of the series h steps ahead is something that looks like the level that you estimated at time <span class="math inline">t</span>.</p>
</section>
<section id="second-order-polynomial-model-aka-linear-growth-model" class="level3" data-number="96.2.2">
<h3 data-number="96.2.2" class="anchored" data-anchor-id="second-order-polynomial-model-aka-linear-growth-model"><span class="header-section-number">96.2.2</span> Second order Polynomial model AKA Linear Growth model</h3>
<p><span class="citation" data-cites="west2013bayesian">(<a href="references.html#ref-west2013bayesian" role="doc-biblioref">West and Harrison 2013, secs. 7.1–7.2</a>)</span> gives a detailed analysis of this model.</p>
<p>Now we want to create a model in which captures things that has a linear trend either increasing or decreasing. To do thus we need to have two components in our parameter vector of the state vector. For this we will need two components in our parameter vector of the <strong>state vector</strong><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>So we have again something that looks like in my observation equation. I’m going to have, I’m going to call it say <span class="math inline">\theta_{t,1} \sim  \mathcal{N}(v_t)</span>, and then I’m going to have say <span class="math inline">\theta_{t,1}</span> is going to be of the form to <span class="math inline">\theta_{t-1,1}</span> and there is another component here. The other component enters this equation plus let’s call this <span class="math inline">\theta_{t-1,2}</span>. And then I have finally also I need an evolution for the second component of the process which is going to be again having a random walk type of behavior.</p>
<p><span id="eq-NDLM-2-order-polynomial-model"><span class="math display">\begin{aligned}
  y_t &amp;= \theta_{t,1} + \nu_t \quad &amp;\nu_t &amp;\overset{\text{iid}}{\sim}  \mathcal{N}(0, v_t) \\
  \theta_{t,1} &amp;= \theta_{t-1,1} + \theta_{t-1,2} + \omega_{t,1} \qquad &amp;\omega_{t,1} &amp;\overset{\text{iid}}{\sim}  \mathcal{N}(0, w_{t,11}) \\
  \theta_{t,2} &amp;= \theta_{t-1,2} + \omega_{t,2} \qquad &amp;\omega_{t,2} &amp;\overset{\text{iid}}{\sim}  \mathcal{N}(0, w_{t,22})
\end{aligned}
\tag{96.16}</span></span></p>
<p>So there are different ways in which you can interpret this two parameters but essentially:</p>
<ul>
<li><span class="math inline">\theta_{t-1,1}</span> is related to the <strong>baseline</strong> level of the series</li>
<li><span class="math inline">\theta_{t-1,2}</span> is related to the <strong>rate of change</strong> of the of the series.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Short form DLM notation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Having the short form notation makes the model easier to understand in relation to other DLM models.</li>
<li>It will soon be instrumental in communicating the model structure with different software packages.</li>
</ul>
</div>
</div>
</div>
<p>Next we should summarize this model using the familiar short form DLM representation, which requires a bit of creative algebra.</p>
<p><span class="math display">
\mathbf{\theta}_t = (\theta_{t,1}, \theta_{t,2}) \qquad \{\mathbf{F}, \mathbf{G}, V_t, \mathbf{W}_t\}
</span></p>
<p>First we collect the two variances for the evolution two components into the vector <span class="math inline">\utilde{w}_t</span> and then assume that this <span class="math inline">w_t</span> is Normal. Now this is a bi-variate normal.</p>
<p><span class="math display">
\utilde{\omega}_t = (\omega_{t,1},\omega_{t,2})' \qquad \utilde{\omega}_t \sim  \mathcal{N}(0,W_t)
</span></p>
<p>So what would be my <span class="math inline">F</span> and my <span class="math inline">G</span> in this model? So again my theta vector has two components, thus my <span class="math inline">G</span>, so my <span class="math inline">F</span> is going to be a two dimensional. We can write down <span class="math inline">F</span> transposed as the only component that appears at this level is the first component of the vector. I’m going to have 1 and then a zero for <span class="math inline">F</span> transposed. c.f. <a href="#eq-DLM-2-order-polynomial-model-short-form-simple" class="quarto-xref">Equation&nbsp;<span>96.17</span></a> And then my <span class="math inline">G</span> here if you think about writing down <span class="math inline">\theta_t</span> times <span class="math inline">G</span> say the <span class="math inline">t-1 + \omega_t</span>. Then you have that you’re <span class="math inline">G</span> is going to have this form.</p>
<p><span id="eq-DLM-2-order-polynomial-model-short-form-simple"><span class="math display">
\begin{aligned}
\mathbf{F} &amp;= (1,0)' &amp; V_t &amp;= v_t \\
\mathbf{G} &amp;=
\begin{pmatrix}
1 &amp; h \\
0 &amp; 1
\end{pmatrix}
&amp; \mathbf{W}_t &amp;=
\begin{pmatrix}
w_{t,11} &amp; 0 \\
0 &amp; w_{t,22}
\end{pmatrix}
\end{aligned}
\tag{96.17}</span></span></p>
<p>this is the form from the video <span id="eq-DLM-2-order-polynomial-model-short-form-complex"><span class="math display">
\begin{aligned}
\mathbf{F} &amp;= (1,0)' &amp; V_t &amp;= v_t \\
\mathbf{G} &amp;=
\begin{pmatrix} 1 &amp; h \\
0 &amp; 1 \end{pmatrix}
&amp; \mathbf{W}_t &amp;=
\begin{pmatrix}
w_{t,11} &amp; w_{t,12} \\
w_{t,21} &amp; w_{t,22}
\end{pmatrix}
\end{aligned}
\tag{96.18}</span></span></p>
<p>this is the more general form from the handout. Note that in this case we have <span class="math inline">w_{t,12}=w_{t,21}</span> so there is just one extra parameter.</p>
<p>The lesson videos and the handouts differ in the form <span class="math inline">\mathbf{W}_t</span>. In the lecture we assumed zero covariance but in the handout the covariance was snuck in. This gives us a slightly more general model. The covariance though is symmetric so we get an extra parameter we need to infer and include in the prior. Anyhow I kept the more general form, though in most cases we will keep the off diagonal terms at zero.</p>
<p>So for the first component, I have past values of both components. That’s why I have a 1 and 1 here for the second component I only have the past value of the second component. So there is a zero and a 1. So this tells me what is the structure of this second order polynomial. If I think about how to obtain the forecast function for this second order polynomial is going to be very similar to what we did before. So you can write it down as F transposed G to the power of h, expected value of theta t given Dt. Now the expected value is going to be vector also with two components because theta_t is a two dimensional vector. The structure here if you look at what G is G to the power of h going to be a matrix, that is going to look like 1, h, 0 1. When you multiply that matrix time this times this F what you’re going to end up having is something that looks like 1 h times this expected value of theta t given Dt. So I can think of two components here, so this gives you a constant on h, this part is not going to depend on h. So I can write this down as k t 11 component multiplied by 1 and then I have another constant, multiplied by h. So you can see what happens now is that your forecast function has the form of a linear polynomial. So it’s just a linear function on the number of steps ahead. The slope and the intercept related to that linear function are going to depend on the expected value of, theta_t given the all the information I have up to time t. But essentially is a way to model linear trends. So this is what happens with the second order polynomial model.</p>
<p>As we included linear trends and constant values in the forecast function, we may want to also incorporate other kinds of trends, polynomial trends in the model. So you may want to have a quadratic form, the forecast function or a cubic forecast function as a function of h.</p>
<p><span class="math display">
\theta_t = (\theta_{t,1}, \theta_{t,2})' \qquad \mathbf{G} = \mathbf{J}_2(1) \qquad \mathbf{E}_2 = (1, 0)'
</span></p>
<p><span class="math display">
\mathbf{G^h} =
\begin{pmatrix}
1 &amp; h \\
0 &amp; 1
\end{pmatrix}
</span></p>
<p><span id="eq-second-order-poly-prediction-fn"><span class="math display">
\begin{aligned}
f_t(h) &amp;= F' G^h \mathbb{E}[\theta_t \mid \mathcal{D}_t] \\
&amp;= (1,h) \mathbb{E}[\theta_{t}\mid D_t] \\
&amp;= (1,h)(K_{t,0}, K_{t,1})' \\
&amp;= (K_{t,0} + K_{t,1} h)
\end{aligned}
\tag{96.19}</span></span></p>
<p><span id="eq-second-order-poly-Gh"><span class="math display">
\begin{aligned}
\mathbf{G^h} &amp;=
\begin{pmatrix}
1 &amp; h \\
0 &amp; 1
\end{pmatrix}
\end{aligned}
\tag{96.20}</span></span></p>
</section>
<section id="general-p-th-order-polynomial-model" class="level3" data-number="96.2.3">
<h3 data-number="96.2.3" class="anchored" data-anchor-id="general-p-th-order-polynomial-model"><span class="header-section-number">96.2.3</span> General p-th order polynomial model</h3>
<p>We can consider a so called p-th order polynomial model. This model will have a state-space vector of dimension p and a polynomial of order <span class="math inline">p − 1</span> forecast function on <span class="math inline">h</span>. The model can be written as</p>
<p><span class="math display">
\{E_p, J_p(1), v_t, W_t\}
</span></p>
<p>with <span class="math inline">F_t = E_p = (1, 0, \ldots, 0)′</span> and <span class="math inline">G_t = J_p(1)</span>, with</p>
<p><span id="eq-Jordan-form-dynamics"><span class="math display">
J_p(1) = \begin{pmatrix}
1 &amp; 1 &amp; 0 &amp; \cdots &amp; 0 &amp; 0  \\
0 &amp; 1 &amp; 1 &amp; \cdots &amp; 0 &amp; 0  \\
0 &amp; 0 &amp; 1 &amp; \cdots &amp; 0 &amp; 0 \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; 0 &amp; \cdots &amp; 1 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 1
\end{pmatrix}
\tag{96.21}</span></span></p>
<p>The forecast function is given by <span id="eq-DLM-n-order-polynomial-forecast-function"><span class="math display">
f_t(k) = a_{t_0} +  a_{t_1}k + \ldots + a_{t_{n-1}} k^{n-1} \qquad k \in \mathbb{N}
\tag{96.22}</span></span></p>
<p>where <span class="math inline">a_{t_i}</span> are the coefficients of the polynomial and <span class="math inline">k</span> is the number of steps ahead we need in our forecast. There is also an alternative parameterization of this model that leads to the same algebraic form of the forecast function given by <span class="math inline">\{Ep, Lp, vt, W t\}</span>, with</p>
<p><span id="eq-triangular-form-dynamics"><span class="math display">
L_p = \begin{pmatrix}
1 &amp; 1 &amp; 1 &amp; \cdots &amp; 1 &amp; 1  \\
0 &amp; 1 &amp; 1 &amp; \cdots &amp; 1 &amp; 1   \\
0 &amp; 0 &amp; 1 &amp; \cdots &amp; 1 &amp; 1 \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; 0 &amp; \cdots &amp; 1 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 1
\end{pmatrix}
\tag{96.23}</span></span></p>
<p>And in this type of model, the forecast function is going to have order <span class="math inline">p-1</span>. So the parameter vector is going to have dimension <span class="math inline">p</span>. So you’re going to have <span class="math inline">\theta_t =  \theta_{t1:p}</span>.</p>
<p>The observation operator <span class="math inline">F</span> is just a constant and if we write it as a row vector we get <span class="math inline">F'</span> as a p-dimensional vector with the one in the first entry and zeros everywhere else.</p>
<p>The dynamics matrix <span class="math inline">G</span> may be written using either a <span class="math inline">J</span> Jordan form <a href="#eq-Jordan-form-dynamics" class="quarto-xref">Equation&nbsp;<span>96.21</span></a> or as a triangular form <a href="#eq-triangular-form-dynamics" class="quarto-xref">Equation&nbsp;<span>96.23</span></a>. These result in different parameterization of this model and we will talk a little bit about this.</p>
<p>In the <a href="#eq-Jordan-form-dynamics" class="quarto-xref">Equation&nbsp;<span>96.21</span></a> we have a matrix with ones on the diagonal and the super diagonal, the matrix is needs to be <span class="math inline">p \times p</span> i.e.&nbsp;with dimension <span class="math inline">p</span> to be compatible with the dimension of the hidden state vector <span class="math inline">\theta</span>. So this matrix <span class="math inline">G</span> is what we call a Jordan block of dimension p of 1. So here 1 is the number that appears in the diagonal. And then I have a p <span class="math inline">I_p</span> matrix, I have ones in the upper diagonal part. So this is the form of the model, so once again I have the <span class="math inline">F</span> the <span class="math inline">G</span>, and the <span class="math inline">W_t</span>. I have my model.</p>
<p>The forecast function in this case again can be written as <span class="math inline">F' G^h \mathbb{E}[\theta_t \mid \mathcal{D}_t]</span>. And when you simplify times expected value of <span class="math inline">\theta_t</span>, given <span class="math inline">D_t</span>. Once you simplify those functions you get something that is a polynomial of order <span class="math inline">p-1</span> in <span class="math inline">h</span>. So I just can write this down as <span class="math inline">k_t + k_{t,1} h + k_{t, p-1} h^{p-1}</span>, so that’s my forecast function.</p>
<p>There is an alternative parameterization of this model that has the same <span class="math inline">F</span> and the same algebraic form of the forecast function, the same form of the forecast function. But instead of using <a href="#eq-Jordan-form-dynamics" class="quarto-xref">Equation&nbsp;<span>96.21</span></a> form of the <span class="math inline">G</span> matrix, it has a <a href="#eq-triangular-form-dynamics" class="quarto-xref">Equation&nbsp;<span>96.23</span></a> form that has ones in the diagonal and ones everywhere above the diagonal. So it’s an upper triangular matrix with ones in the diagonal and above the diagonal. That’s a different parameterization of the same model but it leads to the same general form of the forecast function just with a different parameterization.</p>
<p>So again, we can consider the way you think about these models?</p>
<ul>
<li>What is you think what kind of forecast function makes sense here ?</li>
<li>What is the type of predictions that I expect to have in my model?</li>
<li>If they look like a linear trend, I use a second order polynomial.</li>
<li>If it looks like a quadratic trend in the forecast then I would use 3rd order polynomial model representation.</li>
</ul>
<p>Note that the third order polynomial model is covered in</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Video Transcript
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<!-- transcript of https://www.coursera.org/learn/bayesian-statistics-time-series-analysis/lecture/653eR/polynomial-trend-models -->
<section id="first-order-polynomial-models" class="level3" data-number="96.2.4">
<h3 data-number="96.2.4" class="anchored" data-anchor-id="first-order-polynomial-models"><span class="header-section-number">96.2.4</span> First order Polynomial Models</h3>
<p>I will begin describing the structure of a particular class of models now, the polynomial trend models. These are models that are useful to describe linear trends or polynomial trends in your time series. So if you have a data set, where you have an increasing trend, or a decreasing trend, you would use one of those components in your model.</p>
<p>We will begin with the first order polynomial model, which we have already described. It’s the one that has <span class="math inline">y_t</span> is a single parameter, I’m going to call it just <span class="math inline">\theta_t + \nu_t</span>. And then a random walk evolution for that single parameter, so that’s the mean level of the series. And then we assume that it changes as a random walk, so this is the first order polynomial model.</p>
<p>So in general, I’m going to begin with the first order polynomial model, which we have already described. It’s the one that has <span class="math inline">y_t</span> is a single parameter, I’m going to call it just <span class="math inline">\theta_t + \nu_t</span>. And then a random walk evolution for that single parameters, so that’s the mean level of the series. And then we assume that it changes As a random walk, so this is the first order polynomial model. In this model if I want to write it down in short form I would have a quadruple that looks like this. So the <span class="math inline">F</span> here that goes <span class="math inline">F</span> transposed times the parameter vector in this case we have a scalar vector, scalar parameter. It’s going to be 1 my <span class="math inline">G</span> that goes next to the state of <span class="math inline">t-1</span> is going to also be 1. And then I have vt and Wt here. So this fully defines my model if I think about the forecast function of this model using the representation we had before. Again, we’re going to have something of the form <span class="math inline">F'G^h</span> and then the expected value of that <span class="math inline">\theta_t | \mathcal{D}_t</span>. <span class="math inline">F</span> is 1, <span class="math inline">G</span> is 1, therefore I’m going to end up having just expected value of <span class="math inline">\theta_t | \mathcal{D}_t</span>. Which depending on the data that you have is you’re just going to have something that is a value that depends on t and it doesn’t depend on <span class="math inline">h</span>.</p>
<p>What this model is telling you is that the forecast function, how you expect to see future values of the series h steps ahead is something that looks like the level that you estimated at time t.</p>
<p>So that’s the forecast function, you is a first order is a zero order polynomial is a constant on h and it’s called the first order polynomial model.</p>
</section>
<section id="second-order-polynomial-models" class="level3" data-number="96.2.5">
<h3 data-number="96.2.5" class="anchored" data-anchor-id="second-order-polynomial-models"><span class="header-section-number">96.2.5</span> Second order Polynomial Models</h3>
<p>In the case of a second order polynomial We are going to now think about about a model in which we want to capture things that are not a constant over time but may have an increasing or decreasing linear trend. In this case we’re going to need two components in your parameter vector in the state vector.</p>
<p>So we have again something that looks like in my observation equation. I’m going to have, I’m going to call it say theta{t,1} Normal vt, and then I’m going to have say theta_{t,1} is going to be of the form to theta_{t-1,1} and there is another component here. The other component enters this equation plus let’s call this And then I have finally also I need an evolution for the second component of the process which is going to be again having a random walk type of behavior. So there is different ways in which you can interpret this two parameters but essentially one of them is related to the baseline level of the series the other one is related to the rate of change of the of the series. So if you think about the dlm representation again, these two components, I can collect into the vector wt. and then assume that this wt Is normal. Now this is a bivariate normal. So what would be my F and my G in this model? So again my theta vector has two components My G, so my F is going to be a two dimensional vectors. So I can write down F transposed as the only component that appears at this level is the first component of the vector. I’m going to have 1 and then a zero for F transposed. And then my G here if you think about writing down theta t times G say the t -1 +wt. Then you have that you’re G is going to have this form. So for the first component, I have past values of both components. That’s why I have a 1 and 1 here for the second component I only have the past value of the second component. So there is a zero and a 1. So this tells me what is the structure of this second order polynomial. If I think about how to obtain the forecast function for this second order polynomial is going to be very similar to what we did before. So you can write it down as F transposed G to the power of h, expected value of theta t given Dt. Now the expected value is going to be vector also with two components because theta_t is a two dimensional vector. The structure here if you look at what G is G to the power of h going to be a matrix, that is going to look like 1, h, 0 1. When you multiply that matrix time this times this F what you’re going to end up having is something that looks like 1 h times this expected value of theta t given Dt. So I can think of two components here, so this gives you a constant on h, this part is not going to depend on h. So I can write this down as k t 11 component multiplied by 1 and then I have another constant, multiplied by h. So you can see what happens now is that your forecast function has the form of a linear polynomial. So it’s just a linear function on the number of steps ahead. The slope and the intercept related to that linear function are going to depend on the expected value of, theta_t given the all the information I have up to time t. But essentially is a way to model linear trends. So this is what happens with the second order polynomial model.</p>
</section>
<section id="p-th-order-polynomial-models" class="level3" data-number="96.2.6">
<h3 data-number="96.2.6" class="anchored" data-anchor-id="p-th-order-polynomial-models"><span class="header-section-number">96.2.6</span> P-th Order Polynomial Models</h3>
<p>As we included linear trends and constant values in the forecast function, we may want to also incorporate other kinds of trends, polynomial trends in the model. So you may want to have a quadratic form, the forecast function or a cubic forecast function as a function of h. So the all those can be incorporated using the general p-order polynomial model, so I will just describe the form of this model. And in this type of model, the forecast function is going to have order p-1. So your parameter vector is going to have dimension p.&nbsp;So you’re going to have theta_t theta t1 to tp. Your F matrix is going to be constant if I write it as a row vector. F transpose is going to be a p dimensional vector with the one in the first entry and zeros everywhere else. My G matrix is going to have this form and there is different parameterizations of this model and I will talk a little bit about this. But one way to parameterize the model is something that looks like this. So you have ones in the diagonal of the matrix, the matrix is going to be a p by p has to be the dimension of the p compatible with the dimension of the state vector. And then you have zeros’s below the diagonal above that set of ones that are also ones above the diagonal. So this matrix G is what we call a Jordan block of dimension p of 1. So here 1 is the number that appears in the diagonal. And then I have a p Ip matrix, I have ones in the upper diagonal part. So this is the form of the model, so once again I have the F the G, and the wt. I have my model. The forecast function in this case again can be written as F transposed G to the power of h. And when you simplify times expected value of theta_t, given Dt. Once you simplify those functions you get something that is a polynomial of order p-1 in h. So I just can write this down as kt constant.Plus kt1 h + kt p- 1, h to the p -1, so that’s my forecast function. There is an alternative parameterization of this model that has the same F and the same algebraic form of the forecast function, the same form of the forecast function. But instead of having this G matrix, it has a matrix that has ones in the diagonal and ones everywhere above the diagonal. So it’s an upper triangular matrix with ones in the diagonal and above the diagonal. That’s a different parameterization of the same model is going to have the same general form of the forecast function is a different parameterization. So again, you can consider the way you think about these models is you think what kind of forecast function I want to have for my future? What is the type of predictions that I expect to have in my model? And if they look like a linear trend, I use a second order polynomial. If it looks like a quadratic trend in the forecast then I would use 3rd order polynomial model representation.</p>
</section>
</div>
</div>
</div>
</section>
</section>
<section id="summary-of-polynomial-trend-models" class="level2" data-number="96.3">
<h2 data-number="96.3" class="anchored" data-anchor-id="summary-of-polynomial-trend-models"><span class="header-section-number">96.3</span> Summary of polynomial trend models 📖</h2>
<section id="polynomial-trend-models-1" class="level3" data-number="96.3.1">
<h3 data-number="96.3.1" class="anchored" data-anchor-id="polynomial-trend-models-1"><span class="header-section-number">96.3.1</span> Polynomial Trend Models</h3>
<section id="first-order-polynomial" class="level4" data-number="96.3.1.1">
<h4 data-number="96.3.1.1" class="anchored" data-anchor-id="first-order-polynomial"><span class="header-section-number">96.3.1.1</span> First-Order Polynomial</h4>
<p><span class="math display">
\begin{aligned}
y_t &amp;= \mu_t + \nu_t, \qquad &amp; \nu_t &amp;\sim  \mathcal{N}(0, v_t) \\
\mu_t &amp;= \mu_{t-1} + \omega_t, \qquad &amp; \omega_t &amp;\sim  \mathcal{N}(0, w_t)
\end{aligned}
</span></p>
<p>In this case, we have:</p>
<p><span class="math inline">\theta_t = \mu_t \quad \forall t</span></p>
<p><span class="math display">
F_t = 1 \quad \forall t \qquad G_t = 1 \quad \forall t
</span></p>
<p>resulting in:</p>
<p><span class="math display">
\{1, 1, v_t, w_t\} \qquad \text{(short notation)}
</span></p>
<p>The forecast function is:</p>
<p><span class="math display">
f_t(h) = E(\mu_t \mid \mathcal{D}_t) = k_t, \quad \forall h &gt; 0.
</span></p>
</section>
<section id="second-order-polynomial" class="level4" data-number="96.3.1.2">
<h4 data-number="96.3.1.2" class="anchored" data-anchor-id="second-order-polynomial"><span class="header-section-number">96.3.1.2</span> Second-Order Polynomial</h4>
<p><span class="math display">\begin{aligned}
  y_t &amp;= \theta_{t,1} + \nu_t, \quad &amp;\nu_t &amp;\sim  \mathcal{N}(0, v_t) \\
  \theta_{t,1} &amp;= \theta_{t-1,1} + \theta_{t-1,2} + \omega_{t,1}, \qquad &amp;\omega_{t,1} &amp;\sim  \mathcal{N}(0, w_{t,11}) \\
  \theta_{t,2} &amp;= \theta_{t-1,2} + \omega_{t,2}, \qquad &amp;\omega_{t,2} &amp;\sim  \mathcal{N}(0, w_{t,22}),
\end{aligned}
</span></p>
<p>where we can also have:</p>
<p><span class="math display">
\mathbb{C}ov(\theta_{t,1}, \theta_{t,2} ) = w_{t,12} = w_{t,21}
</span></p>
<p>This can be written as a DLM with the state-space vector <span class="math inline">\theta_t = (\theta_{t,1}, \theta_{t,2})'</span>, and</p>
<p><span class="math display">
\{\mathbf{F}, \mathbf{G}, v_t, \mathbf{W}_t\}  \qquad \text{(short notation)}
</span></p>
<p>with <span class="math inline">\mathbf{F} = (1, 0)'</span> and</p>
<p><span class="math display">
\mathbf{G} =
\begin{pmatrix}
1 &amp; 1 \\
0 &amp; 1
\end{pmatrix}, \quad \mathbf{W}_t =
\begin{pmatrix}
w_{t,11} &amp; w_{t,12} \\
w_{t,21} &amp; w_{t,22}
\end{pmatrix}.
</span></p>
<p>Note that</p>
<p><span class="math display">
\mathbf{G}^2 =
\begin{pmatrix}
1 &amp; 2 \\
0 &amp; 1
\end{pmatrix}, \quad \mathbf{G}^h =
\begin{pmatrix}
1 &amp; h \\
0 &amp; 1
\end{pmatrix},
</span></p>
<p>and so:</p>
<p><span class="math display">
f_t(h) = (1, h) E(\mathbf{\theta}_t \mid \mathcal{D}_t) = (1, h) (k_{t,0}, k_{t,1})' = (k_{t,0} + h k_{t,1}).
</span></p>
<p>Here <span class="math inline">\mathbf{G} = \mathbf{J}_2(1)</span> (see below).</p>
<p>Also, we denote <span class="math inline">\mathbf{E}_2 = (1, 0)'</span>, and so the short notation for this model is</p>
<p><span class="math display">
\{E_2, J_2(1), \cdot, \cdot\}
</span></p>
</section>
<section id="general-p-th-order-polynomial-model-1" class="level4" data-number="96.3.1.3">
<h4 data-number="96.3.1.3" class="anchored" data-anchor-id="general-p-th-order-polynomial-model-1"><span class="header-section-number">96.3.1.3</span> General <span class="math inline">p</span>-th Order Polynomial Model</h4>
<p>We can consider a <span class="math inline">p</span>-th order polynomial model. This model will have a state-space vector of dimension <span class="math inline">p</span> and a polynomial of order <span class="math inline">p-1</span> forecast function on <span class="math inline">h</span>. The model can be written as</p>
<p><span class="math display">\{E_p, J_p(1), v_t, W_t\}  \qquad \text{(short notation)}
</span></p>
<p>with <span class="math inline">\mathbf{F}_t = \mathbf{E}_p = (1, 0, \dots, 0)'</span> and <span class="math inline">\mathbf{G}_t = \mathbf{J}_p(1)</span>, with</p>
<p><span class="math display">
\mathbf{J}_p(1) =
\begin{pmatrix}
1 &amp; 1 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 1 &amp; \cdots &amp; 0 &amp; 0 &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \ddots &amp; &amp; \vdots \\
0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 1 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 &amp; 1
\end{pmatrix}.
</span></p>
<p>The forecast function is given by</p>
<p><span class="math display">
f_t(h) = k_{t,0} + k_{t,1} h + \dots + k_{t,p-1} h^{p-1}.
</span></p>
<p>There is also an alternative parameterization of this model that leads to the same algebraic form of the forecast function, given by <span class="math inline">\{E_p, L_p, v_t, W_t\}</span>, with</p>
<p><span class="math display">
L_p =
\begin{pmatrix}
1 &amp; 1 &amp; 1 &amp; \cdots &amp; 1 \\
0 &amp; 1 &amp; 1 &amp; \cdots &amp; 1 \\
\vdots &amp; \vdots &amp; \ddots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; 0 &amp; \cdots &amp; 1
\end{pmatrix}.
</span></p>
</section>
</section>
</section>
<section id="regression-models" class="level2 page-columns page-full" data-number="96.4">
<h2 data-number="96.4" class="anchored" data-anchor-id="regression-models"><span class="header-section-number">96.4</span> Regression models 🎥</h2>

<div class="no-row-height column-margin column-container"><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/m3_0021.png" class="lightbox" data-gallery="slides" title="Regression models"><img src="images/m3_0021.png" class="img-fluid figure-img" style="width:53mm" alt="Regression models"></a></p>
<figcaption>Regression models</figcaption>
</figure>
</div></div><section id="simple-dynamic-regression" class="level3" data-number="96.4.1">
<h3 data-number="96.4.1" class="anchored" data-anchor-id="simple-dynamic-regression"><span class="header-section-number">96.4.1</span> Simple dynamic regression</h3>
<p><span id="eq-simple-dynamic-regression"><span class="math display">
\begin{aligned}
y_t &amp;= \beta_{t,0} + \beta_{t,1}x_t + ν_t \\
\beta_{t,0} &amp;= \beta_{t−1,0} + \omega_{t,0} \\
\beta_{t,1} &amp;= \beta_{t−1,1} + \omega_{t,1}
\end{aligned}
\tag{96.24}</span></span></p>
<p>and so <span class="math inline">\theta_t = (\beta_t,0, \beta_{t,1})′</span>, <span class="math inline">F_t = (1, x_t)′</span> and <span class="math inline">G = I_2</span>.</p>
<p>This results in a forecast function of the form</p>
<p><span id="eq-simple-dynamic-regression-forecast-function"><span class="math display">
f_t(h) = k_{t,0} + k_{t,1}x_{t+h}
\tag{96.25}</span></span></p>
<p>where <span class="math inline">k_{t,0} = \mathbb{E}[\beta_{t,0} \mid \mathcal{D}_t]</span> and <span class="math inline">k_{t,1} = \mathbb{E}[\beta_{t,1} \mid \mathcal{D}_t]</span>.</p>
</section>
<section id="general-dynamic-regression" class="level3" data-number="96.4.2">
<h3 data-number="96.4.2" class="anchored" data-anchor-id="general-dynamic-regression"><span class="header-section-number">96.4.2</span> General dynamic regression</h3>
<p><span id="eq-regression-in-short-form"><span class="math display">
\begin{aligned}
y_t &amp;= \beta_{t,0} + \beta_{t,1}x_{t,1} + \ldots \beta_{t,M} x_{t,M} + ν_t \\
\beta_{t,m} &amp;= \beta_{t−1,m} + \omega_{t,m,} &amp; m = 0 : M.
\end{aligned}
\tag{96.26}</span></span></p>
<p>Then, <span class="math inline">\theta = (\beta_t,0, \ldots , \beta_{t,M} )′</span>, <span class="math inline">F_t = (1, x_{t,1}, \ldots , x_{t,M} )′</span> and <span class="math inline">G = I_M</span> . The forecast function is given by</p>
<p><span id="eq-gen-regression-forecast-function"><span class="math display">
f_t(h) = k_{t,0} + k_{t,1}x_{t+h,1} + \ldots + k_{t+h,M}x_{t+h,M}
\tag{96.27}</span></span></p>
<p>A particular case is of dynamic regressions is the case of time-varying auto-regressions (TVAR) with</p>
<p><span id="eq-tvar"><span class="math display">
\begin{aligned}
y_t &amp;= \varphi_{t,1}y_{t−1} + \varphi_{t,2}y_{t−2} + \ldots + \varphi_{t,p} y_{t−p} + ν_t,\\
\varphi_{t,m} &amp;= \varphi_{t−1,m} + \omega_{t,m,} &amp; m = 1 : p
\end{aligned}
\tag{96.28}</span></span></p>
<p>There is a paper <span class="citation" data-cites="prado2000bayesian">(<a href="references.html#ref-prado2000bayesian" role="doc-biblioref">Raquel Prado, Huerta, and West 2000</a>)</span> on TVAR models that is a good reference for this model.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Video Transcript
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<!-- transcript of https://www.coursera.org/learn/bayesian-statistics-time-series-analysis/lecture/fmnRh/regression-models -->
<section id="regression-models-1" class="level3" data-number="96.4.3">
<h3 data-number="96.4.3" class="anchored" data-anchor-id="regression-models-1"><span class="header-section-number">96.4.3</span> Regression Models</h3>
<p>In regression models, we may also have additional covariates that are also measured sequentially over time. We may want to regress the <span class="math inline">y_t</span> time series and see what relationships they have with other covariates that are also measured over time. The simplest possible case is the dynamic simple regression model. In this case, I can write down. I have a single covariate, that covariate is <span class="math inline">X_t</span> that is observed here, and then I have the usual. In this case, I have an intercept and a slope, and this is representing my simple linear regression. It’s just the regression where both the intercept and the slope are time-varying. I can define the variation. I need to specify what’s the evolution of the two components, and we are going to use this random walk. We could use other structures, but again, in the normal linear case, we are going to be using these evolution equations. Then I collect here my W’s as a single vector. The <span class="math inline">\omega_t</span> is going to have the two components in here. These are normally distributed zero and variance covariance matrix <span class="math inline">W_t</span>, that is a two-by-two matrix. This is the case of the simple regression model. In the case of this model, we have F now is time-varying. This is going to change depending on the value of X_t. I can write Ft transpose as one and X_t. My Theta vector. Again, if I think about what it is, is just Beta t, 0 Beta t, 1. I have those two components.</p>
<p>The <span class="math inline">G</span> matrix is going to be the identity, and you can see that essentially the first component is related to the first component in t minus one, and the second component at time t is related to the second component at time t minus 1. So the identity matrix will be the G. Therefore, if I think about my forecast function in the simple linear regression case, this is going to be my F transpose, which is 1 xt times the G, the G is the identity, times the expected value of Theta t, given Dt. For the expected value of Theta t given Dt, This is a two-dimensional vector, so I’m going to have components in there. I can write this down as K_t0 plus K_t1 Xt. We can see that the forecast function is again has that form that depends on that covariate at the time. This should be t plus h because we are evaluating this at t plus h. You need to have the covariate evaluated at t plus h here.</p>
</section>
<section id="general-dynamic-regression-model" class="level3" data-number="96.4.4">
<h3 data-number="96.4.4" class="anchored" data-anchor-id="general-dynamic-regression-model"><span class="header-section-number">96.4.4</span> General Dynamic Regression Model</h3>
<p> In the case of general dynamic regression model, we’re going to have a set of covariates. We can have, let’s say k of those covariates or p of those covariates, X_t1. This is my observation equation. Instead of having a single covariate, now I’m going to have p of them. I’m going to have coefficients that go with each of those and I may have the Beta t0 coefficient. My G matrix now, if I think about my parameter vector is just p plus 1 dimensional, p plus 1. Yeah, so that I have the 0 and then the p values, so is a p plus 1 vector. Then my G is the identity. My F_t is going to be a vector, is also p plus 1 dimension. The first entry is one, the second is X_t1 X_tp. My forecast function is going to be similar to this, but now we are going to have more than one covariate, so we end up with a forecast function that has this form, p.&nbsp;This is the case for the dynamic regression.</p>
</section>
<section id="tvar" class="level3" data-number="96.4.5">
<h3 data-number="96.4.5" class="anchored" data-anchor-id="tvar"><span class="header-section-number">96.4.5</span> TVAR</h3>
<p> In the case of dynamic regression, we can also have a time-varying autoregressive process. This is a particular case of dynamic regression where the covariates are just past values of the time series itself. In this case, we can think about the observation equation as being a linear combination of past values of the time series. One particular example of dynamic regression model is the case of a time-varying autoregressive process. This brings us back to those autoregressive processes that we were discussing earlier in the course. When you you’re regressing each of the X’s correspond to pass values, you have a regression model that we call a time-varying ARP. In this case, your observation equation is going to have the AR coefficients, but the AR coefficients are going to be varying over time. If we assume that we put all the coefficients together and have a random walk evolution equation for those. If I said, I call Phi_t the vector that contains all the components with all the coefficients from one to p, then I can now define this evolution equation. Then my Omega_t here is a p-dimensional vector, and I have Omega t, normal zero, WT, and my epsilon t normal 0 vt.</p>
<p>This defines a time-varying AR. It’s the same structure that we had before. The only difference is my covariates are just past values of the time series. Therefore my forecast function for the time-varying AR is going to have this form where every_thing is going to depend on past values of the time series. We will study this model in particular and make connections with the AR that we studied earlier in the class.</p>
</section>
</div>
</div>
</div>
</section>
</section>
<section id="summary-of-regression-models" class="level2 page-columns page-full" data-number="96.5">
<h2 data-number="96.5" class="anchored" data-anchor-id="summary-of-regression-models"><span class="header-section-number">96.5</span> Summary of Regression Models 📖</h2>
<section id="dynamic-regression-models" class="level3 page-columns page-full" data-number="96.5.1">
<h3 data-number="96.5.1" class="anchored" data-anchor-id="dynamic-regression-models"><span class="header-section-number">96.5.1</span> Dynamic Regression Models</h3>
<section id="simple-dynamic-regression-1" class="level4" data-number="96.5.1.1">
<h4 data-number="96.5.1.1" class="anchored" data-anchor-id="simple-dynamic-regression-1"><span class="header-section-number">96.5.1.1</span> Simple Dynamic Regression</h4>
<p><span class="math display">
\begin{aligned}
  y_t &amp;= \beta_{t,0} + \beta_{t,1} x_t + \nu_t \\
  \beta_{t,0} &amp;= \beta_{t-1,0} + \omega_{t,0} \\
  \beta_{t,1} &amp;= \beta_{t-1,1} + \omega_{t,1}
\end{aligned}
</span></p>
<p>Thus:</p>
<p><span class="math display">
\theta_t = (\beta_{t,0}, \beta_{t,1})'
</span></p>
<p><span class="math display">
F_t = (1, x_t)'
</span></p>
<p>and</p>
<p><span class="math display">
G = I_2
</span></p>
<p>This results in a forecast function of the form</p>
<p><span class="math display">
f_t(h) = k_{t,0} + k_{t,1} x_{t+h}.
</span></p>
</section>
<section id="general-dynamic-regression-1" class="level4 page-columns page-full" data-number="96.5.1.2">
<h4 data-number="96.5.1.2" class="anchored" data-anchor-id="general-dynamic-regression-1"><span class="header-section-number">96.5.1.2</span> General Dynamic Regression</h4>
<p><span id="eq-general-dynamic-regression"><span class="math display">
\begin{aligned}
y_t &amp;= \beta_{t,0} + \beta_{t,1} x_{t,1} + \dots + \beta_{t,M} x_{t,M} + \nu_t \\
\beta_{t,m} &amp;= \beta_{t-1,m} + \omega_{t,m}, \quad &amp;m = 0:M.
\end{aligned}
\tag{96.29}</span></span></p>
<p>Then,</p>
<p><span class="math inline">\theta_t = (\beta_{t,0}, \dots, \beta_{t,M})'</span>,</p>
<p><span class="math inline">\mathbf{F}_t = (1, x_{t,1}, \dots, x_{t,M})'</span> and</p>
<p><span class="math inline">\mathbf{G} = \mathbf{I}_M</span>.</p>
<p>The forecast function is given by:</p>
<p><span id="eq-forecast-function-general-dynamic-regression"><span class="math display">
f_t(h) = k_{t,0} + k_{t,1} x_{t+h,1} + \dots + k_{t,M} x_{t+h,M}.
\tag{96.30}</span></span></p>
<div class="page-columns page-full"><p>A particular case of dynamic regressions is the case of <strong>time-varying autoregressive (TVAR)</strong> with </p><div class="no-row-height column-margin column-container"><span class="" width="53mm" data-group="slides">time-varying autoregressive (TVAR)</span></div></div>
<p><span class="math display">
\begin{aligned}
  y_t &amp;= \phi_{t,1} y_{t-1} + \phi_{t,2} y_{t-2} + \dots + \phi_{t,p} y_{t-p} + \nu_t \\
  \phi_{t,m} &amp;= \phi_{t-1,m} + \omega_{t,m}, \quad m = 1:p.
\end{aligned}
</span></p>
</section>
</section>
</section>
<section id="the-superposition-principle" class="level2 page-columns page-full" data-number="96.6">
<h2 data-number="96.6" class="anchored" data-anchor-id="the-superposition-principle"><span class="header-section-number">96.6</span> The superposition principle 🎥</h2>

<div class="no-row-height column-margin column-container"><div id="fig-superposition-principle" class="quarto-float quarto-figure quarto-figure-center anchored" data-group="slides">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-superposition-principle-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/m3_0031.png" class="lightbox" data-gallery="slides" title="Figure&nbsp;96.4: The superposition principle"><img src="images/m3_0031.png" class="img-fluid figure-img" style="width:53mm"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-superposition-principle-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;96.4: The superposition principle
</figcaption>
</figure>
</div></div><p><mark>We can use the superposition principle to build models that have different kinds of components. The main idea is to think about what is the general structure we want for the forecast function and then isolate the different components of the forecast function and think about the classes of dynamic linear models that are represented in each of those components.</mark> Each of those components has a class and then we can build the general dynamic linear model with all those pieces together using this principle.</p>
<p>Two references for the Superposition principle are</p>
<ul>
<li><span class="citation" data-cites="west2013bayesian">(<a href="references.html#ref-west2013bayesian" role="doc-biblioref">West and Harrison 2013, sec. 3.1</a> p.&nbsp;98)</span></li>
<li><span class="citation" data-cites="prado2023time">(<a href="references.html#ref-prado2023time" role="doc-biblioref">R. Prado, Ferreira, and West 2023, sec. 4.2.1</a> p.&nbsp;136)</span></li>
</ul>
<div id="imp-superposition" class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important&nbsp;96.1: Superposition Principle
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the first the author state:</p>
<blockquote class="blockquote">
<p>Conditional independence also features strongly in initial model building and in choosing an appropriate parametrization. For example, the linear superposition principle states that any linear combination of deterministic linear models is a linear model. This extends to a normal linear superposition principle:</p>
<p><mark>Any linear combination of independent normal DLMs is a normal DLM.</mark> - &gt; – <span class="citation" data-cites="west2013bayesian">(<a href="references.html#ref-west2013bayesian" role="doc-biblioref">West and Harrison 2013, sec. 3.1</a> p.&nbsp;98)</span></p>
</blockquote>
</div>
</div>
<p>We will illustrate how to do that with an example:</p>
<p>Let’s say that we want to create a model here with a forecast function that has a linear trend component. Let’s say we have a linear function as a function of the number of steps ahead that you want to consider. Then suppose you also have a covariate here that you want to include in your model as a regression component. <span id="eq-superposition-principle-example"><span class="math display">
f_t(h) = \underbrace{(k_{t,0} + k_{t,1}\; h)}_{\text{linear trend component}} + \underbrace{(k_{t,2}\; x_{t+h})}_{\text{regression component}}
\tag{96.31}</span></span></p>
<p>where:</p>
<ul>
<li><span class="math inline">f_t(h)</span> is our forecast function.</li>
<li><span class="math inline">k_{t,0}</span>, <span class="math inline">k_{t,1}</span> and <span class="math inline">k_{t,2}</span> are just constants (that we index using time <span class="math inline">t</span> and a second subscript).</li>
<li><span class="math inline">x_{t+h}</span> is a time dependent regression covariate.</li>
</ul>
<p>When we look at the forecast function, we can isolate a linear trend and a regression components as indicated. Each of these can be set in terms of two forecast functions]{.mark}. I’m going to call the forecast function <span class="math inline">f_{1,t}(h)</span>, this is just the first piece.</p>
<p><span id="eq-superposition-breaking-it-down"><span class="math display">
\begin{aligned}
f_t(h) &amp;= f_{1,t}(h) + f_{2,t}(h) \\
f_{1,t}(h) &amp;= k_{t,0} + k_{t,1} &amp; \text{(linear trend component)} \\
f_{2,t}(h) &amp;= k_{t,2}x_{t+h} &amp; \text{(regression component)}
\end{aligned}
\tag{96.32}</span></span></p>
<p>We know how to represent forecast function <span class="math inline">f_{1,t}</span> and <span class="math inline">f_{2,t}</span> in terms of dynamic linear models.</p>
<p>For the linear trend component, <span class="math inline">f_{1,t}(h)</span> , we have a 2-dimensional state vector, <span class="math inline">\theta_t = (\theta_{t,1}, \theta_{t,2})'</span>, which yields the following DLM shortform:</p>
<p><span id="eq-superposition-linear-trend-short-form"><span class="math display">
\{F_1, G_1, \cdot, \cdot\}  \qquad \text{(short notation)}
\tag{96.33}</span></span></p>
<ul>
<li>Where we don’t explicitly specify the observational and system variances, <span class="math inline">V</span> and <span class="math inline">W</span></li>
<li>The important bit are <span class="math inline">F</span> and <span class="math inline">G</span>. The forecast function is given by:</li>
</ul>
<p><span id="eq-superposition-F1"><span class="math display">
F_{1} = E_2 = (1, 0)'
\tag{96.34}</span></span></p>
<p><span id="eq-superposition-G1"><span class="math display">
G_{1} =
\begin{pmatrix}
1 &amp; 1 \\
0 &amp; 1
\end{pmatrix}
\tag{96.35}</span></span></p>
<p>for the regression component <span class="math inline">f_{2,t}(h)</span> we have the following DLM representation:</p>
<p><span id="eq-superposition-regression-short-form"><span class="math display">
\{F_2,t, G_2, \cdot, \cdot\}  \qquad \text{(short notation)}
\tag{96.36}</span></span></p>
<p>where we have <span class="math inline">F_{2t}</span> is <span class="math inline">X_t</span> and my <span class="math inline">G</span> is simply going to be 1. This is a one-dimensional vector in terms of the state parameter vector.</p>
<p><span id="eq-superposition-F2"><span class="math display">
F_{2,t} = x_{t+h}
\tag{96.37}</span></span></p>
<p><span id="eq-superposition-G2"><span class="math display">
G_{2} = 1
\tag{96.38}</span></span></p>
<p>Once we have these, we can assemble them into our final model. <span class="math inline">\{F_t, G, \cdot, \cdot\}</span></p>
<p>We care more about <span class="math inline">F</span>, <span class="math inline">G</span>, and less about the observational variance and some covariance also for the system where the</p>
<p>F is going to be an F that has, you just concatenate the two Fs. You’re going to get 1, 0 and then you’re going to put the next component here. Again, this one is dependent on time because this component is time dependent and</p>
<p>The model with forecast function <span class="math inline">f_t(h)</span> above is a model with a 3-dimensional state vector with</p>
<p><span class="math display">
F_t = (F_1', F_{2,t})' = (1, 0, x_t)'
</span></p>
<p>Then the G, you can create it just taking a block diagonal structure by concatenating <span class="math inline">G_1</span> and <span class="math inline">G_2</span>. though formally there must be a better term for this operation.</p>
<p><span class="math display">
G = \text{blockdiag}[G_1, G_2] =
\begin{pmatrix}
1 &amp; 1 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1
\end{pmatrix}.
</span></p>
<p>This gives us the full <span class="math inline">G</span> dynamics matrix for the model. A model with this <span class="math inline">F_t</span> and this <span class="math inline">G</span> that is constant over time will give us this particular forecast function <a href="#eq-superposition-principle-example" class="quarto-xref">Equation&nbsp;<span>96.31</span></a> we started with.</p>
<p>We used the superposition principle to build this model. If we need additional components, we will learn how to incorporate seasonal components, regression components, trend components. One can build a fairly sophisticated model with different structures into this particular model using the superposition principle.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Video Transcript
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<!-- transcript of https://www.coursera.org/learn/bayesian-statistics-time-series-analysis/lecture/gh9qW/the-superposition-principle -->
<section id="the-superposition-principle-1" class="level3" data-number="96.6.1">
<h3 data-number="96.6.1" class="anchored" data-anchor-id="the-superposition-principle-1"><span class="header-section-number">96.6.1</span> The superposition principle</h3>
<p>We can use the superposition principle to build models that have different kinds of components. The main idea is to think about what is the general structure we want for the forecast function and then isolate the different components of the forecast function and think about the classes of dynamic linear models that are represented in each of those components. Each of those components has a class and then we can build the general dynamic linear model with all those pieces together using this principle. I will illustrate how to do that with an example. Let’s say that you want to create a model here with a forecast function that has a linear trend component. Let’s say we have a linear function as a function of the number of steps ahead that you want to consider. Then suppose you also have a covariate here that you want to include in your model as a regression component. Let’s say we have a K_t2 and then we have X_t plus h, this is my covariate. Again, the k’s here are just constants, as of constants in terms of h, they are dependent on time here. This is the general structure we want to have for the forecast function. Now you can see that when I look at the forecast function, I can isolate here and separate these two components. I have a component that looks like a linear trend and then I have a component that is a regression component. Each of this can be set in terms of two forecast functions. I’m going to call the forecast function F_1t h, this is just the first piece. Then I have my second piece here. I’m going to call it F_2t, is just this piece here with the regression component. We know how to represent this forecast function in terms of a dynamic linear model. I can write down a model that has an F, G, and some V, and some W that I’m going to just leave here and not specify them explicitly because the important components for the structure of the model are the F and the G. If you’ll recall the F in the case of a forecast function with a linear trend like this, is just my E_2 vector, which is a two-dimensional vector. The first entry is one, and the second one is a zero. Then the G in this case is just this upper triangular matrix that has 1, 1 in the first row and 0, 1 in the second one. Remember, in this case we have a two-dimensional state vector where one of the components in the vector is telling me information about the level of the time series, the other component is telling me about the rate of change in that level. This is a representation that corresponds to this forecast function. For this other forecast function, we have a single covariate, it’s just a regression and I can represent these in terms of an F_2, G_2, and then some observational variance and some system variance here in the case of a single covariate and this one depends on t. We have F_2t is X_t and my G here is simply going to be one. This is a one-dimensional vector in terms of the state parameter vector. We have a single state vector and it’s just going to tell me about the changes, the coefficient that goes with the X_t covariate. Once I have these, I can create my final model and I’m going to just say that my final model is F, G, and then I have some observational variance and some covariance also for the system where the F is going to be an F that has, you just concatenate the two Fs. You’re going to get 1, 0 and then you’re going to put the next component here. Again, this one is dependent on time because this component is time dependent and then the G, you can create it just taking a block diagonal structure, G_1 and G_2. You just put together, the first one is 1, 1, 0, 1 and then I concatenate this one as a block diagonal. This should be one. This gives me the full G function for the model. Now a model with this F_t and this G that is constant over time will give me this particular forecast function. I’m using the superposition principle to build this model. If you want additional components, we will learn how to incorporate seasonal components, regression components, trend components. You can build a fairly sophisticated model with different structures into this particular model using the superposition principle.</p>
</section>
</div>
</div>
</div>
</section>
<section id="superposition-principle-general-case" class="level2" data-number="96.7">
<h2 data-number="96.7" class="anchored" data-anchor-id="superposition-principle-general-case"><span class="header-section-number">96.7</span> Superposition principle: General case 📖</h2>
<p><mark>You can build dynamic models with different components, for example, a trend component plus a regression component, by using the principle of superposition. The idea is to think about the general form of the forecast function you want to have for prediction. You then write that forecast function as a sum of different components where each component corresponds to a class of DLM with its own state-space representation. The final DLM can then be written by combining the pieces of the different components.</mark></p>
<p>For example, suppose you are interested in a model with a forecast function that includes a linear polynomial trend and a single covariate <span class="math inline">x_t</span>, i.e.,</p>
<p><span class="math display">
f_t(h) = k_{t,0} + k_{t,1}h + k_{t,3}x_{t+h}.
</span></p>
<p>This forecast function can be written as <span class="math inline">f_t(h) = f_{1,t}(h) + f_{2,t}(h)</span>, with</p>
<p><span class="math display">
f_{1,t}(h) = (k_{t,0} + k_{t,1}h), \quad f_{2,t}(h) = k_{t,3}x_{t+h}.
</span></p>
<p>The first component in the forecast function corresponds to a model with a 2-dimensional state vector, <span class="math inline">F_{1,t} = F_1 = (1, 0)'</span>,</p>
<p><span class="math display">
G_{1,t} = G_1 =
\begin{pmatrix}
1 &amp; 1 \\
0 &amp; 1
\end{pmatrix}.
</span></p>
<p>The second component corresponds to a model with a 1-dimensional state vector, <span class="math inline">F_{2,t} = x_t</span>, <span class="math inline">G_{2,t} = G_2 = 1</span>.</p>
<p>The model with forecast function <span class="math inline">f_t(h)</span> above is a model with a 3-dimensional state vector with <span class="math inline">F_t = (F_1', F_{2,t})' = (1, 0, x_t)'</span> and</p>
<p><span class="math display">
G_t = \text{blockdiag}[G_1, G_2] =
\begin{pmatrix}
1 &amp; 1 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1
\end{pmatrix}.
</span></p>
<section id="general-case" class="level3" data-number="96.7.1">
<h3 data-number="96.7.1" class="anchored" data-anchor-id="general-case"><span class="header-section-number">96.7.1</span> General Case</h3>
<p>The general case wasn’t covered in the video and we didn’t have a proper statement of the superposition principle. However, in <a href="#imp-superposition" class="quarto-xref">Important&nbsp;<span>96.1</span></a> I extracted the statement of the principle above. This statement clarifies that the principle arises via conditional independence, a tool we also used extensively in the previous course on mixture models. Now let us consider the general case from the handout.</p>
<p>Assume that you have a time series process <span class="math inline">y_t</span> with a forecast function</p>
<p><span class="math display">
f_t(h) = \sum_{i=1}^{m} f_{i,t}(h),
</span></p>
<p>where each <span class="math inline">f_{i,t}(h)</span> is the forecast function of a DLM with representation <span class="math inline">\{F_{i,t}, G_{i,t}, v_{i,t}, W_{i,t}\}</span>.</p>
<p>Then, <span class="math inline">f_t(h)</span> has a DLM representation <span class="math inline">\{F_t, G_t, v_t, W_t\}</span> with</p>
<p><span class="math display">
F_t = (F_{1,t}', F_{2,t}', \dots, F_{m,t}')',
</span></p>
<p><span class="math display">
G_t = \text{blockdiag}[G_{1,t}, \dots, G_{m,t}],
</span></p>
<p><span class="math display">
v_t = \sum_{i=1}^{m} v_{i,t},
</span></p>
<p>and</p>
<p><span class="math display">
W_t = \text{blockdiag}[W_{1,t}, \dots, W_{m,t}].
</span></p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-prado2000bayesian" class="csl-entry" role="listitem">
Prado, Raquel, Gabriel Huerta, and Mike West. 2000. <span>“Bayesian Time-Varying Autoregressions: Theory, Methods and Applications.”</span> <em>Resenhas Do Instituto de Matem<span>á</span>tica e Estat<span>ı́</span>stica Da Universidade de S<span>ã</span>o Paulo</em> 4 (4): 405–22. <a href="https://www2.stat.duke.edu/~mw/MWextrapubs/Prado2001.pdf">https://www2.stat.duke.edu/~mw/MWextrapubs/Prado2001.pdf</a>.
</div>
<div id="ref-prado2023time" class="csl-entry" role="listitem">
Prado, R., M. A. R. Ferreira, and M. West. 2023. <em>Time Series: Modeling, Computation, and Inference</em>. Chapman &amp; Hall/CRC Texts in Statistical Science. CRC Press. <a href="https://books.google.co.il/books?id=pZ6lzgEACAAJ">https://books.google.co.il/books?id=pZ6lzgEACAAJ</a>.
</div>
<div id="ref-west2013bayesian" class="csl-entry" role="listitem">
West, M., and J. Harrison. 2013. <em>Bayesian Forecasting and Dynamic Models</em>. Springer Series in Statistics. Springer New York. <a href="https://books.google.co.il/books?id=NmfaBwAAQBAJ">https://books.google.co.il/books?id=NmfaBwAAQBAJ</a>.
</div>
</div>
</section>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>the state makes it’s appearance<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script type="text/javascript">

// replace cmd keyboard shortcut w/ control on non-Mac platforms
const kPlatformMac = typeof navigator !== 'undefined' ? /Mac/.test(navigator.platform) : false;
if (!kPlatformMac) {
   var kbds = document.querySelectorAll("kbd")
   kbds.forEach(function(kbd) {
      kbd.innerHTML = kbd.innerHTML.replace(/⌘/g, '⌃');
   });
}

// tweak headings in pymd
document.querySelectorAll(".pymd span.co").forEach(el => {
   if (!el.innerText.startsWith("#|")) {
      el.style.fontWeight = 1000;
   }
});

</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
        for (let i=0; i<annoteTargets.length; i++) {
          const annoteTarget = annoteTargets[i];
          const targetCell = annoteTarget.getAttribute("data-target-cell");
          const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
          const contentFn = () => {
            const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            if (content) {
              const tipContent = content.cloneNode(true);
              tipContent.classList.add("code-annotation-tip-content");
              return tipContent.outerHTML;
            }
          }
          const config = {
            allowHTML: true,
            content: contentFn,
            onShow: (instance) => {
              selectCodeLines(instance.reference);
              instance.reference.classList.add('code-annotation-active');
              window.tippy.hideAll();
            },
            onHide: (instance) => {
              unselectCodeLines();
              instance.reference.classList.remove('code-annotation-active');
            },
            maxWidth: 300,
            delay: [50, 0],
            duration: [200, 0],
            offset: [5, 10],
            arrow: true,
            appendTo: function(el) {
              return el.parentElement.parentElement.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'quarto',
            placement: 'right',
            popperOptions: {
              modifiers: [
              {
                name: 'flip',
                options: {
                  flipVariations: false, // true by default
                  allowedAutoPlacements: ['right'],
                  fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                },
              },
              {
                name: 'preventOverflow',
                options: {
                  mainAxis: false,
                  altAxis: false
                }
              }
              ]        
            }      
          };
          window.tippy(annoteTarget, config); 
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./C4-L05-Ex2.html" class="pagination-link" aria-label="Graded Assignment: Bayesian analysis of an EEG dataset using an AR(p) -  M2L5">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">94</span>&nbsp; <span class="chapter-title">Graded Assignment: Bayesian analysis of an EEG dataset using an AR(p) - M2L5</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./C4-L07.html" class="pagination-link" aria-label="Bayesian Inference in the NDLM: Part 1 M3L7">
        <span class="nav-page-text"><span class="chapter-number">96</span>&nbsp; <span class="chapter-title">Bayesian Inference in the NDLM: Part 1 M3L7</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb2" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 2024-11-06</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Normal Dynamic Linear Models, Part 1 - M3L6"</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> Time Series Analysis</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Normal Dynamic Linear Models (NDLMs) are a class of models used for time series analysis that allow for flexible modeling of temporal dependencies."</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">  - Bayesian Statistics</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">  - Time Series</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="an">keywords:</span><span class="co"> </span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">  - Time Series</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">  - Filtering</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">  - Kalman filtering</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">  - Smoothing</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - NDLM</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">  - Normal Dynamic Linear Models</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">  - Polynomial Trend Models</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">  - Regression Models</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co">  - Superposition Principle</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co">  - R code</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="an">fig-caption:</span><span class="co"> Notes about ... Bayesian Statistics</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="an">title-block-banner:</span><span class="co"> images/banner_deep.jpg</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co">The challenge in taking notes in this courses is that the instructors speak out the maths as they go along. I supply the math but I want to extract the non-math parts and put them in the right place. </span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co">--&gt;</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Normal Dynamic Linear Models (NDLMs) are defined and illustrated in this module using several examples Model building based on the forecast function via the superposition principle is explained. Methods for Bayesian filtering, smoothing and forecasting for NDLMs in the case of known observational variances and known system covariance matrices are discussed and illustrated.</span><span class="co">]</span>{.mark}.</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>The Normal Dynamic Linear Model (DLM) is covered  <span class="co">[</span><span class="ot">@prado2023time pp. 117-144</span><span class="co">]</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>:::{.callout-note collapse="true"}</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="fu">## Learning Objectives {.unnumbered}</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[x]</span> Use R for analysis and forecasting of time series using NDLM (case of known observational and system variances) <span class="co">[</span><span class="ot">\#</span><span class="co">](#m3g1)</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[x]</span> Derive the equations to obtain posterior inference and forecasting in the NDLM with known observational and system variances, including the filtering, smoothing and forecasting equations <span class="co">[</span><span class="ot">\#</span><span class="co">](#m3g2)</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[x]</span> Apply the NDLM superposition principle and explain the role of the forecast function <span class="co">[</span><span class="ot">\#</span><span class="co">](#m3g3)</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[x]</span> Define trend and regression normal DLMs <span class="co">[</span><span class="ot">\#</span><span class="co">](#m3g4)</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[x]</span> Explain the general normal dynamic linear model (NDLM) representation <span class="co">[</span><span class="ot">\#</span><span class="co">](#m3g5)</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="fu"># The Normal Dynamic Linear Model: Definition, Model classes &amp;  The Superposition Principle</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>Dynamic Linear Models (DLMs) extend classical linear regression to time-indexed data, introducing dependencies between observations through latent evolving parameters. A Normal DLM (NDLM) assumes Gaussian noise at both observation and system levels, enabling tractable Bayesian inference through the Kalman filter.</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>While superficially complex, NDLMs are conceptually close to linear regression. Instead of I.I.D. observations indexed by $i$, we index data by time $t$ and allow parameters to evolve with time, resulting in a two-level hierarchical model. At the top level is the observation equation. Below this there is the evolution equation(s) that can be understood as a latent state transition model that can capture trends, periodicity, and regression. The evolution equations can have more than one level however we will see that with some work these are summarized into a matrix form.</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>To make things simpler this is demonstrated using a white noise process and then a random walk model. What makes the NDLM somewhat different is that that there are two variance elements at two levels, necessitating learning more parameters. Once we cover these to models the instructor walks us though all the bits and pieces of the notation. Later we will see that we can add trends, periodicity, regression components in a more or less systematic way. However we need to pick and choose these components to get a suitable forecast function. This approach require an intimate familiarity with the data generating process to model.</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>This approach is Bayesian in that we draw our parameters from a multivariate normal and use updating to improve this initial estimate by incorporating the data and we end up with a posterior i.e. we have distributional view of the time series incorporating uncertainties.</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>Additionally we have a number of Bayesian quantities that can be derived from the model, such as </span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the **filtering distribution** that estimates the current state $\mathbb{P}r(\theta_t \mid \mathcal{D}_t)$, </span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the **forecasting distribution** - to predict future observation: $\mathbb{P}r(y_{t+h} \mid \mathcal{D}_t)$, </span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the **smoothing distribution** - retrospective estimate of past state: $\mathbb{P}r(\theta_t \mid \mathcal{D}_{T})\quad t&lt;T$ and </span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the **forecast function** when $F_t=F$ and $\mathbf{G}_t=\mathbf{G}$ $f_t(h)=\mathbb{E}[y_{t+h} \mid \mathcal{D}_{T}] = F'G^h \mathbb{E}[\theta_{t} \mid \mathcal{D}_{T}]$ </span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the usual credible intervals for forecasts and parameter estimates.</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>However the DLM framework is quite flexible and once you understand it it can ve adapted to support features like seasonality using the superposition principle. NDLMs don't need to be non-stationary time series.</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>As far as I cen tell NDLMs are just DLM with their errors distributed normally at the different levels.</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a><span class="fu">## NDLM Definition 🎥</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a><span class="al">![NDLM Motivation](images/m3_0001.png)</span>{.column-margin  group="slides" width="53mm"}</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a><span class="al">![NDLM general form](images/m3_0002.png)</span>{.column-margin  group="slides" width="53mm"}</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a><span class="al">![the forecast function](images/m3_0003.png)</span>{.column-margin  group="slides" width="53mm"}</span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a><span class="co">::: {.callout-caution collapse="true"}</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a><span class="al">###</span><span class="co"> Hard to follow :weary:</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a><span class="co">- I found this video hard to follow. I watched it carefully a number of times and reworked the math and video's transcript. But in the end this and the next two video are more like a summary of the material rather than a motivated development of the models. </span></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a><span class="co">- The text also diverge when it comes to the $F$ in the state space representation equation. In @west2013bayesian it is a matrix and in @prado2023time it is called a vector. In some places it is referenced as a $p \times 1$. As far as I can tell this reflects different state space representation of the model which neither text is particularly clear. </span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a><span class="co">- Although we are give a couple of motivational examples the way they generalize to the NDLM is not as clear as in @west2013bayesian but this text is very verbose and covers much more material.</span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a><span class="co">- @west2013bayesian also discusses how the math relates to more common statistical scenarios and how the model can be adapted to these scenarios e.g. replacing the obs. normal distribution with a t-distribution or a mixture of normals to handle outliers. I.e. see NDLMs as a looser framework with the assumptions of independence and normality as guidelines rather than strict assumptions.</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a><span class="co">In @prado2023time we quickly get a large number of mathematically concise format, that illustrate how NDLMs generalize other time series models. However these examples assume we are sufficiently familiar with this models.</span></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a><span class="co">- The NDLM is also a hierarchical model which we have not looked into in much depth in this specialization. This is another missed opportunity to connect to previous material and deepen our understanding. Particularly as the bayesian formulation should be able to overcome the limitations of the frequentist approach where we need to make strong assumptions on IID of the shocks but in a time series local observations often highly correlated.</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a><span class="co">- NDLM have efficient algorithms for inference and forecasting mostly by using the Kalman filter, again this is not mentioned not is a bayesian formulation presented</span></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a><span class="co">- So I guess the main issue is that the vide just lists lots of equations and does not really without providing a good intuition behind the model.</span></span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a><span class="co">- I hope that with the rest of this and the next lesson we can get a better understanding of the NDLM.</span></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a><span class="co">- I ended up skimming through large portions of [@west2013bayesian] which goes into much greater detail on the NDLM. The first and second polynomial models developed, explained and motivation is clearer. The state space representation is not explained but the model is developed in a more coherent way and this is a good starting point for developing a more intuitive understanding of the NDLMs. The notation in this book is also easier to follow.</span></span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a><span class="co">  - We use $\theta_t$ for the parameters of the vector and \theta_{t,1} and \theta_{t,2} for the first two components of the parameter vector. This continues the convention of greek characters for parameters from the previous courses and many texts. However if the parameters have a clear meaning it much easier to follow math where we use a more descriptive notation and avoid the second subscripts.</span></span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a><span class="co">- The state space representation here is omitted. The $F$ vector or matrix is not really motivates as a latent state space representation.</span></span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a><span class="co">:::</span></span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a><span class="co">--&gt;</span></span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>In this module, <span class="co">[</span><span class="ot">we will motivate and develop a class of models suitable for for analyzing and forecasting **non-stationary time series** called  **normal dynamic linear models** . We will talk about Bayesian inference and forecasting within this class of models and describe model building as well</span><span class="co">]</span>{.mark}. </span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a><span class="fu">### White Noise - A motivating example</span></span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>Let's begin with a very simple model that has no temporal structure, just a mean value with some variation that is: </span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>y_t = \mu + v_t \qquad v_t \overset{\text{iid}}{\sim}  \mathcal{N}(0, \nu) \qquad  \text{(white noise model)}</span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>$$ {#eq-white-noise-model}</span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$y_t$ is the observed time series at time $t$,</span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mu$ is the expected value of $y_t$ this is characteristic we are interested in, </span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\nu_t$ is a white noise process  as usual iid standard normal N(0,1).</span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>If we plot this model we might see the following graph:</span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-NDLM-white-noise</span></span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>V <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> mu <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, V)</span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">xlab =</span> <span class="st">"Time"</span>, <span class="at">ylab =</span> <span class="st">"y"</span>, <span class="at">main =</span> <span class="st">"Model with no temporal structure"</span>)</span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a>For this model the mean of the time series is $\mu$ will be the the expected value of $y_t$, which is $\mu$. And the variance of $y_t$ is $\nu$.</span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">y_t</span><span class="co">]</span> = \mu \qquad \text{and} \qquad \mathbb{V}ar<span class="co">[</span><span class="ot">y_t</span><span class="co">]</span> = \nu \qquad</span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>$$ {#eq-NDLM-mean-variance}</span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a><span class="fu">### A Random walk model with a slowly changing mean</span></span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Next we incorporate some temporal structure, we allow the expected value of the time series, to change over time. To can achieve this, by update the model definition with a $\mu_t$ where the index indicates that it can change at every time step. And let us keep the noise unchanged. i.e. we set it to $\mu_t \in N(0,\nu)$.</span><span class="co">]</span>{.mark}  </span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>We get the following model:</span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>y_t = \mu_t + \nu_t \quad \nu_t \overset{\text{iid}}{\sim} N(0, V) \qquad \text{(radom walk model)}</span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>$$ {#eq-NDLM-model-random-walk}</span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>To complete this we need to also decide how to incorporate the the changes over time in the parameter $\mu_t$. We might consider different options but we should pick the simplest possible to start with. One option is to assume that the expected value of $\mu_t$ is just the expected value of $\mu_{t-1}$ plus some noise. </span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a>We now have that random walk type of structure where $\mu_t$ can be written in terms of $\mu(t-1)$. The expected value of $\mu_t$, we can think of it as $\mu_{t-1} + \text{some noise}$. This error is once again, assumed to be normally distributed random variable centered at zero and with variance $W$. </span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Another assumption that we have made here is that the $\nu_t$ and $\omega_t$, are also independent of each other</span><span class="co">]</span>{.mark}. </span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>putting this together we get:</span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a>y_t &amp;= \mu_t + \nu_t &amp; \nu_t &amp; \overset{\text{iid}}{\sim}  \mathcal{N}(0, V)  &amp; \text{(Observation eq.)} <span class="sc">\\</span></span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a>\mu_t &amp;= \mu_{t-1} + \omega_t  &amp; \omega_t &amp; \overset{\text{iid}}{\sim}  \mathcal{N}(0, W) &amp; \text{(System/evolution eq.)}</span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a>$$ {#eq-random-walk-model-hierarchical}</span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a>With this model, what we are assuming is that the mean level of the series is changing over time. </span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a>Note that this is an example of a **Gaussian or Normal dynamic linear model**. </span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a>NDLMs are a two level hierarchical models where :</span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>At the top is an **observation level equation** relating observations y at time t to some time dependent, (hidden) state parameters and some observation level iid distributed error.</span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>The **system evolution level equation** describes the dynamics of parameters over time and incorporates some system iid distributed error.</span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span><span class="co">[</span><span class="ot">These equations have a linear structure, in the sense that the expected value of y at time t is a linear function of the parameters.</span><span class="co">]</span>{.mark} </span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>We have the **assumption of normality for the noise terms** in both these equations as well as independence within and between levels. </span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true" tabindex="-1"></a>This is our first example. Next we will be discuss the general class of models. Later we will consider how to incorporate different structures into the model, and how to perform Bayesian inference for filtering smoothing and forecasting.</span>
<span id="cb2-185"><a href="#cb2-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-186"><a href="#cb2-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-187"><a href="#cb2-187" aria-hidden="true" tabindex="-1"></a><span class="fu">### General form of the NDLM</span></span>
<span id="cb2-188"><a href="#cb2-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-189"><a href="#cb2-189" aria-hidden="true" tabindex="-1"></a>The general class of dynamic linear models can be written as follows:</span>
<span id="cb2-190"><a href="#cb2-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-191"><a href="#cb2-191" aria-hidden="true" tabindex="-1"></a>We are going to have two equations. One is the so-called observation equation that relates the observations to the parameters in the model, and the notation we are going to use is as follows.</span>
<span id="cb2-192"><a href="#cb2-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-193"><a href="#cb2-193" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb2-194"><a href="#cb2-194" aria-hidden="true" tabindex="-1"></a>y_t &amp;= \vec{F}_t' \vec{\theta}_t   + \nu_t &amp;&amp; \nu_t \overset{\text{iid}}{\sim}  \mathcal{N}(0, V_t) &amp;&amp; \text{(obs)} <span class="sc">\\</span></span>
<span id="cb2-195"><a href="#cb2-195" aria-hidden="true" tabindex="-1"></a>\vec{\theta}_t &amp;= G_t \vec{\theta}_{t-1} + \vec{\omega}_t &amp;&amp; \vec{\omega}_t \overset{\text{iid}}{\sim}  \mathcal{N}(0, W_t) &amp;&amp; \text{(system)}</span>
<span id="cb2-196"><a href="#cb2-196" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb2-197"><a href="#cb2-197" aria-hidden="true" tabindex="-1"></a>$$ {#eq-NDLM-general-form}</span>
<span id="cb2-198"><a href="#cb2-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-199"><a href="#cb2-199" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb2-200"><a href="#cb2-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-201"><a href="#cb2-201" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$y_t$ a univariate observation at time $t$.</span>
<span id="cb2-202"><a href="#cb2-202" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\vec{\theta}_t$ the **state vector** is a k-dimensional vector of unknown parameters at time t.</span>
<span id="cb2-203"><a href="#cb2-203" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\vec{F_t}$ the **observation operator** a $k*1$-dimensional vector at time t that transforms  the **state parameters** into observations.</span>
<span id="cb2-204"><a href="#cb2-204" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\nu_t$ is the observation noise at time t from a Normal distribution with variance $V_t$.</span>
<span id="cb2-205"><a href="#cb2-205" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$G_t$ the **state evolution operator** is a  $k \times k$ matrix (known)</span>
<span id="cb2-206"><a href="#cb2-206" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\omega_t$ the **innovation** or state evolution noise  at time t distributed as $N(0,W_t)$(known)</span>
<span id="cb2-207"><a href="#cb2-207" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the noise at the observation level and the system level are each iid and mutually iid.</span>
<span id="cb2-208"><a href="#cb2-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-209"><a href="#cb2-209" aria-hidden="true" tabindex="-1"></a>We also have the prior distribution for the state vector at time 0:</span>
<span id="cb2-210"><a href="#cb2-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-211"><a href="#cb2-211" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\vec{\theta}_0 \sim N(\vec{m}_0,c_0)$ a prior k-dimensional Normal distribution.</span>
<span id="cb2-212"><a href="#cb2-212" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>$m_0$ the mean in the prior is a k-dimensional vector of means. (known)</span>
<span id="cb2-213"><a href="#cb2-213" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>$c_0$ is the covariance matrix k by k. (known)</span>
<span id="cb2-214"><a href="#cb2-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-215"><a href="#cb2-215" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb2-216"><a href="#cb2-216" aria-hidden="true" tabindex="-1"></a><span class="fu">## Some Thoughts on NDLM the definition {.unnumbered}</span></span>
<span id="cb2-217"><a href="#cb2-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-218"><a href="#cb2-218" aria-hidden="true" tabindex="-1"></a>Q. Why are $F_t$ and $G_t$ a vector and a matrix respectively? </span>
<span id="cb2-219"><a href="#cb2-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-220"><a href="#cb2-220" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; It may helps to think about $F$ and $G$ as follows:</span></span>
<span id="cb2-221"><a href="#cb2-221" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb2-222"><a href="#cb2-222" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $F_t'$ acts as a linear transformation that maps the latent state $\vec{\theta}_t$ into the observation space, of $y$. </span></span>
<span id="cb2-223"><a href="#cb2-223" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb2-224"><a href="#cb2-224" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $G_t$ is a linear transformation that describes how the state vector evolves over time. I like to think about it as a Hidden Markov state transition matrix.</span></span>
<span id="cb2-225"><a href="#cb2-225" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb2-226"><a href="#cb2-226" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; In other words, $F_t$ takes the current hidden state $\theta_t$ and produces an observation $y_t$, while $G_t$ takes the current state and produces the next state.</span></span>
<span id="cb2-227"><a href="#cb2-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-228"><a href="#cb2-228" aria-hidden="true" tabindex="-1"></a>Q. Why is this called a linear model?</span>
<span id="cb2-229"><a href="#cb2-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-230"><a href="#cb2-230" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; This is because both the observation equation is a linear equation that relates the observations to the parameters in the model and the system equation is a linear equation that tells us how the time-varying parameter is going to be changing over time. This is why we call this a linear model.</span></span>
<span id="cb2-231"><a href="#cb2-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-232"><a href="#cb2-232" aria-hidden="true" tabindex="-1"></a>Q. Why are the noise terms $\nu_t$ and $\omega_t$ assumed to be normally distributed?</span>
<span id="cb2-233"><a href="#cb2-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-234"><a href="#cb2-234" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; This is a common assumption in time series analysis. It is a convenient assumption that allows us to perform Bayesian inference and forecasting in a very simple way. And this is why we call this a **normal** dynamic linear model.</span></span>
<span id="cb2-235"><a href="#cb2-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-236"><a href="#cb2-236" aria-hidden="true" tabindex="-1"></a>Q. Isn't this just a hierarchical model?</span>
<span id="cb2-237"><a href="#cb2-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-238"><a href="#cb2-238" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Indeed, this is a hierarchical model. We have a model for the observations and a model for the system level. The system level is changing over time and the observations are related to the system level through the observation equation. And so it is possible to extend this model to more complex structures if we wish to do so by adding another level, etc... However adding more levels leads to extra dynamics that are captured in $G$ without changing the overall framework!</span></span>
<span id="cb2-239"><a href="#cb2-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-240"><a href="#cb2-240" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb2-241"><a href="#cb2-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-242"><a href="#cb2-242" aria-hidden="true" tabindex="-1"></a><span class="fu">### Inference in the NDLM</span></span>
<span id="cb2-243"><a href="#cb2-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-244"><a href="#cb2-244" aria-hidden="true" tabindex="-1"></a>In terms of the inference, there are a few different kinds of densities and quantities that we are interested in:</span>
<span id="cb2-245"><a href="#cb2-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-246"><a href="#cb2-246" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Filtering distribution</span><span class="co">]</span>{.column-margin}  One of the distributions that we are interested in finding is the so-called **filtering distribution**. We may be interested here in finding what is the density of $\theta_t$ *given all the observations that we have up to time* $t$. </span>
<span id="cb2-247"><a href="#cb2-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-248"><a href="#cb2-248" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-249"><a href="#cb2-249" aria-hidden="true" tabindex="-1"></a>\mathcal{D}_t= \{\mathcal{D}_0, y_{1:T}<span class="sc">\}</span> </span>
<span id="cb2-250"><a href="#cb2-250" aria-hidden="true" tabindex="-1"></a>$$ {#eq-NDLM-filtering-distribution}</span>
<span id="cb2-251"><a href="#cb2-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-252"><a href="#cb2-252" aria-hidden="true" tabindex="-1"></a>We will denote information as $\mathcal{D}_t$. Usually, it is all the information we have at time zero (i.e. our prior), coupled with all the data points I have up to time $t$. </span>
<span id="cb2-253"><a href="#cb2-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-254"><a href="#cb2-254" aria-hidden="true" tabindex="-1"></a>Here we conditioning on all the observed quantities and the prior information up to time $t$, and I may be interested in just finding what is the distribution for $\theta_t$. This is called filtering.</span>
<span id="cb2-255"><a href="#cb2-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-256"><a href="#cb2-256" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-257"><a href="#cb2-257" aria-hidden="true" tabindex="-1"></a>\mathbb{P}r(\theta_t \mid \mathcal{D}_t) \qquad \text{filtering distribution}</span>
<span id="cb2-258"><a href="#cb2-258" aria-hidden="true" tabindex="-1"></a>$$ {#eq-NDLM-filtering}</span>
<span id="cb2-259"><a href="#cb2-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-260"><a href="#cb2-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-261"><a href="#cb2-261" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">forecasting distribution</span><span class="co">]</span>{.column-margin}  </span>
<span id="cb2-262"><a href="#cb2-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-263"><a href="#cb2-263" aria-hidden="true" tabindex="-1"></a>Another distribution that is very important in time series analysis is the  forecasting distribution.</span>
<span id="cb2-264"><a href="#cb2-264" aria-hidden="true" tabindex="-1"></a>We may be interested in the distribution of $y{t+h}$? where we consider $h$ lags into the future and we have all the information $\mathcal{D}_t$, up to time t. </span>
<span id="cb2-265"><a href="#cb2-265" aria-hidden="true" tabindex="-1"></a>We want to do a predictions here</span>
<span id="cb2-266"><a href="#cb2-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-267"><a href="#cb2-267" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-268"><a href="#cb2-268" aria-hidden="true" tabindex="-1"></a>\mathbb{P}r(y_{t+h} \mid \mathcal{D}_t) \qquad \text{forecasting distribution}</span>
<span id="cb2-269"><a href="#cb2-269" aria-hidden="true" tabindex="-1"></a>$$ {#eq-NDLM-forecasting-distribution}</span>
<span id="cb2-270"><a href="#cb2-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-271"><a href="#cb2-271" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Smoothing Distribution</span><span class="co">]</span>{.column-margin} Another important quantity or an important set of distributions is what we call the smoothing distribution. Usually, you have a time series, when you get your data, you observe, I don't know, 300 data points. As you go with the filtering, you are going to start from zero all the way to 300 and you're going to update these filtering distributions as you go and move forward. <span class="co">[</span><span class="ot">We may want instead to revisit the parameter at time 10, for example, given that you now have observed all these 300 observations. In that case, you're interested in densities that are of the form. Let's say that you observe capital T in your process and now you are going to revisit that density for $\theta_t$. This is now in the past. Here we assume that $t&lt;T$. This is called **smoothing**.</span><span class="co">]</span>{.mark}</span>
<span id="cb2-272"><a href="#cb2-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-273"><a href="#cb2-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-274"><a href="#cb2-274" aria-hidden="true" tabindex="-1"></a>So you have more observation once you have seen the data. We will talk about how to perform Bayesian inference to obtain all these distributions under this model setting. </span>
<span id="cb2-275"><a href="#cb2-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-276"><a href="#cb2-276" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-277"><a href="#cb2-277" aria-hidden="true" tabindex="-1"></a>\mathbb{P}r(\theta_t \mid \mathcal{D}_T)  \qquad t &lt; T \qquad \text{smoothing distribution}</span>
<span id="cb2-278"><a href="#cb2-278" aria-hidden="true" tabindex="-1"></a>$$ {#eq-NDLM-smoothing-distribution}</span>
<span id="cb2-279"><a href="#cb2-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-280"><a href="#cb2-280" aria-hidden="true" tabindex="-1"></a><span class="fu">### The forecast function for the NDLM </span></span>
<span id="cb2-281"><a href="#cb2-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-282"><a href="#cb2-282" aria-hidden="true" tabindex="-1"></a>In addition to all the structure that we described before and all the densities that we are interested in finding, we also have as usual, the so-called *forecast function*, which instead of being the density is just $\mathbb{E}<span class="co">[</span><span class="ot">y(t+h)\mid \mathcal{D}_t</span><span class="co">]</span>$ i.e. expected value of y at time t given all the information we have before time t. </span>
<span id="cb2-283"><a href="#cb2-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-284"><a href="#cb2-284" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-285"><a href="#cb2-285" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">y(t+h)\mid \mathcal(D_t)</span><span class="co">]</span> = F'_{t+h} G_{t+h} \ldots G_{t+1} \mathbb{E}<span class="co">[</span><span class="ot">\theta_t \mid \mathcal{D}_t</span><span class="co">]</span></span>
<span id="cb2-286"><a href="#cb2-286" aria-hidden="true" tabindex="-1"></a>$$ {#eq-forecast-function-for-NDLM}</span>
<span id="cb2-287"><a href="#cb2-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-288"><a href="#cb2-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-289"><a href="#cb2-289" aria-hidden="true" tabindex="-1"></a>This is the form of the forecast function. </span>
<span id="cb2-290"><a href="#cb2-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-291"><a href="#cb2-291" aria-hidden="true" tabindex="-1"></a>There are particular cases and particular models that we will be discussing in which the $F_t=F$, i.e. constant and also $G_t = G$ is also constant for all t. </span>
<span id="cb2-292"><a href="#cb2-292" aria-hidden="true" tabindex="-1"></a>In these cases, the forecast function can be simplified and written as:</span>
<span id="cb2-293"><a href="#cb2-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-294"><a href="#cb2-294" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-295"><a href="#cb2-295" aria-hidden="true" tabindex="-1"></a>f_t(h) = \mathbb{E}(y_{t+h} \mid D_t) = F'G^h \mathbb{E}(\theta_t \mid \mathcal{D}_t)</span>
<span id="cb2-296"><a href="#cb2-296" aria-hidden="true" tabindex="-1"></a>$$ {#eq-forecast-function-for-NDLM-constant-F-G}</span>
<span id="cb2-297"><a href="#cb2-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-298"><a href="#cb2-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-299"><a href="#cb2-299" aria-hidden="true" tabindex="-1"></a>One thing that we will learn is that the eigen-structure of this matrix is very important to define the form of the forecast function, and it's very important for model building and for adding components into your model. </span>
<span id="cb2-300"><a href="#cb2-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-301"><a href="#cb2-301" aria-hidden="true" tabindex="-1"></a><span class="fu">### NDLM short form notation</span></span>
<span id="cb2-302"><a href="#cb2-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-303"><a href="#cb2-303" aria-hidden="true" tabindex="-1"></a>Finally, just in terms of short notation, we can always write down when we're working with normal dynamic linear models, we may be referring to the model instead of writing the two equations, the system and the observation equation. I can just write all the components that define my model.</span>
<span id="cb2-304"><a href="#cb2-304" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb2-305"><a href="#cb2-305" aria-hidden="true" tabindex="-1"></a><span class="sc">\{</span>F_t, G_t, v_t, W_t<span class="sc">\}</span> </span>
<span id="cb2-306"><a href="#cb2-306" aria-hidden="true" tabindex="-1"></a>$$ {#eq-NDLM-model-shothand-notation}</span>
<span id="cb2-307"><a href="#cb2-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-308"><a href="#cb2-308" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb2-309"><a href="#cb2-309" aria-hidden="true" tabindex="-1"></a><span class="fu">## Video Transcript {.unnumbered}</span></span>
<span id="cb2-310"><a href="#cb2-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-311"><a href="#cb2-311" aria-hidden="true" tabindex="-1"></a>{{&lt; include _C4-L03-T01.qmd &gt;}}</span>
<span id="cb2-312"><a href="#cb2-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-313"><a href="#cb2-313" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb2-314"><a href="#cb2-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-315"><a href="#cb2-315" aria-hidden="true" tabindex="-1"></a><span class="fu">## Polynomial Trend Models 🎥</span></span>
<span id="cb2-316"><a href="#cb2-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-317"><a href="#cb2-317" aria-hidden="true" tabindex="-1"></a><span class="al">![first and second order polynomial model](images/m3_0011.png)</span>{#fig-first-and-second-order-polynomial-model .column-margin  group="slides" width="53mm"}</span>
<span id="cb2-318"><a href="#cb2-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-319"><a href="#cb2-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-320"><a href="#cb2-320" aria-hidden="true" tabindex="-1"></a><span class="al">![p-order polynomial model](images/m3_0012.png)</span>{#fig-p-order-polynomial-model .column-margin  group="slides" width="53mm"}</span>
<span id="cb2-321"><a href="#cb2-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-322"><a href="#cb2-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-323"><a href="#cb2-323" aria-hidden="true" tabindex="-1"></a>While we haven't talked about the superposition principle yet we start at looking at adding different components to the DLM. </span>
<span id="cb2-324"><a href="#cb2-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-325"><a href="#cb2-325" aria-hidden="true" tabindex="-1"></a>We might :</span>
<span id="cb2-326"><a href="#cb2-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-327"><a href="#cb2-327" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>setting a baseline mean and variance</span>
<span id="cb2-328"><a href="#cb2-328" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>adding a random walk with its variance</span>
<span id="cb2-329"><a href="#cb2-329" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>add a trend </span>
<span id="cb2-330"><a href="#cb2-330" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>add a regression </span>
<span id="cb2-331"><a href="#cb2-331" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>add seasonality</span>
<span id="cb2-332"><a href="#cb2-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-333"><a href="#cb2-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-334"><a href="#cb2-334" aria-hidden="true" tabindex="-1"></a>Next we want to extend the random walk model to include different types of trends and this will be covered by the polynomial trend models. <span class="co">[</span><span class="ot">These are models that are useful to model linear trends or polynomial trends in your time series. So if you have a data set, where you have an increasing trend, or a decreasing trend, you would use one of those **components** in your model.</span><span class="co">]</span>{.mark} Also </span>
<span id="cb2-335"><a href="#cb2-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-336"><a href="#cb2-336" aria-hidden="true" tabindex="-1"></a><span class="fu">### First order polynomial model</span></span>
<span id="cb2-337"><a href="#cb2-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-338"><a href="#cb2-338" aria-hidden="true" tabindex="-1"></a>The first order model is developed at great detail in chapter In <span class="co">[</span><span class="ot">@west2013bayesian ch. 2</span><span class="co">]</span>. I don't know what to make of it, isn't this a trivial white noise model?</span>
<span id="cb2-339"><a href="#cb2-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-340"><a href="#cb2-340" aria-hidden="true" tabindex="-1"></a>The math for Bayesian updating is fairly straight forward and must be much more complex with more sophisticated dynamics. So this is used by the authors to introduce their DLM and an 30 pages of the book is dedicated to in depth analysis and Bayesian development of this specific model and different distribution of interests as well as including comparison to other models and a look at the signal to noise ratio in the model.</span>
<span id="cb2-341"><a href="#cb2-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-342"><a href="#cb2-342" aria-hidden="true" tabindex="-1"></a>It is worthwhile pointing out that these models get their name from their forecast function which will takes the general form <span class="co">[</span><span class="ot">@eq-DLM-n-order-polynomial-forecast-function</span><span class="co">]</span></span>
<span id="cb2-343"><a href="#cb2-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-344"><a href="#cb2-344" aria-hidden="true" tabindex="-1"></a>The first order polynomial model is a model that is useful to describe linear trends in your time series. </span>
<span id="cb2-345"><a href="#cb2-345" aria-hidden="true" tabindex="-1"></a>If you have a data set where you have an increasing trend or a decreasing trend, you would use one of those components in your model.</span>
<span id="cb2-346"><a href="#cb2-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-347"><a href="#cb2-347" aria-hidden="true" tabindex="-1"></a>So the all those can be incorporated using the general p-order polynomial model, so I will just describe the form of this model.</span>
<span id="cb2-348"><a href="#cb2-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-349"><a href="#cb2-349" aria-hidden="true" tabindex="-1"></a>A first order polynomial is of the form $Ax+B$ where A is the slope and B is the intercept. This is the same random walk model we saw  above.</span>
<span id="cb2-350"><a href="#cb2-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-351"><a href="#cb2-351" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-352"><a href="#cb2-352" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb2-353"><a href="#cb2-353" aria-hidden="true" tabindex="-1"></a>y_t &amp;= \theta_t + \nu_t, \qquad &amp; \nu_t &amp; \overset{\text{iid}}{\sim}  \mathcal{N}(0, V_t) <span class="sc">\\</span></span>
<span id="cb2-354"><a href="#cb2-354" aria-hidden="true" tabindex="-1"></a>\theta_t &amp;= \theta_{t-1} + \omega_t, \qquad &amp; \omega_t &amp; \overset{\text{iid}}{\sim}  \mathcal{N}(0, W_t) <span class="sc">\\</span></span>
<span id="cb2-355"><a href="#cb2-355" aria-hidden="true" tabindex="-1"></a>&amp;<span class="sc">\{</span>1,1,v_t,W_t<span class="sc">\}</span> &amp;&amp; \text{(short form)} <span class="sc">\\</span></span>
<span id="cb2-356"><a href="#cb2-356" aria-hidden="true" tabindex="-1"></a>f_t(h) &amp;= \mathbb{E}<span class="co">[</span><span class="ot">\theta_t \mid \mathcal{D}_t</span><span class="co">]</span> &amp;&amp; \text{(forecast fn)} <span class="sc">\\</span></span>
<span id="cb2-357"><a href="#cb2-357" aria-hidden="true" tabindex="-1"></a>\end{aligned} </span>
<span id="cb2-358"><a href="#cb2-358" aria-hidden="true" tabindex="-1"></a>$$ {#eq-DLM-first-order-polynomial-model}</span>
<span id="cb2-359"><a href="#cb2-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-360"><a href="#cb2-360" aria-hidden="true" tabindex="-1"></a>In the observation equation, $\theta_{t}$ is the level of the series at time t and $\nu_t$ is the observation error. In the evolution equation we see the mean for this parameter changing over time as a random walk or a local constant mean with evolution noise $\omega_t$.</span>
<span id="cb2-361"><a href="#cb2-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-362"><a href="#cb2-362" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">@west2013bayesian §2.1</span><span class="co">]</span> gives the following representation of the model:</span>
<span id="cb2-363"><a href="#cb2-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-364"><a href="#cb2-364" aria-hidden="true" tabindex="-1"></a>It is useful to think of $\theta_t$ as a smooth function of time $\theta(t)$ with an associated Taylor series representation </span>
<span id="cb2-365"><a href="#cb2-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-366"><a href="#cb2-366" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-367"><a href="#cb2-367" aria-hidden="true" tabindex="-1"></a>\theta(t + \delta t) = \theta(t) + \text{higher-order terms}</span>
<span id="cb2-368"><a href="#cb2-368" aria-hidden="true" tabindex="-1"></a>$$ {#eq-DLM-taylor-series-representation}</span>
<span id="cb2-369"><a href="#cb2-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-370"><a href="#cb2-370" aria-hidden="true" tabindex="-1"></a>where the higher-order terms are assumed to be zero-mean noise. This is a very important point, because it means that we are not trying to model the higher-order terms explicitly, but rather we are assuming that they are just noise.</span>
<span id="cb2-371"><a href="#cb2-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-372"><a href="#cb2-372" aria-hidden="true" tabindex="-1"></a>with the model simply describing the higher-order terms as zero-mean noise.</span>
<span id="cb2-373"><a href="#cb2-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-374"><a href="#cb2-374" aria-hidden="true" tabindex="-1"></a>This is the genesis of the first-order polynomial DLM: the level model is a locally constant (first-order polynomial) proxy for the underlying evolution.·</span>
<span id="cb2-375"><a href="#cb2-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-376"><a href="#cb2-376" aria-hidden="true" tabindex="-1"></a>We can write it down in short form with the following quadruple/</span>
<span id="cb2-377"><a href="#cb2-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-378"><a href="#cb2-378" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-379"><a href="#cb2-379" aria-hidden="true" tabindex="-1"></a><span class="sc">\{</span>1, 1, V_t, W_t<span class="sc">\}</span> \qquad f_t(h) = \mathbb{E}<span class="co">[</span><span class="ot">\theta_t \mid \mathcal{D}_t</span><span class="co">]</span> = k_t \ \forall   h&gt;0</span>
<span id="cb2-380"><a href="#cb2-380" aria-hidden="true" tabindex="-1"></a>$$ {#eq-DLM-1-order-polynomial-model-short}</span>
<span id="cb2-381"><a href="#cb2-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-382"><a href="#cb2-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-383"><a href="#cb2-383" aria-hidden="true" tabindex="-1"></a>Next we can write the forecast function $f_t(h)$ of this model using the representation we gave in  <span class="co">[</span><span class="ot">@eq-DLM-1-order-polynomial-model-short</span><span class="co">]</span>.</span>
<span id="cb2-384"><a href="#cb2-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-385"><a href="#cb2-385" aria-hidden="true" tabindex="-1"></a>Again, we're going to have something of the form $F$ transposed $G$ to the power of h and then the expected value of that $\theta_t$ given $\mathcal{D}_t$. $F$ is 1, $G$ is 1, therefore I'm going to end up having just expected value of $\theta_t$ given $\mathcal{D}_t$.</span>
<span id="cb2-386"><a href="#cb2-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-387"><a href="#cb2-387" aria-hidden="true" tabindex="-1"></a>Which depending on the data that you have is you're just going to have something that is a value that depends on $t$ and it doesn't depend on $h$. What this model is telling you is that the forecast function, how you expect to see future values of the series h steps ahead is something that looks like the level that you estimated at time $t$.</span>
<span id="cb2-388"><a href="#cb2-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-389"><a href="#cb2-389" aria-hidden="true" tabindex="-1"></a><span class="fu">### Second order Polynomial model AKA Linear Growth model</span></span>
<span id="cb2-390"><a href="#cb2-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-391"><a href="#cb2-391" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">@west2013bayesian §7.1-7.2</span><span class="co">]</span> gives a detailed analysis of this model.</span>
<span id="cb2-392"><a href="#cb2-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-393"><a href="#cb2-393" aria-hidden="true" tabindex="-1"></a>Now we want to create a model in which captures things that has a linear trend either increasing or decreasing. To do thus we need to have two components in our parameter vector of the state vector. For this we will need two components in our parameter vector of the **state vector**^<span class="co">[</span><span class="ot">the state makes it's appearance</span><span class="co">]</span>. </span>
<span id="cb2-394"><a href="#cb2-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-395"><a href="#cb2-395" aria-hidden="true" tabindex="-1"></a>So we have again something that looks like in my observation equation. </span>
<span id="cb2-396"><a href="#cb2-396" aria-hidden="true" tabindex="-1"></a>I'm going to have, </span>
<span id="cb2-397"><a href="#cb2-397" aria-hidden="true" tabindex="-1"></a>I'm going to call it say $\theta_{t,1} \sim  \mathcal{N}(v_t)$, and then I'm going to have say $\theta_{t,1}$ is going to be of the form to $\theta_{t-1,1}$ and there is another component here. The other component enters this equation plus let's call this $\theta_{t-1,2}$. And then I have finally also I need an evolution for the second component of the process which is going to be again having a random walk type of behavior.</span>
<span id="cb2-398"><a href="#cb2-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-399"><a href="#cb2-399" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb2-400"><a href="#cb2-400" aria-hidden="true" tabindex="-1"></a>  y_t &amp;= \theta_{t,1} + \nu_t \quad &amp;\nu_t &amp;\overset{\text{iid}}{\sim}  \mathcal{N}(0, v_t) <span class="sc">\\</span></span>
<span id="cb2-401"><a href="#cb2-401" aria-hidden="true" tabindex="-1"></a>  \theta_{t,1} &amp;= \theta_{t-1,1} + \theta_{t-1,2} + \omega_{t,1} \qquad &amp;\omega_{t,1} &amp;\overset{\text{iid}}{\sim}  \mathcal{N}(0, w_{t,11}) <span class="sc">\\</span></span>
<span id="cb2-402"><a href="#cb2-402" aria-hidden="true" tabindex="-1"></a>  \theta_{t,2} &amp;= \theta_{t-1,2} + \omega_{t,2} \qquad &amp;\omega_{t,2} &amp;\overset{\text{iid}}{\sim}  \mathcal{N}(0, w_{t,22})</span>
<span id="cb2-403"><a href="#cb2-403" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb2-404"><a href="#cb2-404" aria-hidden="true" tabindex="-1"></a>$$ {#eq-NDLM-2-order-polynomial-model}</span>
<span id="cb2-405"><a href="#cb2-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-406"><a href="#cb2-406" aria-hidden="true" tabindex="-1"></a>So there are different ways in which you can interpret this two parameters but essentially:</span>
<span id="cb2-407"><a href="#cb2-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-408"><a href="#cb2-408" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\theta_{t-1,1}$ is related to the **baseline** level of the series </span>
<span id="cb2-409"><a href="#cb2-409" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\theta_{t-1,2}$ is related to the **rate of change** of the of the series. </span>
<span id="cb2-410"><a href="#cb2-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-411"><a href="#cb2-411" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip collapse="true"}</span>
<span id="cb2-412"><a href="#cb2-412" aria-hidden="true" tabindex="-1"></a><span class="fu">## Short form DLM notation {.unnumbered}</span></span>
<span id="cb2-413"><a href="#cb2-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-414"><a href="#cb2-414" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Having the short form notation makes the model easier to understand in relation to other DLM models.</span>
<span id="cb2-415"><a href="#cb2-415" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>It will soon be instrumental in communicating the model structure with different software packages.</span>
<span id="cb2-416"><a href="#cb2-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-417"><a href="#cb2-417" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb2-418"><a href="#cb2-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-419"><a href="#cb2-419" aria-hidden="true" tabindex="-1"></a>Next we should summarize this model using the familiar short form DLM representation, which requires a bit of creative algebra.</span>
<span id="cb2-420"><a href="#cb2-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-421"><a href="#cb2-421" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-422"><a href="#cb2-422" aria-hidden="true" tabindex="-1"></a>\mathbf{\theta}_t = (\theta_{t,1}, \theta_{t,2}) \qquad <span class="sc">\{</span>\mathbf{F}, \mathbf{G}, V_t, \mathbf{W}_t<span class="sc">\}</span></span>
<span id="cb2-423"><a href="#cb2-423" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-424"><a href="#cb2-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-425"><a href="#cb2-425" aria-hidden="true" tabindex="-1"></a>First we collect the two variances for the evolution two components into the vector $\utilde{w}_t$ and then assume that this $w_t$ is Normal. Now this is a bi-variate normal.</span>
<span id="cb2-426"><a href="#cb2-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-427"><a href="#cb2-427" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-428"><a href="#cb2-428" aria-hidden="true" tabindex="-1"></a>\utilde{\omega}_t = (\omega_{t,1},\omega_{t,2})' \qquad \utilde{\omega}_t \sim  \mathcal{N}(0,W_t)</span>
<span id="cb2-429"><a href="#cb2-429" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-430"><a href="#cb2-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-431"><a href="#cb2-431" aria-hidden="true" tabindex="-1"></a>So what would be my $F$ and my $G$ in this model? So again my theta vector has two components, thus my $G$, so my $F$ is going to be a two dimensional. We can write down $F$ transposed as the only component that appears at this level is the first component of the vector. </span>
<span id="cb2-432"><a href="#cb2-432" aria-hidden="true" tabindex="-1"></a>I'm going to have 1 and then a zero for $F$ transposed. c.f. <span class="co">[</span><span class="ot">@eq-DLM-2-order-polynomial-model-short-form-simple</span><span class="co">]</span></span>
<span id="cb2-433"><a href="#cb2-433" aria-hidden="true" tabindex="-1"></a>And then my $G$ here if you think about writing down $\theta_t$ times $G$ say the $t-1 + \omega_t$. Then you have that you're $G$ is going to have this form.</span>
<span id="cb2-434"><a href="#cb2-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-435"><a href="#cb2-435" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-436"><a href="#cb2-436" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb2-437"><a href="#cb2-437" aria-hidden="true" tabindex="-1"></a>\mathbf{F} &amp;= (1,0)' &amp; V_t &amp;= v_t <span class="sc">\\</span></span>
<span id="cb2-438"><a href="#cb2-438" aria-hidden="true" tabindex="-1"></a>\mathbf{G} &amp;= </span>
<span id="cb2-439"><a href="#cb2-439" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix} </span>
<span id="cb2-440"><a href="#cb2-440" aria-hidden="true" tabindex="-1"></a>1 &amp; h <span class="sc">\\</span> </span>
<span id="cb2-441"><a href="#cb2-441" aria-hidden="true" tabindex="-1"></a>0 &amp; 1 </span>
<span id="cb2-442"><a href="#cb2-442" aria-hidden="true" tabindex="-1"></a>\end{pmatrix} </span>
<span id="cb2-443"><a href="#cb2-443" aria-hidden="true" tabindex="-1"></a>&amp; \mathbf{W}_t &amp;= </span>
<span id="cb2-444"><a href="#cb2-444" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix} </span>
<span id="cb2-445"><a href="#cb2-445" aria-hidden="true" tabindex="-1"></a>w_{t,11} &amp; 0 <span class="sc">\\</span> </span>
<span id="cb2-446"><a href="#cb2-446" aria-hidden="true" tabindex="-1"></a>0 &amp; w_{t,22} </span>
<span id="cb2-447"><a href="#cb2-447" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}</span>
<span id="cb2-448"><a href="#cb2-448" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb2-449"><a href="#cb2-449" aria-hidden="true" tabindex="-1"></a>$$ {#eq-DLM-2-order-polynomial-model-short-form-simple}</span>
<span id="cb2-450"><a href="#cb2-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-451"><a href="#cb2-451" aria-hidden="true" tabindex="-1"></a>this is the form from the video</span>
<span id="cb2-452"><a href="#cb2-452" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-453"><a href="#cb2-453" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb2-454"><a href="#cb2-454" aria-hidden="true" tabindex="-1"></a>\mathbf{F} &amp;= (1,0)' &amp; V_t &amp;= v_t <span class="sc">\\</span></span>
<span id="cb2-455"><a href="#cb2-455" aria-hidden="true" tabindex="-1"></a>\mathbf{G} &amp;= </span>
<span id="cb2-456"><a href="#cb2-456" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix} 1 &amp; h <span class="sc">\\</span> </span>
<span id="cb2-457"><a href="#cb2-457" aria-hidden="true" tabindex="-1"></a>0 &amp; 1 \end{pmatrix} </span>
<span id="cb2-458"><a href="#cb2-458" aria-hidden="true" tabindex="-1"></a>&amp; \mathbf{W}_t &amp;= </span>
<span id="cb2-459"><a href="#cb2-459" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix} </span>
<span id="cb2-460"><a href="#cb2-460" aria-hidden="true" tabindex="-1"></a>w_{t,11} &amp; w_{t,12} <span class="sc">\\</span> </span>
<span id="cb2-461"><a href="#cb2-461" aria-hidden="true" tabindex="-1"></a>w_{t,21} &amp; w_{t,22} </span>
<span id="cb2-462"><a href="#cb2-462" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}</span>
<span id="cb2-463"><a href="#cb2-463" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb2-464"><a href="#cb2-464" aria-hidden="true" tabindex="-1"></a>$$ {#eq-DLM-2-order-polynomial-model-short-form-complex}</span>
<span id="cb2-465"><a href="#cb2-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-466"><a href="#cb2-466" aria-hidden="true" tabindex="-1"></a>this is the more general form from the handout. Note that in this case we have </span>
<span id="cb2-467"><a href="#cb2-467" aria-hidden="true" tabindex="-1"></a>$w_{t,12}=w_{t,21}$ so there is just one extra parameter.</span>
<span id="cb2-468"><a href="#cb2-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-469"><a href="#cb2-469" aria-hidden="true" tabindex="-1"></a>The lesson videos and the handouts differ in the form $\mathbf{W}_t$. In the lecture we assumed zero covariance but in the handout the covariance was snuck in. This gives us a slightly more general model. The covariance though is symmetric so we get an extra parameter we need to infer and include in the prior. Anyhow I kept the more general form, though in most cases we will keep the off diagonal terms at zero.</span>
<span id="cb2-470"><a href="#cb2-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-471"><a href="#cb2-471" aria-hidden="true" tabindex="-1"></a>So for the first component, I have past values of both components. That's why I have a 1 and 1 here for the second component I only have the past value of the second component. So there is a zero and a 1. So this tells me what is the structure of this second order polynomial. If I think about how to obtain the forecast function for this second order polynomial is going to be very similar to what we did before. So you can write it down as F transposed G to the power of h, expected value of theta t given Dt. Now the expected value is going to be vector also with two components because theta_t is a two dimensional vector. The structure here if you look at what G is G to the power of h going to be a matrix, that is going to look like 1, h, 0 1. When you multiply that matrix time this times this F what you're going to end up having is something that looks like 1 h times this expected value of theta t given Dt. So I can think of two components here, so this gives you a constant on h, this part is not going to depend on h. So I can write this down as k t 11 component multiplied by 1 and then I have another constant, multiplied by h. So you can see what happens now is that your forecast function has the form of a linear polynomial. So it's just a linear function on the number of steps ahead. The slope and the intercept related to that linear function are going to depend on the expected value of, theta_t given the all the information I have up to time t. But essentially is a way to model linear trends. So this is what happens with the second order polynomial model.</span>
<span id="cb2-472"><a href="#cb2-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-473"><a href="#cb2-473" aria-hidden="true" tabindex="-1"></a>As we included linear trends and constant values in the forecast function, we may want to also incorporate other kinds of trends, polynomial trends in the model. So you may want to have a quadratic form, the forecast function or a cubic forecast function as a function of h. </span>
<span id="cb2-474"><a href="#cb2-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-475"><a href="#cb2-475" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-476"><a href="#cb2-476" aria-hidden="true" tabindex="-1"></a>\theta_t = (\theta_{t,1}, \theta_{t,2})' \qquad \mathbf{G} = \mathbf{J}_2(1) \qquad \mathbf{E}_2 = (1, 0)'</span>
<span id="cb2-477"><a href="#cb2-477" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-478"><a href="#cb2-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-479"><a href="#cb2-479" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-480"><a href="#cb2-480" aria-hidden="true" tabindex="-1"></a>\mathbf{G^h} = </span>
<span id="cb2-481"><a href="#cb2-481" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix} </span>
<span id="cb2-482"><a href="#cb2-482" aria-hidden="true" tabindex="-1"></a>1 &amp; h <span class="sc">\\</span> </span>
<span id="cb2-483"><a href="#cb2-483" aria-hidden="true" tabindex="-1"></a>0 &amp; 1 </span>
<span id="cb2-484"><a href="#cb2-484" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}</span>
<span id="cb2-485"><a href="#cb2-485" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-486"><a href="#cb2-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-487"><a href="#cb2-487" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-488"><a href="#cb2-488" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb2-489"><a href="#cb2-489" aria-hidden="true" tabindex="-1"></a>f_t(h) &amp;= F' G^h \mathbb{E}<span class="co">[</span><span class="ot">\theta_t \mid \mathcal{D}_t</span><span class="co">]</span> <span class="sc">\\</span></span>
<span id="cb2-490"><a href="#cb2-490" aria-hidden="true" tabindex="-1"></a>&amp;= (1,h) \mathbb{E}<span class="co">[</span><span class="ot">\theta_{t}\mid D_t</span><span class="co">]</span> <span class="sc">\\</span> </span>
<span id="cb2-491"><a href="#cb2-491" aria-hidden="true" tabindex="-1"></a>&amp;= (1,h)(K_{t,0}, K_{t,1})' <span class="sc">\\</span> </span>
<span id="cb2-492"><a href="#cb2-492" aria-hidden="true" tabindex="-1"></a>&amp;= (K_{t,0} + K_{t,1} h)</span>
<span id="cb2-493"><a href="#cb2-493" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb2-494"><a href="#cb2-494" aria-hidden="true" tabindex="-1"></a>$$ {#eq-second-order-poly-prediction-fn}</span>
<span id="cb2-495"><a href="#cb2-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-496"><a href="#cb2-496" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-497"><a href="#cb2-497" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb2-498"><a href="#cb2-498" aria-hidden="true" tabindex="-1"></a>\mathbf{G^h} &amp;= </span>
<span id="cb2-499"><a href="#cb2-499" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix} </span>
<span id="cb2-500"><a href="#cb2-500" aria-hidden="true" tabindex="-1"></a>1 &amp; h <span class="sc">\\</span> </span>
<span id="cb2-501"><a href="#cb2-501" aria-hidden="true" tabindex="-1"></a>0 &amp; 1 </span>
<span id="cb2-502"><a href="#cb2-502" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}</span>
<span id="cb2-503"><a href="#cb2-503" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb2-504"><a href="#cb2-504" aria-hidden="true" tabindex="-1"></a>$$ {#eq-second-order-poly-Gh}</span>
<span id="cb2-505"><a href="#cb2-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-506"><a href="#cb2-506" aria-hidden="true" tabindex="-1"></a><span class="fu">### General p-th order polynomial model </span></span>
<span id="cb2-507"><a href="#cb2-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-508"><a href="#cb2-508" aria-hidden="true" tabindex="-1"></a>We can consider a so called p-th order polynomial model. This model will have a state-space vector of dimension p and a polynomial of order $p − 1$ forecast function on $h$. The model can be written as</span>
<span id="cb2-509"><a href="#cb2-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-510"><a href="#cb2-510" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-511"><a href="#cb2-511" aria-hidden="true" tabindex="-1"></a><span class="sc">\{</span>E_p, J_p(1), v_t, W_t<span class="sc">\}</span></span>
<span id="cb2-512"><a href="#cb2-512" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-513"><a href="#cb2-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-514"><a href="#cb2-514" aria-hidden="true" tabindex="-1"></a>with $F_t = E_p = (1, 0, \ldots, 0)′$ and $G_t = J_p(1)$, with</span>
<span id="cb2-515"><a href="#cb2-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-516"><a href="#cb2-516" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-517"><a href="#cb2-517" aria-hidden="true" tabindex="-1"></a>J_p(1) = \begin{pmatrix}</span>
<span id="cb2-518"><a href="#cb2-518" aria-hidden="true" tabindex="-1"></a>1 &amp; 1 &amp; 0 &amp; \cdots &amp; 0 &amp; 0  <span class="sc">\\</span></span>
<span id="cb2-519"><a href="#cb2-519" aria-hidden="true" tabindex="-1"></a>0 &amp; 1 &amp; 1 &amp; \cdots &amp; 0 &amp; 0  <span class="sc">\\</span></span>
<span id="cb2-520"><a href="#cb2-520" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 1 &amp; \cdots &amp; 0 &amp; 0 <span class="sc">\\</span></span>
<span id="cb2-521"><a href="#cb2-521" aria-hidden="true" tabindex="-1"></a>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots <span class="sc">\\</span></span>
<span id="cb2-522"><a href="#cb2-522" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 0 &amp; \cdots &amp; 1 &amp; 1 <span class="sc">\\</span></span>
<span id="cb2-523"><a href="#cb2-523" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 1</span>
<span id="cb2-524"><a href="#cb2-524" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}</span>
<span id="cb2-525"><a href="#cb2-525" aria-hidden="true" tabindex="-1"></a>$$ {#eq-Jordan-form-dynamics}</span>
<span id="cb2-526"><a href="#cb2-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-527"><a href="#cb2-527" aria-hidden="true" tabindex="-1"></a>The forecast function is given by</span>
<span id="cb2-528"><a href="#cb2-528" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-529"><a href="#cb2-529" aria-hidden="true" tabindex="-1"></a>f_t(k) = a_{t_0} +  a_{t_1}k + \ldots + a_{t_{n-1}} k^{n-1} \qquad k \in \mathbb{N}</span>
<span id="cb2-530"><a href="#cb2-530" aria-hidden="true" tabindex="-1"></a>$$ {#eq-DLM-n-order-polynomial-forecast-function}</span>
<span id="cb2-531"><a href="#cb2-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-532"><a href="#cb2-532" aria-hidden="true" tabindex="-1"></a>where $a_{t_i}$ are the coefficients of the polynomial and $k$ is the number of steps ahead we need in our forecast. There is also an alternative parameterization of this model that leads to the same algebraic form of the forecast function given by $<span class="sc">\{</span>Ep, Lp, vt, W t<span class="sc">\}</span>$, with</span>
<span id="cb2-533"><a href="#cb2-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-534"><a href="#cb2-534" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-535"><a href="#cb2-535" aria-hidden="true" tabindex="-1"></a>L_p = \begin{pmatrix}</span>
<span id="cb2-536"><a href="#cb2-536" aria-hidden="true" tabindex="-1"></a>1 &amp; 1 &amp; 1 &amp; \cdots &amp; 1 &amp; 1  <span class="sc">\\</span></span>
<span id="cb2-537"><a href="#cb2-537" aria-hidden="true" tabindex="-1"></a>0 &amp; 1 &amp; 1 &amp; \cdots &amp; 1 &amp; 1   <span class="sc">\\</span></span>
<span id="cb2-538"><a href="#cb2-538" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 1 &amp; \cdots &amp; 1 &amp; 1 <span class="sc">\\</span></span>
<span id="cb2-539"><a href="#cb2-539" aria-hidden="true" tabindex="-1"></a>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots <span class="sc">\\</span></span>
<span id="cb2-540"><a href="#cb2-540" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 0 &amp; \cdots &amp; 1 &amp; 1 <span class="sc">\\</span></span>
<span id="cb2-541"><a href="#cb2-541" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 1</span>
<span id="cb2-542"><a href="#cb2-542" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}</span>
<span id="cb2-543"><a href="#cb2-543" aria-hidden="true" tabindex="-1"></a>$$ {#eq-triangular-form-dynamics}</span>
<span id="cb2-544"><a href="#cb2-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-545"><a href="#cb2-545" aria-hidden="true" tabindex="-1"></a>And in this type of model, the forecast function is going to have order $p-1$. So the parameter vector is going to have dimension $p$. So you're going to have $\theta_t =  \theta_{t1:p}$.</span>
<span id="cb2-546"><a href="#cb2-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-547"><a href="#cb2-547" aria-hidden="true" tabindex="-1"></a>The observation operator $F$ is just a constant and if we write it as a row vector we get $F'$ as a p-dimensional vector with the one in the first entry and zeros everywhere else.</span>
<span id="cb2-548"><a href="#cb2-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-549"><a href="#cb2-549" aria-hidden="true" tabindex="-1"></a>The dynamics  matrix $G$ may be written using either a $J$ Jordan form @eq-Jordan-form-dynamics or as a triangular form @eq-triangular-form-dynamics. These result in different parameterization of this model and we  will talk a little bit about this. </span>
<span id="cb2-550"><a href="#cb2-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-551"><a href="#cb2-551" aria-hidden="true" tabindex="-1"></a>In the @eq-Jordan-form-dynamics we have a matrix with ones on the diagonal and the super diagonal, the matrix is needs to be $p \times p$ i.e. with dimension $p$ to be compatible with the dimension of the hidden state vector $\theta$. So this matrix $G$ is what we call a Jordan block of dimension p of 1. So here 1 is the number that appears in the diagonal. And then I have a p $I_p$ matrix, I have ones in the upper diagonal part. So this is the form of the model, so once again I have the $F$ the $G$, and the $W_t$. I have my model. </span>
<span id="cb2-552"><a href="#cb2-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-553"><a href="#cb2-553" aria-hidden="true" tabindex="-1"></a>The forecast function in this case again can be written as $F' G^h \mathbb{E}<span class="co">[</span><span class="ot">\theta_t \mid \mathcal{D}_t</span><span class="co">]</span>$. And when you simplify times expected value of $\theta_t$, given $D_t$. Once you simplify those functions you get something that is a polynomial of order $p-1$ in $h$. So I just can write this down as $k_t + k_{t,1} h + k_{t, p-1} h^{p-1}$, so that's my forecast function. </span>
<span id="cb2-554"><a href="#cb2-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-555"><a href="#cb2-555" aria-hidden="true" tabindex="-1"></a>There is an alternative parameterization of this model that has the same $F$ and the same algebraic form of the forecast function, the same form of the forecast function. But instead of using @eq-Jordan-form-dynamics form of the $G$ matrix, it has a @eq-triangular-form-dynamics form that has ones in the diagonal and ones everywhere above the diagonal. So it's an upper triangular matrix with ones in the diagonal and above the diagonal. That's a different parameterization of the same model but it leads to the same general form of the forecast function just with a different parameterization. </span>
<span id="cb2-556"><a href="#cb2-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-557"><a href="#cb2-557" aria-hidden="true" tabindex="-1"></a>So again, we can consider the way you think about these models?</span>
<span id="cb2-558"><a href="#cb2-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-559"><a href="#cb2-559" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is you think what kind of forecast function makes sense here ? </span>
<span id="cb2-560"><a href="#cb2-560" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is the type of predictions that I expect to have in my model? </span>
<span id="cb2-561"><a href="#cb2-561" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If they look like a linear trend, I use a second order polynomial. </span>
<span id="cb2-562"><a href="#cb2-562" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If it looks like a quadratic trend in the forecast then I would use 3rd order polynomial model representation.</span>
<span id="cb2-563"><a href="#cb2-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-564"><a href="#cb2-564" aria-hidden="true" tabindex="-1"></a>Note that the third order polynomial model is covered in </span>
<span id="cb2-565"><a href="#cb2-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-566"><a href="#cb2-566" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb2-567"><a href="#cb2-567" aria-hidden="true" tabindex="-1"></a><span class="fu">## Video Transcript {.unnumbered}</span></span>
<span id="cb2-568"><a href="#cb2-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-569"><a href="#cb2-569" aria-hidden="true" tabindex="-1"></a>{{&lt; include _C4-L03-T02.qmd &gt;}}</span>
<span id="cb2-570"><a href="#cb2-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-571"><a href="#cb2-571" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb2-572"><a href="#cb2-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-573"><a href="#cb2-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-574"><a href="#cb2-574" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary of polynomial trend  models 📖</span></span>
<span id="cb2-575"><a href="#cb2-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-576"><a href="#cb2-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-577"><a href="#cb2-577" aria-hidden="true" tabindex="-1"></a><span class="fu">### Polynomial Trend Models</span></span>
<span id="cb2-578"><a href="#cb2-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-579"><a href="#cb2-579" aria-hidden="true" tabindex="-1"></a><span class="fu">#### First-Order Polynomial</span></span>
<span id="cb2-580"><a href="#cb2-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-581"><a href="#cb2-581" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-582"><a href="#cb2-582" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb2-583"><a href="#cb2-583" aria-hidden="true" tabindex="-1"></a>y_t &amp;= \mu_t + \nu_t, \qquad &amp; \nu_t &amp;\sim  \mathcal{N}(0, v_t) <span class="sc">\\</span></span>
<span id="cb2-584"><a href="#cb2-584" aria-hidden="true" tabindex="-1"></a>\mu_t &amp;= \mu_{t-1} + \omega_t, \qquad &amp; \omega_t &amp;\sim  \mathcal{N}(0, w_t)</span>
<span id="cb2-585"><a href="#cb2-585" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb2-586"><a href="#cb2-586" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-587"><a href="#cb2-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-588"><a href="#cb2-588" aria-hidden="true" tabindex="-1"></a>In this case, we have:</span>
<span id="cb2-589"><a href="#cb2-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-590"><a href="#cb2-590" aria-hidden="true" tabindex="-1"></a>$\theta_t = \mu_t \quad \forall t$</span>
<span id="cb2-591"><a href="#cb2-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-592"><a href="#cb2-592" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-593"><a href="#cb2-593" aria-hidden="true" tabindex="-1"></a>F_t = 1 \quad \forall t \qquad G_t = 1 \quad \forall t</span>
<span id="cb2-594"><a href="#cb2-594" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-595"><a href="#cb2-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-596"><a href="#cb2-596" aria-hidden="true" tabindex="-1"></a>resulting in:</span>
<span id="cb2-597"><a href="#cb2-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-598"><a href="#cb2-598" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-599"><a href="#cb2-599" aria-hidden="true" tabindex="-1"></a><span class="sc">\{</span>1, 1, v_t, w_t<span class="sc">\}</span> \qquad \text{(short notation)}</span>
<span id="cb2-600"><a href="#cb2-600" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-601"><a href="#cb2-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-602"><a href="#cb2-602" aria-hidden="true" tabindex="-1"></a>The forecast function is:</span>
<span id="cb2-603"><a href="#cb2-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-604"><a href="#cb2-604" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-605"><a href="#cb2-605" aria-hidden="true" tabindex="-1"></a>f_t(h) = E(\mu_t \mid \mathcal{D}_t) = k_t, \quad \forall h &gt; 0.</span>
<span id="cb2-606"><a href="#cb2-606" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-607"><a href="#cb2-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-608"><a href="#cb2-608" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Second-Order Polynomial</span></span>
<span id="cb2-609"><a href="#cb2-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-610"><a href="#cb2-610" aria-hidden="true" tabindex="-1"></a>$$\begin{aligned}</span>
<span id="cb2-611"><a href="#cb2-611" aria-hidden="true" tabindex="-1"></a>  y_t &amp;= \theta_{t,1} + \nu_t, \quad &amp;\nu_t &amp;\sim  \mathcal{N}(0, v_t) <span class="sc">\\</span></span>
<span id="cb2-612"><a href="#cb2-612" aria-hidden="true" tabindex="-1"></a>  \theta_{t,1} &amp;= \theta_{t-1,1} + \theta_{t-1,2} + \omega_{t,1}, \qquad &amp;\omega_{t,1} &amp;\sim  \mathcal{N}(0, w_{t,11}) <span class="sc">\\</span></span>
<span id="cb2-613"><a href="#cb2-613" aria-hidden="true" tabindex="-1"></a>  \theta_{t,2} &amp;= \theta_{t-1,2} + \omega_{t,2}, \qquad &amp;\omega_{t,2} &amp;\sim  \mathcal{N}(0, w_{t,22}),</span>
<span id="cb2-614"><a href="#cb2-614" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb2-615"><a href="#cb2-615" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-616"><a href="#cb2-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-617"><a href="#cb2-617" aria-hidden="true" tabindex="-1"></a>where we can also have:</span>
<span id="cb2-618"><a href="#cb2-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-619"><a href="#cb2-619" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-620"><a href="#cb2-620" aria-hidden="true" tabindex="-1"></a>\mathbb{C}ov(\theta_{t,1}, \theta_{t,2} ) = w_{t,12} = w_{t,21}</span>
<span id="cb2-621"><a href="#cb2-621" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-622"><a href="#cb2-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-623"><a href="#cb2-623" aria-hidden="true" tabindex="-1"></a>This can be written as a DLM with the state-space vector $\theta_t = (\theta_{t,1}, \theta_{t,2})'$, and </span>
<span id="cb2-624"><a href="#cb2-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-625"><a href="#cb2-625" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-626"><a href="#cb2-626" aria-hidden="true" tabindex="-1"></a><span class="sc">\{</span>\mathbf{F}, \mathbf{G}, v_t, \mathbf{W}_t<span class="sc">\}</span>  \qquad \text{(short notation)}</span>
<span id="cb2-627"><a href="#cb2-627" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb2-628"><a href="#cb2-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-629"><a href="#cb2-629" aria-hidden="true" tabindex="-1"></a>with $\mathbf{F} = (1, 0)'$ and </span>
<span id="cb2-630"><a href="#cb2-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-631"><a href="#cb2-631" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-632"><a href="#cb2-632" aria-hidden="true" tabindex="-1"></a>\mathbf{G} = </span>
<span id="cb2-633"><a href="#cb2-633" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb2-634"><a href="#cb2-634" aria-hidden="true" tabindex="-1"></a>1 &amp; 1 <span class="sc">\\</span></span>
<span id="cb2-635"><a href="#cb2-635" aria-hidden="true" tabindex="-1"></a>0 &amp; 1</span>
<span id="cb2-636"><a href="#cb2-636" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}, \quad \mathbf{W}_t = </span>
<span id="cb2-637"><a href="#cb2-637" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb2-638"><a href="#cb2-638" aria-hidden="true" tabindex="-1"></a>w_{t,11} &amp; w_{t,12} <span class="sc">\\</span></span>
<span id="cb2-639"><a href="#cb2-639" aria-hidden="true" tabindex="-1"></a>w_{t,21} &amp; w_{t,22}</span>
<span id="cb2-640"><a href="#cb2-640" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}.</span>
<span id="cb2-641"><a href="#cb2-641" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-642"><a href="#cb2-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-643"><a href="#cb2-643" aria-hidden="true" tabindex="-1"></a>Note that </span>
<span id="cb2-644"><a href="#cb2-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-645"><a href="#cb2-645" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-646"><a href="#cb2-646" aria-hidden="true" tabindex="-1"></a>\mathbf{G}^2 = </span>
<span id="cb2-647"><a href="#cb2-647" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb2-648"><a href="#cb2-648" aria-hidden="true" tabindex="-1"></a>1 &amp; 2 <span class="sc">\\</span></span>
<span id="cb2-649"><a href="#cb2-649" aria-hidden="true" tabindex="-1"></a>0 &amp; 1</span>
<span id="cb2-650"><a href="#cb2-650" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}, \quad \mathbf{G}^h = </span>
<span id="cb2-651"><a href="#cb2-651" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb2-652"><a href="#cb2-652" aria-hidden="true" tabindex="-1"></a>1 &amp; h <span class="sc">\\</span></span>
<span id="cb2-653"><a href="#cb2-653" aria-hidden="true" tabindex="-1"></a>0 &amp; 1</span>
<span id="cb2-654"><a href="#cb2-654" aria-hidden="true" tabindex="-1"></a>\end{pmatrix},</span>
<span id="cb2-655"><a href="#cb2-655" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-656"><a href="#cb2-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-657"><a href="#cb2-657" aria-hidden="true" tabindex="-1"></a>and so:</span>
<span id="cb2-658"><a href="#cb2-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-659"><a href="#cb2-659" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-660"><a href="#cb2-660" aria-hidden="true" tabindex="-1"></a>f_t(h) = (1, h) E(\mathbf{\theta}_t \mid \mathcal{D}_t) = (1, h) (k_{t,0}, k_{t,1})' = (k_{t,0} + h k_{t,1}).</span>
<span id="cb2-661"><a href="#cb2-661" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-662"><a href="#cb2-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-663"><a href="#cb2-663" aria-hidden="true" tabindex="-1"></a>Here $\mathbf{G} = \mathbf{J}_2(1)$ (see below). </span>
<span id="cb2-664"><a href="#cb2-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-665"><a href="#cb2-665" aria-hidden="true" tabindex="-1"></a>Also, we denote $\mathbf{E}_2 = (1, 0)'$, and so the short notation for this model is </span>
<span id="cb2-666"><a href="#cb2-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-667"><a href="#cb2-667" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-668"><a href="#cb2-668" aria-hidden="true" tabindex="-1"></a><span class="sc">\{</span>E_2, J_2(1), \cdot, \cdot<span class="sc">\}</span></span>
<span id="cb2-669"><a href="#cb2-669" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-670"><a href="#cb2-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-671"><a href="#cb2-671" aria-hidden="true" tabindex="-1"></a><span class="fu">#### General $p$-th Order Polynomial Model</span></span>
<span id="cb2-672"><a href="#cb2-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-673"><a href="#cb2-673" aria-hidden="true" tabindex="-1"></a>We can consider a $p$-th order polynomial model. This model will have a state-space vector of dimension $p$ and a polynomial of order $p-1$ forecast function on $h$. The model can be written as </span>
<span id="cb2-674"><a href="#cb2-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-675"><a href="#cb2-675" aria-hidden="true" tabindex="-1"></a>$$<span class="sc">\{</span>E_p, J_p(1), v_t, W_t<span class="sc">\}</span>  \qquad \text{(short notation)}</span>
<span id="cb2-676"><a href="#cb2-676" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-677"><a href="#cb2-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-678"><a href="#cb2-678" aria-hidden="true" tabindex="-1"></a>with $\mathbf{F}_t = \mathbf{E}_p = (1, 0, \dots, 0)'$ and $\mathbf{G}_t = \mathbf{J}_p(1)$, with</span>
<span id="cb2-679"><a href="#cb2-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-680"><a href="#cb2-680" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-681"><a href="#cb2-681" aria-hidden="true" tabindex="-1"></a>\mathbf{J}_p(1) =</span>
<span id="cb2-682"><a href="#cb2-682" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb2-683"><a href="#cb2-683" aria-hidden="true" tabindex="-1"></a>1 &amp; 1 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 &amp; 0 <span class="sc">\\</span></span>
<span id="cb2-684"><a href="#cb2-684" aria-hidden="true" tabindex="-1"></a>0 &amp; 1 &amp; 1 &amp; \cdots &amp; 0 &amp; 0 &amp; 0 <span class="sc">\\</span></span>
<span id="cb2-685"><a href="#cb2-685" aria-hidden="true" tabindex="-1"></a>\vdots &amp; \vdots &amp; \ddots &amp; \ddots &amp; &amp; \vdots <span class="sc">\\</span></span>
<span id="cb2-686"><a href="#cb2-686" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 1 &amp; 1 <span class="sc">\\</span></span>
<span id="cb2-687"><a href="#cb2-687" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 &amp; 1</span>
<span id="cb2-688"><a href="#cb2-688" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}.</span>
<span id="cb2-689"><a href="#cb2-689" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-690"><a href="#cb2-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-691"><a href="#cb2-691" aria-hidden="true" tabindex="-1"></a>The forecast function is given by</span>
<span id="cb2-692"><a href="#cb2-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-693"><a href="#cb2-693" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-694"><a href="#cb2-694" aria-hidden="true" tabindex="-1"></a>f_t(h) = k_{t,0} + k_{t,1} h + \dots + k_{t,p-1} h^{p-1}.</span>
<span id="cb2-695"><a href="#cb2-695" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-696"><a href="#cb2-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-697"><a href="#cb2-697" aria-hidden="true" tabindex="-1"></a>There is also an alternative parameterization of this model that leads to the same algebraic form of the forecast function, given by $<span class="sc">\{</span>E_p, L_p, v_t, W_t<span class="sc">\}</span>$, with</span>
<span id="cb2-698"><a href="#cb2-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-699"><a href="#cb2-699" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-700"><a href="#cb2-700" aria-hidden="true" tabindex="-1"></a>L_p =</span>
<span id="cb2-701"><a href="#cb2-701" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb2-702"><a href="#cb2-702" aria-hidden="true" tabindex="-1"></a>1 &amp; 1 &amp; 1 &amp; \cdots &amp; 1 <span class="sc">\\</span></span>
<span id="cb2-703"><a href="#cb2-703" aria-hidden="true" tabindex="-1"></a>0 &amp; 1 &amp; 1 &amp; \cdots &amp; 1 <span class="sc">\\</span></span>
<span id="cb2-704"><a href="#cb2-704" aria-hidden="true" tabindex="-1"></a>\vdots &amp; \vdots &amp; \ddots &amp; \ddots &amp; \vdots <span class="sc">\\</span></span>
<span id="cb2-705"><a href="#cb2-705" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 0 &amp; \cdots &amp; 1</span>
<span id="cb2-706"><a href="#cb2-706" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}.</span>
<span id="cb2-707"><a href="#cb2-707" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-708"><a href="#cb2-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-709"><a href="#cb2-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-710"><a href="#cb2-710" aria-hidden="true" tabindex="-1"></a><span class="fu">## Regression models 🎥</span></span>
<span id="cb2-711"><a href="#cb2-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-712"><a href="#cb2-712" aria-hidden="true" tabindex="-1"></a><span class="al">![Regression models](images/m3_0021.png)</span>{.column-margin  group="slides" width="53mm"}</span>
<span id="cb2-713"><a href="#cb2-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-714"><a href="#cb2-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-715"><a href="#cb2-715" aria-hidden="true" tabindex="-1"></a><span class="fu">### Simple dynamic regression</span></span>
<span id="cb2-716"><a href="#cb2-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-717"><a href="#cb2-717" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-718"><a href="#cb2-718" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb2-719"><a href="#cb2-719" aria-hidden="true" tabindex="-1"></a>y_t &amp;= \beta_{t,0} + \beta_{t,1}x_t + ν_t <span class="sc">\\</span></span>
<span id="cb2-720"><a href="#cb2-720" aria-hidden="true" tabindex="-1"></a>\beta_{t,0} &amp;= \beta_{t−1,0} + \omega_{t,0} <span class="sc">\\</span></span>
<span id="cb2-721"><a href="#cb2-721" aria-hidden="true" tabindex="-1"></a>\beta_{t,1} &amp;= \beta_{t−1,1} + \omega_{t,1}</span>
<span id="cb2-722"><a href="#cb2-722" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb2-723"><a href="#cb2-723" aria-hidden="true" tabindex="-1"></a>$$ {#eq-simple-dynamic-regression}</span>
<span id="cb2-724"><a href="#cb2-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-725"><a href="#cb2-725" aria-hidden="true" tabindex="-1"></a>and so $\theta_t = (\beta_t,0, \beta_{t,1})′$, $F_t = (1, x_t)′$ and $G = I_2$. </span>
<span id="cb2-726"><a href="#cb2-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-727"><a href="#cb2-727" aria-hidden="true" tabindex="-1"></a>This results in a forecast function of the form </span>
<span id="cb2-728"><a href="#cb2-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-729"><a href="#cb2-729" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-730"><a href="#cb2-730" aria-hidden="true" tabindex="-1"></a>f_t(h) = k_{t,0} + k_{t,1}x_{t+h}</span>
<span id="cb2-731"><a href="#cb2-731" aria-hidden="true" tabindex="-1"></a>$$ {#eq-simple-dynamic-regression-forecast-function}</span>
<span id="cb2-732"><a href="#cb2-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-733"><a href="#cb2-733" aria-hidden="true" tabindex="-1"></a>where $k_{t,0} = \mathbb{E}<span class="co">[</span><span class="ot">\beta_{t,0} \mid \mathcal{D}_t</span><span class="co">]</span>$ and $k_{t,1} = \mathbb{E}<span class="co">[</span><span class="ot">\beta_{t,1} \mid \mathcal{D}_t</span><span class="co">]</span>$.</span>
<span id="cb2-734"><a href="#cb2-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-735"><a href="#cb2-735" aria-hidden="true" tabindex="-1"></a><span class="fu">### General dynamic regression</span></span>
<span id="cb2-736"><a href="#cb2-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-737"><a href="#cb2-737" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-738"><a href="#cb2-738" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb2-739"><a href="#cb2-739" aria-hidden="true" tabindex="-1"></a>y_t &amp;= \beta_{t,0} + \beta_{t,1}x_{t,1} + \ldots \beta_{t,M} x_{t,M} + ν_t <span class="sc">\\</span></span>
<span id="cb2-740"><a href="#cb2-740" aria-hidden="true" tabindex="-1"></a>\beta_{t,m} &amp;= \beta_{t−1,m} + \omega_{t,m,} &amp; m = 0 : M.</span>
<span id="cb2-741"><a href="#cb2-741" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb2-742"><a href="#cb2-742" aria-hidden="true" tabindex="-1"></a>$$ {#eq-regression-in-short-form}</span>
<span id="cb2-743"><a href="#cb2-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-744"><a href="#cb2-744" aria-hidden="true" tabindex="-1"></a>Then, $\theta = (\beta_t,0, \ldots , \beta_{t,M} )′$, $F_t = (1, x_{t,1}, \ldots , x_{t,M} )′$ and $G = I_M$ . The forecast</span>
<span id="cb2-745"><a href="#cb2-745" aria-hidden="true" tabindex="-1"></a>function is given by</span>
<span id="cb2-746"><a href="#cb2-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-747"><a href="#cb2-747" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-748"><a href="#cb2-748" aria-hidden="true" tabindex="-1"></a>f_t(h) = k_{t,0} + k_{t,1}x_{t+h,1} + \ldots + k_{t+h,M}x_{t+h,M}</span>
<span id="cb2-749"><a href="#cb2-749" aria-hidden="true" tabindex="-1"></a>$$ {#eq-gen-regression-forecast-function}</span>
<span id="cb2-750"><a href="#cb2-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-751"><a href="#cb2-751" aria-hidden="true" tabindex="-1"></a>A particular case is of dynamic regressions is the case of time-varying auto-regressions (TVAR) with</span>
<span id="cb2-752"><a href="#cb2-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-753"><a href="#cb2-753" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-754"><a href="#cb2-754" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb2-755"><a href="#cb2-755" aria-hidden="true" tabindex="-1"></a>y_t &amp;= \varphi_{t,1}y_{t−1} + \varphi_{t,2}y_{t−2} + \ldots + \varphi_{t,p} y_{t−p} + ν_t,<span class="sc">\\</span></span>
<span id="cb2-756"><a href="#cb2-756" aria-hidden="true" tabindex="-1"></a>\varphi_{t,m} &amp;= \varphi_{t−1,m} + \omega_{t,m,} &amp; m = 1 : p</span>
<span id="cb2-757"><a href="#cb2-757" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb2-758"><a href="#cb2-758" aria-hidden="true" tabindex="-1"></a>$$ {#eq-tvar}</span>
<span id="cb2-759"><a href="#cb2-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-760"><a href="#cb2-760" aria-hidden="true" tabindex="-1"></a>There is a paper <span class="co">[</span><span class="ot">@prado2000bayesian</span><span class="co">]</span> on TVAR models that is a good reference for this model.</span>
<span id="cb2-761"><a href="#cb2-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-762"><a href="#cb2-762" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb2-763"><a href="#cb2-763" aria-hidden="true" tabindex="-1"></a><span class="fu">## Video Transcript {.unnumbered}</span></span>
<span id="cb2-764"><a href="#cb2-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-765"><a href="#cb2-765" aria-hidden="true" tabindex="-1"></a>{{&lt; include _C4-L03-T03.qmd &gt;}}</span>
<span id="cb2-766"><a href="#cb2-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-767"><a href="#cb2-767" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb2-768"><a href="#cb2-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-769"><a href="#cb2-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-770"><a href="#cb2-770" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary of Regression Models 📖</span></span>
<span id="cb2-771"><a href="#cb2-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-772"><a href="#cb2-772" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dynamic Regression Models</span></span>
<span id="cb2-773"><a href="#cb2-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-774"><a href="#cb2-774" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Simple Dynamic Regression</span></span>
<span id="cb2-775"><a href="#cb2-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-776"><a href="#cb2-776" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-777"><a href="#cb2-777" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb2-778"><a href="#cb2-778" aria-hidden="true" tabindex="-1"></a>  y_t &amp;= \beta_{t,0} + \beta_{t,1} x_t + \nu_t <span class="sc">\\</span></span>
<span id="cb2-779"><a href="#cb2-779" aria-hidden="true" tabindex="-1"></a>  \beta_{t,0} &amp;= \beta_{t-1,0} + \omega_{t,0} <span class="sc">\\</span></span>
<span id="cb2-780"><a href="#cb2-780" aria-hidden="true" tabindex="-1"></a>  \beta_{t,1} &amp;= \beta_{t-1,1} + \omega_{t,1} </span>
<span id="cb2-781"><a href="#cb2-781" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb2-782"><a href="#cb2-782" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-783"><a href="#cb2-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-784"><a href="#cb2-784" aria-hidden="true" tabindex="-1"></a>Thus:</span>
<span id="cb2-785"><a href="#cb2-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-786"><a href="#cb2-786" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-787"><a href="#cb2-787" aria-hidden="true" tabindex="-1"></a>\theta_t = (\beta_{t,0}, \beta_{t,1})'</span>
<span id="cb2-788"><a href="#cb2-788" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-789"><a href="#cb2-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-790"><a href="#cb2-790" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-791"><a href="#cb2-791" aria-hidden="true" tabindex="-1"></a>F_t = (1, x_t)'</span>
<span id="cb2-792"><a href="#cb2-792" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb2-793"><a href="#cb2-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-794"><a href="#cb2-794" aria-hidden="true" tabindex="-1"></a>and </span>
<span id="cb2-795"><a href="#cb2-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-796"><a href="#cb2-796" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-797"><a href="#cb2-797" aria-hidden="true" tabindex="-1"></a>G = I_2</span>
<span id="cb2-798"><a href="#cb2-798" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-799"><a href="#cb2-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-800"><a href="#cb2-800" aria-hidden="true" tabindex="-1"></a>This results in a forecast function of the form</span>
<span id="cb2-801"><a href="#cb2-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-802"><a href="#cb2-802" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-803"><a href="#cb2-803" aria-hidden="true" tabindex="-1"></a>f_t(h) = k_{t,0} + k_{t,1} x_{t+h}.</span>
<span id="cb2-804"><a href="#cb2-804" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-805"><a href="#cb2-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-806"><a href="#cb2-806" aria-hidden="true" tabindex="-1"></a><span class="fu">#### General Dynamic Regression</span></span>
<span id="cb2-807"><a href="#cb2-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-808"><a href="#cb2-808" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-809"><a href="#cb2-809" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb2-810"><a href="#cb2-810" aria-hidden="true" tabindex="-1"></a>y_t &amp;= \beta_{t,0} + \beta_{t,1} x_{t,1} + \dots + \beta_{t,M} x_{t,M} + \nu_t <span class="sc">\\</span></span>
<span id="cb2-811"><a href="#cb2-811" aria-hidden="true" tabindex="-1"></a>\beta_{t,m} &amp;= \beta_{t-1,m} + \omega_{t,m}, \quad &amp;m = 0:M.</span>
<span id="cb2-812"><a href="#cb2-812" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb2-813"><a href="#cb2-813" aria-hidden="true" tabindex="-1"></a>$$ {#eq-general-dynamic-regression}</span>
<span id="cb2-814"><a href="#cb2-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-815"><a href="#cb2-815" aria-hidden="true" tabindex="-1"></a>Then, </span>
<span id="cb2-816"><a href="#cb2-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-817"><a href="#cb2-817" aria-hidden="true" tabindex="-1"></a>$\theta_t = (\beta_{t,0}, \dots, \beta_{t,M})'$, </span>
<span id="cb2-818"><a href="#cb2-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-819"><a href="#cb2-819" aria-hidden="true" tabindex="-1"></a>$\mathbf{F}_t = (1, x_{t,1}, \dots, x_{t,M})'$ and </span>
<span id="cb2-820"><a href="#cb2-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-821"><a href="#cb2-821" aria-hidden="true" tabindex="-1"></a>$\mathbf{G} = \mathbf{I}_M$. </span>
<span id="cb2-822"><a href="#cb2-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-823"><a href="#cb2-823" aria-hidden="true" tabindex="-1"></a>The forecast function is given by:</span>
<span id="cb2-824"><a href="#cb2-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-825"><a href="#cb2-825" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-826"><a href="#cb2-826" aria-hidden="true" tabindex="-1"></a>f_t(h) = k_{t,0} + k_{t,1} x_{t+h,1} + \dots + k_{t,M} x_{t+h,M}.</span>
<span id="cb2-827"><a href="#cb2-827" aria-hidden="true" tabindex="-1"></a>$$ {#eq-forecast-function-general-dynamic-regression}</span>
<span id="cb2-828"><a href="#cb2-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-829"><a href="#cb2-829" aria-hidden="true" tabindex="-1"></a>A particular case of dynamic regressions is the case of **time-varying autoregressive (TVAR)** with</span>
<span id="cb2-830"><a href="#cb2-830" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">time-varying autoregressive (TVAR)</span><span class="co">]</span>{.column-margin width="53mm" group="slides"}</span>
<span id="cb2-831"><a href="#cb2-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-832"><a href="#cb2-832" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-833"><a href="#cb2-833" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb2-834"><a href="#cb2-834" aria-hidden="true" tabindex="-1"></a>  y_t &amp;= \phi_{t,1} y_{t-1} + \phi_{t,2} y_{t-2} + \dots + \phi_{t,p} y_{t-p} + \nu_t <span class="sc">\\</span></span>
<span id="cb2-835"><a href="#cb2-835" aria-hidden="true" tabindex="-1"></a>  \phi_{t,m} &amp;= \phi_{t-1,m} + \omega_{t,m}, \quad m = 1:p.</span>
<span id="cb2-836"><a href="#cb2-836" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb2-837"><a href="#cb2-837" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-838"><a href="#cb2-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-839"><a href="#cb2-839" aria-hidden="true" tabindex="-1"></a><span class="fu">## The superposition principle 🎥</span></span>
<span id="cb2-840"><a href="#cb2-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-841"><a href="#cb2-841" aria-hidden="true" tabindex="-1"></a><span class="al">![The superposition principle](images/m3_0031.png)</span>{#fig-superposition-principle .column-margin  group="slides" width="53mm"}</span>
<span id="cb2-842"><a href="#cb2-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-843"><a href="#cb2-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-844"><a href="#cb2-844" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">We can use the superposition principle to build models that have different kinds of components. The main idea is to think about what is the general structure we want for the forecast function and then isolate the different components of the forecast function and think about the classes of dynamic linear models that are represented in each of those components.</span><span class="co">]</span>{.mark} Each of those components has a class and then we can build the general dynamic linear model with all those pieces together using this principle.</span>
<span id="cb2-845"><a href="#cb2-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-846"><a href="#cb2-846" aria-hidden="true" tabindex="-1"></a>Two references for the Superposition principle are</span>
<span id="cb2-847"><a href="#cb2-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-848"><a href="#cb2-848" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@west2013bayesian §3.1 p. 98</span><span class="co">]</span></span>
<span id="cb2-849"><a href="#cb2-849" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@prado2023time §4.2.1 p. 136</span><span class="co">]</span></span>
<span id="cb2-850"><a href="#cb2-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-851"><a href="#cb2-851" aria-hidden="true" tabindex="-1"></a>::: {#imp-superposition .callout-important}</span>
<span id="cb2-852"><a href="#cb2-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-853"><a href="#cb2-853" aria-hidden="true" tabindex="-1"></a><span class="fu">## Superposition Principle</span></span>
<span id="cb2-854"><a href="#cb2-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-855"><a href="#cb2-855" aria-hidden="true" tabindex="-1"></a>In the first the author state:</span>
<span id="cb2-856"><a href="#cb2-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-857"><a href="#cb2-857" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Conditional independence also features strongly in initial model building and in choosing an appropriate parametrization. For example, the linear superposition principle states that any linear combination of deterministic linear models is a linear model. This extends to a normal linear superposition principle:</span></span>
<span id="cb2-858"><a href="#cb2-858" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb2-859"><a href="#cb2-859" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="co">[</span><span class="ot">Any linear combination of independent normal DLMs is a normal DLM.</span><span class="co">]</span><span class="at">{.mark} - &gt; -- </span><span class="co">[</span><span class="ot">@west2013bayesian §3.1 p. 98</span><span class="co">]</span></span>
<span id="cb2-860"><a href="#cb2-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-861"><a href="#cb2-861" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb2-862"><a href="#cb2-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-863"><a href="#cb2-863" aria-hidden="true" tabindex="-1"></a>We will illustrate how to do that with an example:</span>
<span id="cb2-864"><a href="#cb2-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-865"><a href="#cb2-865" aria-hidden="true" tabindex="-1"></a>Let's say that we want to create a model here with a forecast function that has a linear trend component. Let's say we have a linear function as a function of the number of steps ahead that you want to consider. Then suppose you also have a covariate here that you want to include in your model as a regression component.</span>
<span id="cb2-866"><a href="#cb2-866" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-867"><a href="#cb2-867" aria-hidden="true" tabindex="-1"></a>f_t(h) = \underbrace{(k_{t,0} + k_{t,1}\; h)}_{\text{linear trend component}} + \underbrace{(k_{t,2}\; x_{t+h})}_{\text{regression component}}</span>
<span id="cb2-868"><a href="#cb2-868" aria-hidden="true" tabindex="-1"></a>$$ {#eq-superposition-principle-example}</span>
<span id="cb2-869"><a href="#cb2-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-870"><a href="#cb2-870" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb2-871"><a href="#cb2-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-872"><a href="#cb2-872" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$f_t(h)$ is our forecast function.</span>
<span id="cb2-873"><a href="#cb2-873" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$k_{t,0}$, $k_{t,1}$ and $k_{t,2}$ are just constants (that we index using time $t$ and a second subscript).</span>
<span id="cb2-874"><a href="#cb2-874" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$x_{t+h}$ is a time dependent regression covariate.</span>
<span id="cb2-875"><a href="#cb2-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-876"><a href="#cb2-876" aria-hidden="true" tabindex="-1"></a>When we look at the forecast function, we can isolate a linear trend and a regression components as indicated.</span>
<span id="cb2-877"><a href="#cb2-877" aria-hidden="true" tabindex="-1"></a>Each of these can be set in terms of two forecast functions]{.mark}. I'm going to call the forecast function $f_{1,t}(h)$, this is just the first piece.</span>
<span id="cb2-878"><a href="#cb2-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-879"><a href="#cb2-879" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-880"><a href="#cb2-880" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb2-881"><a href="#cb2-881" aria-hidden="true" tabindex="-1"></a>f_t(h) &amp;= f_{1,t}(h) + f_{2,t}(h) <span class="sc">\\</span></span>
<span id="cb2-882"><a href="#cb2-882" aria-hidden="true" tabindex="-1"></a>f_{1,t}(h) &amp;= k_{t,0} + k_{t,1} &amp; \text{(linear trend component)} <span class="sc">\\</span></span>
<span id="cb2-883"><a href="#cb2-883" aria-hidden="true" tabindex="-1"></a>f_{2,t}(h) &amp;= k_{t,2}x_{t+h} &amp; \text{(regression component)}</span>
<span id="cb2-884"><a href="#cb2-884" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb2-885"><a href="#cb2-885" aria-hidden="true" tabindex="-1"></a>$$ {#eq-superposition-breaking-it-down}</span>
<span id="cb2-886"><a href="#cb2-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-887"><a href="#cb2-887" aria-hidden="true" tabindex="-1"></a>We know how to represent forecast function $f_{1,t}$ and $f_{2,t}$ in terms of dynamic linear models.</span>
<span id="cb2-888"><a href="#cb2-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-889"><a href="#cb2-889" aria-hidden="true" tabindex="-1"></a>For the linear trend component, $f_{1,t}(h)$ , we have a 2-dimensional state vector, $\theta_t = (\theta_{t,1}, \theta_{t,2})'$, which yields the following DLM shortform:</span>
<span id="cb2-890"><a href="#cb2-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-891"><a href="#cb2-891" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-892"><a href="#cb2-892" aria-hidden="true" tabindex="-1"></a><span class="sc">\{</span>F_1, G_1, \cdot, \cdot<span class="sc">\}</span>  \qquad \text{(short notation)}</span>
<span id="cb2-893"><a href="#cb2-893" aria-hidden="true" tabindex="-1"></a>$$ {#eq-superposition-linear-trend-short-form}</span>
<span id="cb2-894"><a href="#cb2-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-895"><a href="#cb2-895" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Where we don't explicitly specify the observational and system variances, $V$ and $W$ </span>
<span id="cb2-896"><a href="#cb2-896" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The important bit are $F$ and $G$. The forecast function is given by:</span>
<span id="cb2-897"><a href="#cb2-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-898"><a href="#cb2-898" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-899"><a href="#cb2-899" aria-hidden="true" tabindex="-1"></a>F_{1} = E_2 = (1, 0)'</span>
<span id="cb2-900"><a href="#cb2-900" aria-hidden="true" tabindex="-1"></a>$$ {#eq-superposition-F1}</span>
<span id="cb2-901"><a href="#cb2-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-902"><a href="#cb2-902" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-903"><a href="#cb2-903" aria-hidden="true" tabindex="-1"></a>G_{1} =</span>
<span id="cb2-904"><a href="#cb2-904" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb2-905"><a href="#cb2-905" aria-hidden="true" tabindex="-1"></a>1 &amp; 1 <span class="sc">\\</span></span>
<span id="cb2-906"><a href="#cb2-906" aria-hidden="true" tabindex="-1"></a>0 &amp; 1</span>
<span id="cb2-907"><a href="#cb2-907" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}</span>
<span id="cb2-908"><a href="#cb2-908" aria-hidden="true" tabindex="-1"></a>$$ {#eq-superposition-G1}</span>
<span id="cb2-909"><a href="#cb2-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-910"><a href="#cb2-910" aria-hidden="true" tabindex="-1"></a>for the regression component $f_{2,t}(h)$ we have the following DLM representation:</span>
<span id="cb2-911"><a href="#cb2-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-912"><a href="#cb2-912" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-913"><a href="#cb2-913" aria-hidden="true" tabindex="-1"></a><span class="sc">\{</span>F_2,t, G_2, \cdot, \cdot<span class="sc">\}</span>  \qquad \text{(short notation)}</span>
<span id="cb2-914"><a href="#cb2-914" aria-hidden="true" tabindex="-1"></a>$$ {#eq-superposition-regression-short-form}</span>
<span id="cb2-915"><a href="#cb2-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-916"><a href="#cb2-916" aria-hidden="true" tabindex="-1"></a>where we have $F_{2t}$ is $X_t$ and my $G$ is simply going to be 1. This is a one-dimensional vector in terms of the state parameter vector. </span>
<span id="cb2-917"><a href="#cb2-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-918"><a href="#cb2-918" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-919"><a href="#cb2-919" aria-hidden="true" tabindex="-1"></a>F_{2,t} = x_{t+h}</span>
<span id="cb2-920"><a href="#cb2-920" aria-hidden="true" tabindex="-1"></a>$$ {#eq-superposition-F2}</span>
<span id="cb2-921"><a href="#cb2-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-922"><a href="#cb2-922" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-923"><a href="#cb2-923" aria-hidden="true" tabindex="-1"></a>G_{2} = 1</span>
<span id="cb2-924"><a href="#cb2-924" aria-hidden="true" tabindex="-1"></a>$$ {#eq-superposition-G2}</span>
<span id="cb2-925"><a href="#cb2-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-926"><a href="#cb2-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-927"><a href="#cb2-927" aria-hidden="true" tabindex="-1"></a>Once we have these, we can assemble them into our final model. $<span class="sc">\{</span>F_t, G, \cdot, \cdot<span class="sc">\}</span>$</span>
<span id="cb2-928"><a href="#cb2-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-929"><a href="#cb2-929" aria-hidden="true" tabindex="-1"></a>We care more about $F$, $G$, and less about the observational variance and some covariance also for the system where the</span>
<span id="cb2-930"><a href="#cb2-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-931"><a href="#cb2-931" aria-hidden="true" tabindex="-1"></a>F is going to be an F that has, you just concatenate the two Fs. You're going to get 1, 0 and then you're going to put the next component here.</span>
<span id="cb2-932"><a href="#cb2-932" aria-hidden="true" tabindex="-1"></a>Again, this one is dependent on time because this component is time dependent and </span>
<span id="cb2-933"><a href="#cb2-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-934"><a href="#cb2-934" aria-hidden="true" tabindex="-1"></a>The model with forecast function $f_t(h)$ above is a model with a 3-dimensional state vector with </span>
<span id="cb2-935"><a href="#cb2-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-936"><a href="#cb2-936" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-937"><a href="#cb2-937" aria-hidden="true" tabindex="-1"></a>F_t = (F_1', F_{2,t})' = (1, 0, x_t)'</span>
<span id="cb2-938"><a href="#cb2-938" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb2-939"><a href="#cb2-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-940"><a href="#cb2-940" aria-hidden="true" tabindex="-1"></a>Then the G, you can create it just taking a block diagonal structure by concatenating $G_1$ and $G_2$. though formally there must be a better term for this operation.</span>
<span id="cb2-941"><a href="#cb2-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-942"><a href="#cb2-942" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-943"><a href="#cb2-943" aria-hidden="true" tabindex="-1"></a>G = \text{blockdiag}<span class="co">[</span><span class="ot">G_1, G_2</span><span class="co">]</span> = </span>
<span id="cb2-944"><a href="#cb2-944" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb2-945"><a href="#cb2-945" aria-hidden="true" tabindex="-1"></a>1 &amp; 1 &amp; 0 <span class="sc">\\</span></span>
<span id="cb2-946"><a href="#cb2-946" aria-hidden="true" tabindex="-1"></a>0 &amp; 1 &amp; 0 <span class="sc">\\</span></span>
<span id="cb2-947"><a href="#cb2-947" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 1</span>
<span id="cb2-948"><a href="#cb2-948" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}.</span>
<span id="cb2-949"><a href="#cb2-949" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-950"><a href="#cb2-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-951"><a href="#cb2-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-952"><a href="#cb2-952" aria-hidden="true" tabindex="-1"></a>This gives us the full $G$ dynamics matrix for the model. A model with this $F_t$ and this $G$ that is constant over time will give us this particular forecast function @eq-superposition-principle-example we started with.</span>
<span id="cb2-953"><a href="#cb2-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-954"><a href="#cb2-954" aria-hidden="true" tabindex="-1"></a>We used the superposition principle to build this model. If we need additional components, we will learn how to incorporate seasonal components, regression components, trend components. One  can build a fairly sophisticated model with different structures into this particular model using the superposition principle.</span>
<span id="cb2-955"><a href="#cb2-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-956"><a href="#cb2-956" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb2-957"><a href="#cb2-957" aria-hidden="true" tabindex="-1"></a><span class="fu">## Video Transcript {.unnumbered}</span></span>
<span id="cb2-958"><a href="#cb2-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-959"><a href="#cb2-959" aria-hidden="true" tabindex="-1"></a>{{&lt; include _C4-L03-T04.qmd &gt;}}</span>
<span id="cb2-960"><a href="#cb2-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-961"><a href="#cb2-961" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb2-962"><a href="#cb2-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-963"><a href="#cb2-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-964"><a href="#cb2-964" aria-hidden="true" tabindex="-1"></a><span class="fu">## Superposition principle: General case 📖</span></span>
<span id="cb2-965"><a href="#cb2-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-966"><a href="#cb2-966" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">You can build dynamic models with different components, for example, a trend component plus a regression component, by using the principle of superposition. The idea is to think about the general form of the forecast function you want to have for prediction. You then write that forecast function as a sum of different components where each component corresponds to a class of DLM with its own state-space representation. The final DLM can then be written by combining the pieces of the different components.</span><span class="co">]</span>{.mark}</span>
<span id="cb2-967"><a href="#cb2-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-968"><a href="#cb2-968" aria-hidden="true" tabindex="-1"></a>For example, suppose you are interested in a model with a forecast function that includes a linear polynomial trend and a single covariate $x_t$, i.e.,</span>
<span id="cb2-969"><a href="#cb2-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-970"><a href="#cb2-970" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-971"><a href="#cb2-971" aria-hidden="true" tabindex="-1"></a>f_t(h) = k_{t,0} + k_{t,1}h + k_{t,3}x_{t+h}.</span>
<span id="cb2-972"><a href="#cb2-972" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-973"><a href="#cb2-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-974"><a href="#cb2-974" aria-hidden="true" tabindex="-1"></a>This forecast function can be written as $f_t(h) = f_{1,t}(h) + f_{2,t}(h)$, with</span>
<span id="cb2-975"><a href="#cb2-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-976"><a href="#cb2-976" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-977"><a href="#cb2-977" aria-hidden="true" tabindex="-1"></a>f_{1,t}(h) = (k_{t,0} + k_{t,1}h), \quad f_{2,t}(h) = k_{t,3}x_{t+h}.</span>
<span id="cb2-978"><a href="#cb2-978" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-979"><a href="#cb2-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-980"><a href="#cb2-980" aria-hidden="true" tabindex="-1"></a>The first component in the forecast function corresponds to a model with a 2-dimensional state vector, $F_{1,t} = F_1 = (1, 0)'$,</span>
<span id="cb2-981"><a href="#cb2-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-982"><a href="#cb2-982" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-983"><a href="#cb2-983" aria-hidden="true" tabindex="-1"></a>G_{1,t} = G_1 = </span>
<span id="cb2-984"><a href="#cb2-984" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb2-985"><a href="#cb2-985" aria-hidden="true" tabindex="-1"></a>1 &amp; 1 <span class="sc">\\</span></span>
<span id="cb2-986"><a href="#cb2-986" aria-hidden="true" tabindex="-1"></a>0 &amp; 1</span>
<span id="cb2-987"><a href="#cb2-987" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}.</span>
<span id="cb2-988"><a href="#cb2-988" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-989"><a href="#cb2-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-990"><a href="#cb2-990" aria-hidden="true" tabindex="-1"></a>The second component corresponds to a model with a 1-dimensional state vector, $F_{2,t} = x_t$, $G_{2,t} = G_2 = 1$.</span>
<span id="cb2-991"><a href="#cb2-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-992"><a href="#cb2-992" aria-hidden="true" tabindex="-1"></a>The model with forecast function $f_t(h)$ above is a model with a 3-dimensional state vector with $F_t = (F_1', F_{2,t})' = (1, 0, x_t)'$ and</span>
<span id="cb2-993"><a href="#cb2-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-994"><a href="#cb2-994" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-995"><a href="#cb2-995" aria-hidden="true" tabindex="-1"></a>G_t = \text{blockdiag}<span class="co">[</span><span class="ot">G_1, G_2</span><span class="co">]</span> = </span>
<span id="cb2-996"><a href="#cb2-996" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb2-997"><a href="#cb2-997" aria-hidden="true" tabindex="-1"></a>1 &amp; 1 &amp; 0 <span class="sc">\\</span></span>
<span id="cb2-998"><a href="#cb2-998" aria-hidden="true" tabindex="-1"></a>0 &amp; 1 &amp; 0 <span class="sc">\\</span></span>
<span id="cb2-999"><a href="#cb2-999" aria-hidden="true" tabindex="-1"></a>0 &amp; 0 &amp; 1</span>
<span id="cb2-1000"><a href="#cb2-1000" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}.</span>
<span id="cb2-1001"><a href="#cb2-1001" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-1002"><a href="#cb2-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-1003"><a href="#cb2-1003" aria-hidden="true" tabindex="-1"></a><span class="fu">### General Case</span></span>
<span id="cb2-1004"><a href="#cb2-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-1005"><a href="#cb2-1005" aria-hidden="true" tabindex="-1"></a>The general case wasn't covered in the video and we didn't have a proper statement of the superposition principle. However, in <span class="co">[</span><span class="ot">@imp-superposition</span><span class="co">]</span> I extracted the statement of the principle above. This statement clarifies that the principle arises via conditional independence, a tool we also used extensively in the previous course on mixture models. </span>
<span id="cb2-1006"><a href="#cb2-1006" aria-hidden="true" tabindex="-1"></a>Now let us consider the general case from the handout.</span>
<span id="cb2-1007"><a href="#cb2-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-1008"><a href="#cb2-1008" aria-hidden="true" tabindex="-1"></a>Assume that you have a time series process $y_t$ with a forecast function</span>
<span id="cb2-1009"><a href="#cb2-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-1010"><a href="#cb2-1010" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-1011"><a href="#cb2-1011" aria-hidden="true" tabindex="-1"></a>f_t(h) = \sum_{i=1}^{m} f_{i,t}(h),</span>
<span id="cb2-1012"><a href="#cb2-1012" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-1013"><a href="#cb2-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-1014"><a href="#cb2-1014" aria-hidden="true" tabindex="-1"></a>where each $f_{i,t}(h)$ is the forecast function of a DLM with representation $<span class="sc">\{</span>F_{i,t}, G_{i,t}, v_{i,t}, W_{i,t}<span class="sc">\}</span>$.</span>
<span id="cb2-1015"><a href="#cb2-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-1016"><a href="#cb2-1016" aria-hidden="true" tabindex="-1"></a>Then, $f_t(h)$ has a DLM representation $<span class="sc">\{</span>F_t, G_t, v_t, W_t<span class="sc">\}</span>$ with</span>
<span id="cb2-1017"><a href="#cb2-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-1018"><a href="#cb2-1018" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-1019"><a href="#cb2-1019" aria-hidden="true" tabindex="-1"></a>F_t = (F_{1,t}', F_{2,t}', \dots, F_{m,t}')',</span>
<span id="cb2-1020"><a href="#cb2-1020" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-1021"><a href="#cb2-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-1022"><a href="#cb2-1022" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-1023"><a href="#cb2-1023" aria-hidden="true" tabindex="-1"></a>G_t = \text{blockdiag}<span class="co">[</span><span class="ot">G_{1,t}, \dots, G_{m,t}</span><span class="co">]</span>,</span>
<span id="cb2-1024"><a href="#cb2-1024" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-1025"><a href="#cb2-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-1026"><a href="#cb2-1026" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-1027"><a href="#cb2-1027" aria-hidden="true" tabindex="-1"></a>v_t = \sum_{i=1}^{m} v_{i,t},</span>
<span id="cb2-1028"><a href="#cb2-1028" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-1029"><a href="#cb2-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-1030"><a href="#cb2-1030" aria-hidden="true" tabindex="-1"></a>and</span>
<span id="cb2-1031"><a href="#cb2-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-1032"><a href="#cb2-1032" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb2-1033"><a href="#cb2-1033" aria-hidden="true" tabindex="-1"></a>W_t = \text{blockdiag}<span class="co">[</span><span class="ot">W_{1,t}, \dots, W_{m,t}</span><span class="co">]</span>.</span>
<span id="cb2-1034"><a href="#cb2-1034" aria-hidden="true" tabindex="-1"></a>$$</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"fade","descPosition":"bottom","loop":true,"openEffect":"fade","selector":".lightbox","skin":"my-css-class"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>