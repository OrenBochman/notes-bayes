---
title : 'Basic Concepts of Mixture Models'
subtitle : 'Bayesian Statistics: Mixture Models'
categories:
  - Bayesian Statistics
keywords:
  - Mixture Models
  - Homework
---

## HW - Simulation of Poisson mixture model

```{r}
#| label: fig-poisson-mix
# Generate n observations from a mixture of three poisson distributions
set.seed(452)

n = 200 # sample size
w = c(0.7,0.2,0.1) # weights
lambda = c(1,2,6) # lambda params (mean,variation)
ac = sample(1:length(w),n, replace=T, prob=w) # smaple the active component
x = rpois(n,lambda=lambda[ac]) # simulate an ac mixture component n time 

#par(mar=c(4,4,1,1) + 0.1)

empirical_feqs = table(factor(x, levels=seq(0, max(x)))) # tabulate samples into a counts
empirical_dist = empirical_feqs /n # convert frequencies to probabilities
```

Plot the empirical distribution

```{r}
#| label: fig-poisson-mix-1
#| fig-cap: "Empirical distribution for Poisson mixture"
par(mar=c(4,4,1,1) + 0.1)
barplot(empirical_dist,xlab="counts",ylab="probability",main="Empirical distribution for Poisson mixture")

```



```{r}
#| label: lbl-poisson-mix-2
set.seed(42)

n = 1000                  # Larger sample size
w = c(0.3, 0.25, 0.25, 0.2)  # Weights
mu = c(1, 4, 7, 10)       # Means
rates = 1 / mu            # Rates for exponential distributions

cc = sample(1:4, n, replace=TRUE, prob=w)
x = rexp(n, rate=rates[cc])

sample_mean = mean(x)
sample_var = var(x)

theoretical_mean = sum(w * mu)
theoretical_variance = sum(w * (mu^2 + (mu - theoretical_mean)^2))

cat("Sample Mean:", sample_mean, "\n")
cat("Sample Variance:", sample_var, "\n")
cat("Theoretical Mean:", theoretical_mean, "\n")
cat("Theoretical Variance:", theoretical_variance, "\n")
```
